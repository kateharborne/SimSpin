{
    "type": [
        0,
        1,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        2,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        2
    ],
    "data": [
        "> ",
        "library(SimSpin)",
        "\nAttaching package: ‘SimSpin’\n\n",
        "The following object is masked _by_ ‘.GlobalEnv’:\n\n    obs_galaxy\n\n",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad)",
        "Error in .Call(<pointer: 0x0>, part_data, inc_rad) : \n  NULL value passed as symbol address\n",
        "> ",
        "  galaxy_data = fst::read_fst(simspin_file, from = 1, to = 7)[,-1] #read in position and velocity data",
        "> ",
        "  row.names(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\")",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad)",
        "Error in .Call(<pointer: 0x0>, part_data, inc_rad) : \n  NULL value passed as symbol address\n",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "> ",
        "  observation = observation(telescope = telescope, observing_strategy = observing_strategy)",
        "> ",
        "  galaxy_data = fst::read_fst(simspin_file, from = 1, to = 7)[,-1] #read in position and velocity data",
        "> ",
        "  row.names(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\")",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad)",
        "Error in obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad) : \n  Index out of bounds: [index='ID'].\n",
        "> ",
        "t(galaxy_data)",
        "          ID             x             y             z            vx            vy            vz\nV2         1  5.680746e-01  2.214617e+01  3.687230e+01  2.237157e+01 -4.138682e+01  6.719296e+00\nV3         2 -7.896695e+00  2.280137e+01  2.885813e+01 -3.584874e+01  1.888155e+01 -7.874188e+01\nV4         3 -4.328702e+00  2.171492e+01  3.431693e+01 -1.423636e+01 -5.204991e+01  3.776117e+01\nV5         4  2.267894e+01  1.464908e+01  4.105595e+01 -2.102907e+00 -4.559362e+01  2.313783e+00\nV6         5  2.278158e+01  1.340037e+01",
        "  3.922875e+01 -5.900462e+00  4.717829e+01 -1.417251e+01\nV7         6  1.930360e+01  1.396663e+01  3.550582e+01 -5.949068e+00 -5.951798e+01  9.822395e+00\nV8         7  2.458239e+01  1.394649e+01  3.590767e+01 -1.282675e+01 -3.498086e+01  5.030188e+01\nV9         8  5.519717e+00  1.949069e+01  3.158637e+01 -1.125405e+01  5.669294e+01 -3.314185e+01\nV10        9  1.022657e+01  2.432315e+01  3.410836e+01 -9.896502e+00  4.601678e+01 -2.935895e+01\nV11       10 -4.669573e+01 -8.823289e+00 -2.213331e+01 -6.503784e+00",
        " -3.859548e+01 -2.457979e+01\nV12       11 -4.551800e+01 -1.047987e+01 -2.071758e+01 -4.398798e+01 -1.956302e+01  5.125211e-02\nV13       12 -3.914712e+01 -1.397450e+01 -2.370821e+01  3.292513e+00 -4.573031e+01  1.152050e+01\nV14       13 -4.426663e+01 -1.551560e+01 -2.650864e+01 -1.698841e+01 -4.162390e+01  2.175256e+01\nV15       14 -3.679862e+01 -3.879290e+01 -2.205253e+01 -2.817431e+01 -1.075134e+01  2.026261e+01\nV16       15 -3.184949e+01 -3.848064e+01 -2.354182e+01 -4.893879e+01 -2.049963e+01  5.379252e-02",
        "\nV17       16 -3.769966e+01 -4.030072e+01 -1.045978e+01 -3.586928e+01  2.031915e+01  1.039792e+01\nV18       17 -3.313846e+01 -2.935497e+01 -9.955475e+00 -3.270919e+01 -7.957156e+00 -5.317704e+01\nV19       18 -4.180583e+01 -2.076253e+01 -1.281685e+01  2.035829e+01 -2.304959e+01 -3.023051e+01\nV20       19 -4.104071e+01 -1.829177e+01 -5.888669e+00 -1.342011e+01 -2.580410e+01 -5.410898e+01\nV21       20 -3.536580e+01 -1.601910e+01 -5.188348e+00 -2.004665e+01 -1.192565e+01 -7.282823e+01\nV22       21 -3.676888e+01",
        " -1.558414e+01 -7.426676e+00 -5.069881e+00  1.901743e+00  1.094293e+02\nV23       22 -3.978384e+01 -1.546156e+01 -8.700976e+00 -5.460382e+01 -2.552413e+01  6.395925e+01\nV24       23 -3.988172e+01 -1.852674e+01 -1.188095e+01  1.592573e+01 -3.085574e+01 -3.019074e+01\nV25       24 -3.949866e+01 -2.030632e+01 -9.205112e+00 -1.933978e+01 -1.112470e+01 -1.513566e+01\nV26       25 -3.432865e+01 -2.091576e+01 -1.473067e+01  1.332130e+01  8.498461e+01 -4.961475e+01\nV27       26 -2.811128e+01 -2.178854e+01 -4.653036e-01",
        "  4.452600e+01  5.113593e+00 -1.204752e+00\nV28       27 -3.143598e+01 -2.931869e+01  7.063916e+00 -7.311474e+00 -8.111887e+00 -5.581553e+01\nV29       28 -3.110360e+01 -1.543273e+01  2.242906e+01  2.726940e+01  1.064459e+01  3.016379e+00\nV30       29 -2.703080e+01 -1.055750e+01  2.264821e+01  2.888878e+01 -7.654087e+00  5.331596e+01\nV31       30 -2.511388e+01 -1.356089e+01  2.474377e+01 -3.407188e+01 -6.828950e+01  3.166573e+01\nV32       31 -3.058698e+01 -1.295129e+01  8.688514e+00  3.551588e+01  4.308308e+01",
        " -2.686618e+01\nV33       32 -2.868299e+01 -1.579733e+01  5.807363e+00  2.794873e+01  6.044594e+01 -1.622601e+01\nV34       33 -2.862007e+01 -1.151181e+01  5.387371e+00 -2.676115e+01 -2.919589e+01 -1.947433e+01\nV35       34 -2.755948e+01 -1.350793e+01  2.197688e+00  1.998889e+01 -1.001967e+01 -8.486977e+01\nV36       35 -2.979221e+01 -1.994547e+01  9.269349e-01  4.204945e+01  7.115428e+00 -3.554897e+01\nV37       36 -3.200974e+01 -6.808177e+00 -6.718857e-01 -8.212948e+00  2.574533e+01 -1.300844e+01\nV38       37",
        " -4.022425e+01 -6.657803e+00  7.464465e-01  3.500822e+01 -4.007022e+01  7.794616e+01\nV39       38 -4.962814e+01 -9.602254e+00  5.400484e+00 -2.570170e+01 -5.735335e+00  1.811390e+01\nV40       39 -4.167220e+01 -1.249106e+01  1.018365e+01  5.425716e+01 -6.716704e+01 -9.497690e+00\nV41       40 -4.718181e+01 -8.406529e+00  9.448294e+00 -5.663694e-01  1.682942e+01  5.489601e+00\nV42       41 -4.435931e+01 -5.110187e+00  4.374645e+00 -5.356428e+01 -3.559932e+01 -2.056438e+01\nV43       42 -4.323745e+01 -3.859076e-02",
        "  6.985722e+00  1.784496e+01 -2.525048e+00 -5.672957e-01\nV44       43 -3.704563e+01 -1.012968e+00  7.659182e+00 -6.641509e+01  5.164473e+01 -2.115026e+01\nV45       44 -2.879523e+01  6.342924e+00  2.006408e+00 -2.092104e+01 -1.944904e+01 -3.647462e+01\nV46       45 -2.900596e+01  2.967758e+00  9.652028e+00  7.808660e+01 -1.902203e+01  5.924799e+01\nV47       46 -2.845255e+01 -5.363409e+00  1.659012e+01  3.257338e+01  9.233758e+00 -6.883471e+01\nV48       47 -3.159233e+01  4.465733e+00  1.306008e+01  3.785520e+01",
        " -2.241814e+01 -5.663804e+01\nV49       48 -3.210956e+01  1.142721e+01  1.326078e+01  5.980861e+01  4.544963e+01 -6.514716e+01\nV50       49 -3.289457e+01  9.536124e+00  1.534215e+01 -2.720665e+01 -1.679398e+01 -4.448388e+01\nV51       50 -3.572104e+01  1.190881e+01 -1.258803e+01 -1.171726e+01 -4.173301e+01 -5.026056e+01\nV52       51 -3.736860e+01  6.970421e+00 -1.409874e+01 -1.647808e+01 -4.172725e+01 -5.097812e+01\nV53       52 -2.922167e+01  7.349258e+00 -4.384510e+00 -3.355166e+00 -4.251254e+01 -9.078601e+01",
        "\nV54       53 -3.279243e+01  7.674933e+00 -1.796790e+00 -5.686331e+01  5.365575e+01  2.367930e+01\nV55       54 -3.408931e+01  9.778872e+00 -4.155319e-01  1.235307e+01 -1.716851e+01  7.848342e+01\nV56       55 -3.571579e+01  1.186344e+01 -5.901042e+00  2.196507e+01 -3.402784e+01  2.137248e+01\nV57       56 -2.986684e+01  1.790632e+00 -1.227548e+01  3.875337e+01 -4.156625e+01 -5.777603e+01\nV58       57 -3.430587e+01 -2.972186e-01 -6.126867e+00  4.031980e+01  3.303715e+00  4.564228e+01\nV59       58 -3.823413e+01",
        " -4.423192e+00 -1.513365e+01  2.091622e+01 -2.810744e+01 -4.890710e+01\nV60       59 -4.010333e+01 -6.307895e+00 -7.164056e+00 -1.421619e+00 -7.289029e+00  1.376412e+01\nV61       60 -1.808814e+01  1.975224e+01  8.475927e+00 -6.309520e+01  8.960618e-01 -2.913077e+01\nV62       61 -1.767988e+01  2.349250e+01  4.925342e+00 -7.851340e+01  3.557704e+01 -4.861116e+01\nV63       62 -1.602378e+01  2.555716e+01  1.015017e+00 -4.726673e+00 -1.330947e+01  7.159553e+01\nV64       63 -4.112314e+00  2.545378e+01  1.204023e+01",
        "  4.212865e+01  5.869406e+01  2.973026e+00\nV65       64 -1.304963e+01  2.812472e+01  5.318981e+00  1.570819e+01 -8.298284e+00  6.826763e+01\nV66       65 -1.434793e+01  2.570535e+01  3.171703e+00  1.065835e+01 -2.811842e+01  4.437841e+01\nV67       66 -8.124890e+00  2.350516e+01  7.241543e+00  1.936929e+01 -2.134240e+01  3.496209e+01\nV68       67 -6.274753e+00  2.121666e+01  5.532494e+00  1.185034e+00 -6.778531e+01  1.709599e+01\nV69       68 -5.093674e+00  2.649399e+01  8.492026e+00 -4.699182e+01  8.360298e+01",
        " -3.680631e+01\nV70       69 -1.224231e+01  1.892959e+01  3.031953e+00 -6.202444e+01  1.986603e+01 -2.636131e+01\nV71       70 -9.265634e+00  1.851501e+01  7.017239e+00 -5.801081e+01 -5.962494e+01  1.146279e+02\nV72       71 -3.765847e+00  2.015507e+01  5.883345e+00  2.064009e+01 -4.597126e+01 -2.528956e+00\nV73       72 -5.855537e+00  2.036840e+01  5.167887e+00 -3.105688e+01 -5.912643e+00 -9.924965e+01\nV74       73 -5.334220e+00  1.564120e+01  3.048275e+00 -5.374235e+01 -1.752285e+01 -6.992070e+01\nV75       74",
        " -5.666288e+00  2.051743e+01 -5.613440e-01  3.482402e+01 -6.546987e+01  2.348323e+00\nV76       75 -7.350082e+00  2.267951e+01 -4.426175e+00 -2.398704e+01 -8.528714e+00 -3.983872e+01\nV77       76 -1.376535e+01  2.045194e+01  1.574014e+00  3.419008e+00  1.251821e+01 -1.991776e+01\nV78       77 -1.399309e+01  1.650711e+01 -6.284119e+00 -2.871221e+01 -3.114203e+01 -3.620747e+01\nV79       78 -1.135354e+01  1.645093e+01 -6.126035e+00  5.372413e+01 -3.763719e+01  8.791125e+00\nV80       79 -7.055337e+00  1.737889e+01",
        " -2.972744e+00  5.044160e+01 -6.340369e+01  1.896175e+01\nV81       80 -3.900772e+00  1.885508e+01 -4.052910e+00  8.590826e+00 -8.020939e+01  3.399758e+01\nV82       81 -5.220973e+00  1.484890e+01 -4.903274e+00 -3.900126e+01 -1.307443e+01 -9.151594e+01\nV83       82 -7.291128e+00  1.531317e+01 -1.182927e+00 -2.211948e+01  7.182962e+00  8.178184e+01\nV84       83 -7.162721e+00  1.388124e+01  4.136108e-01 -7.742137e+01  6.563493e+01 -7.221987e+01\nV85       84 -6.674339e+00  1.287704e+01  2.214958e+00 -9.011584e+01",
        "  8.664453e+00  9.267320e+01\nV86       85 -4.083593e+00  1.361045e+01  2.694773e+00 -8.555599e+01  2.736795e+01 -3.226586e+01\nV87       86 -3.059872e+00  1.327866e+01  2.091930e+00 -4.918911e+01  2.420383e+01 -1.020201e+02\nV88       87 -4.031737e+00  1.250250e+01 -5.428196e-01 -7.478312e+01 -4.625842e+00 -6.857889e+01\nV89       88 -3.630736e+00  1.196769e+01 -8.986224e-01 -6.136418e+00 -1.232712e+02  7.709231e+01\nV90       89 -4.345484e+00  1.078510e+01 -1.123642e+00 -6.929818e+01  1.790036e+01 -1.275002e+02",
        "\nV91       90 -5.970494e+00  1.089877e+01  5.306742e-01 -3.252518e+00 -1.009424e+02 -4.483362e+01\nV92       91 -6.002593e+00  9.624115e+00  4.890117e-01 -3.791420e+01  1.335714e+02 -3.703919e+01\nV93       92 -7.375293e+00  1.148258e+01 -2.405182e-02 -3.514016e+01 -3.181103e+01 -4.058699e+00\nV94       93 -9.911018e+00  1.419282e+01  3.965069e-02 -3.121462e+01  7.393071e+01  1.829949e+01\nV95       94 -1.158272e+01  1.287696e+01 -5.358695e-01 -1.035233e+02  7.833024e+01 -1.530044e+01\nV96       95 -1.547944e+01",
        "  1.305838e+01 -6.426428e-01 -7.720213e+00 -5.659182e+01 -7.455541e+00\nV97       96 -1.478040e+01  1.328887e+01  3.423454e+00  8.335438e+00 -7.668965e+01  8.424977e+01\nV98       97 -1.297706e+01  1.153815e+01  2.672385e+00 -5.911455e+01 -3.890957e+01 -8.181862e+01\nV99       98 -1.619282e+01  1.259305e+01 -4.052064e-01  3.017447e+01 -7.201854e+01 -2.312109e+01\nV100      99 -2.029284e+01  1.348748e+01  2.653894e+00 -5.896991e+01  6.837507e+01 -1.785172e+01\nV101     100 -1.771380e+01  1.870073e+01  4.427657e+00",
        " -4.401797e+01 -2.322067e+01 -4.209409e+01\nV102     101 -1.561776e+01  2.030878e+01  2.575048e+00 -1.533878e+01  3.980028e+01  8.935043e+01\nV103     102 -2.504104e+01  1.577356e+01 -8.803234e-01 -2.168989e+01  3.415061e+01 -2.375297e+00\nV104     103 -2.112657e+01  1.732846e+01 -3.464781e+00 -4.004961e+01  3.689961e+01 -4.033470e+01\nV105     104 -1.708853e+01  2.127257e+01 -4.131927e+00 -7.719279e+00  6.174357e+01 -4.905172e+01\nV106     105 -1.823386e+01  1.737919e+01 -7.410286e+00 -1.601198e+00  1.133259e+01",
        "  7.907474e+00\nV107     106 -1.917749e+01  2.157210e+01 -7.651549e+00  7.097040e-01  1.751786e+01  2.692596e-02\nV108     107 -1.992809e+01  2.125201e+01 -6.607036e+00 -2.272706e+01  4.558239e+01 -4.078031e+01\nV109     108 -2.189661e+01  1.980340e+01 -7.000172e+00  2.386739e+01  1.234757e+01 -2.717968e+00\nV110     109 -1.975129e+01  2.289292e+01 -3.285898e+00 -4.080811e+01  1.253763e+01  3.067869e+01\nV111     110 -1.994157e+01  2.923826e+01 -8.145176e+00 -1.114030e+01  2.585360e+01  4.388918e+01\nV112     111",
        " -1.901320e+01  2.786844e+01 -1.123502e+01 -1.280316e+01  3.835688e+01  2.018380e+01\nV113     112 -1.013397e+01  2.195861e+01 -7.063569e+00 -2.783048e+01  2.394062e+00  3.084419e+01\nV114     113 -6.097066e+00  2.038103e+01 -9.836123e+00 -8.315606e+01  4.432599e+01  3.161990e+01\nV115     114 -1.152109e+01  1.913819e+01 -8.065185e+00 -2.834518e+01 -1.233975e+01 -3.945067e+01\nV116     115 -1.346689e+01  1.885859e+01 -6.729469e+00 -4.498783e+00  2.939069e+01 -8.248355e+00\nV117     116 -1.541383e+01  2.027665e+01",
        " -1.016952e+01 -3.073398e+01  4.757331e+01 -8.278940e+00\nV118     117 -1.302765e+01  2.505554e+01 -5.657563e+00  2.765686e+00  2.905487e+01  5.877955e+01\nV119     118 -1.365693e+01  2.537053e+01 -8.781431e+00  5.599283e+01  1.271086e+01  3.921905e+01\nV120     119 -1.049466e+01  2.690462e+01 -4.271749e+00  6.575153e+00  1.169301e+01  7.478177e+00\nV121     120 -1.022159e+01  2.581821e+01 -2.115799e+00  4.286408e+01 -9.012951e+00  1.768350e+01\nV122     121 -6.829971e+00  2.341767e+01 -5.137225e+00 -1.640565e+01",
        "  2.459562e+01 -3.073425e+01\nV123     122 -1.294959e+01  3.126276e+01 -7.681060e+00 -1.351200e+01  6.176233e+01  3.265872e+01\nV124     123 -8.288138e+00  2.955178e+01  2.854185e-04  3.494316e+01  1.528243e+01  3.625152e+01\nV125     124 -1.775384e+01  2.791285e+01 -2.055054e+01 -2.879266e+01  2.094553e+01 -7.412091e+01\nV126     125 -1.303386e+01  2.934713e+01 -1.904091e+01 -2.438235e+01  5.746480e+01 -4.971139e+00\nV127     126 -1.280604e+01  2.592704e+01 -1.943381e+01 -1.306162e+01 -2.051018e-01  2.340795e+01",
        "\nV128     127 -8.668129e+00  2.803046e+01 -1.897101e+01  7.340117e+00  6.685015e+01  2.327429e+01\nV129     128 -1.209428e+01  2.288736e+01 -3.297370e+01 -1.335643e+01  3.851023e-01  2.701389e+01\nV130     129 -1.698016e+01  9.525537e+00 -2.888328e+01  1.915510e+01  4.666458e+01  4.090865e+01\nV131     130 -2.622023e+01  1.313998e+01 -2.496294e+01 -2.689542e+00 -6.222282e+01 -3.354606e+01\nV132     131 -2.264672e+01  9.050341e+00 -2.142040e+01 -9.511357e+01  3.561990e+01 -2.504342e+01\nV133     132 -2.427891e+01",
        "  4.781229e+00 -2.048713e+01 -2.398943e+01  2.245227e+01 -5.374913e+00\nV134     133 -2.340925e+01  5.743050e+00 -1.727127e+01  4.329875e+00 -3.265155e+01 -1.658469e+01\nV135     134 -1.989099e+01  2.722195e+00 -2.400887e+01 -7.466308e+01  4.058154e+01  2.606972e+01\nV136     135 -2.377771e+01 -4.426650e+00 -1.360555e+01 -5.936363e+00 -3.942888e+01 -5.100852e+01\nV137     136 -1.748878e+01 -4.466335e+00 -1.203164e+01  7.897416e+01 -3.049469e+01  6.459248e+00\nV138     137 -1.783877e+01 -4.648102e+00 -1.159397e+01",
        "  7.870631e+01  9.635595e+00 -8.228646e+00\nV139     138 -1.950041e+01 -4.684728e+00 -1.924077e+01 -6.515340e+01 -1.446889e+01 -3.189594e+01\nV140     139 -1.860680e+01 -4.386789e+00 -1.978200e+01  6.449814e+01  5.758208e+01 -1.585639e+01\nV141     140 -2.013393e+01 -1.148002e+00 -1.634317e+01  7.359515e+01 -3.093225e+01 -5.636853e+01\nV142     141 -2.199428e+01 -1.067430e+00 -1.512750e+01  3.737136e+01 -5.362475e+01 -3.573243e+01\nV143     142 -2.142349e+01 -7.831261e-01 -1.404988e+01  3.811128e+01  2.638479e+01",
        " -3.838129e+01\n [ reached getOption(\"max.print\") -- omitted 12839 rows ]\n",
        "> ",
        "test = t(galaxy_data)",
        "> ",
        "install.packages(\"data.table\")",
        "Error in install.packages : Updating loaded packages\n\nRestarting R session...\n\n",
        "> ",
        "install.packages(\"data.table\")",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/data.table_1.13.2.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 2317427 bytes (2.2 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 2.2 MB\n\n",
        "\nThe downloaded binary packages are in\n\t/var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//RtmpHOHCCd/downloaded_packages\n",
        "> ",
        "library(data.table)",
        "data.table 1.13.2 using 1 threads (see ?getDTthreads).  Latest news: r-datatable.com\n",
        "**********\nThis installation of data.table has not detected OpenMP support. It should still work but in single-threaded mode.\nThis is a Mac. Please read https://mac.r-project.org/openmp/. Please engage with Apple and ask them for support. Check r-datatable.com for updates, and our Mac instructions here: https://github.com/Rdatatable/data.table/wiki/Installation. After several years of many reports of installation problems on Mac, it's time to gingerly point out that there have been no similar problems on Windows or Linux.\n**********\n",
        "> ",
        "  galaxy_data = data.table::transpose(fst::read_fst(simspin_file, from = 1, to = 7)[,-1]) #read in position and velocity data",
        "> ",
        "  col.names(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\")",
        "Error in col.names(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\") : \n  could not find function \"col.names<-\"\n",
        "> ",
        "  colnames(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\")",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad)",
        "Error in obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad) : \n  could not find function \"obs_galaxy\"\n",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "Loading required package: celestial\n",
        "Loading required package: RANN\n",
        "Loading required package: NISTunits\n",
        "Loading required package: pracma\n",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad)",
        "> ",
        "  galaxy_data$pixel_pos = cut(galaxy_data$x, breaks=observation$sbin_seq, labels=F) +",
        "+ ",
        "    (sbin * cut(galaxy_data$z_obs, breaks=observation$sbin_seq, labels=F)) - (sbin^2)# assigning particles to positions in cube",
        "Error: object 'sbin' not found\n",
        "> ",
        "  galaxy_data$pixel_pos = cut(galaxy_data$x, breaks=observation$sbin_seq, labels=F) +",
        "+ ",
        "    (observation$sbin * cut(galaxy_data$z_obs, breaks=observation$sbin_seq, labels=F)) - (observation$sbin^2)# assigning particles to positions in cube",
        "> ",
        "range(galaxy_data$pixel_pos)",
        "[1] NA NA\n",
        "> ",
        "range(galaxy_data$pixel_pos, na.rm = T)",
        "[1] -869   30\n",
        "> ",
        "  galaxy_data$pixel_pos = cut(galaxy_data$x, breaks=observation$sbin_seq, labels=F) +",
        "+ ",
        "    (observation$sbin * cut(galaxy_data$z_obs, breaks=observation$sbin_seq, labels=F)) - (observation$sbin)# assigning particles to positions in cube",
        "> ",
        "range(galaxy_data$pixel_pos, na.rm = T)",
        "[1]   1 900\n",
        "> ",
        "test = galaxy_data[galaxy_data$pixel_pos %in% observation$aperture_region,]",
        "> ",
        "range(observation$aperture_region)",
        "[1] NA NA\n",
        "> ",
        "range(observation$aperture_region, na.rm = T)",
        "[1]  12 889\n",
        "> ",
        "range(galaxy_data$pixel_pos, na.rm = T)",
        "[1]   1 900\n",
        "> ",
        "range(test$pixel_pos, na.rm = T)",
        "[1]  12 889\n",
        "> ",
        "test[test$pixel_pos == NA,]",
        "      ID  x  y  z vx vy vz  r z_obs r_obs vy_obs pixel_pos\nNA    NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.1  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.2  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.3  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.4  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.5  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.6  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.7  NA NA NA NA NA NA NA NA    NA    NA",
        "     NA        NA\nNA.8  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.9  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.10 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.11 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.12 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.13 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.14 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.15 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.16 NA NA NA NA NA NA",
        " NA NA    NA    NA     NA        NA\nNA.17 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.18 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.19 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.20 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.21 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.22 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.23 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.24 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.25",
        " NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.26 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.27 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.28 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.29 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.30 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.31 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.32 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.33 NA NA NA NA NA NA NA NA    NA    NA     NA",
        "        NA\nNA.34 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.35 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.36 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.37 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.38 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.39 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.40 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.41 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.42 NA NA NA NA NA NA NA NA",
        "    NA    NA     NA        NA\nNA.43 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.44 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.45 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.46 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.47 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.48 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.49 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.50 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.51 NA NA",
        " NA NA NA NA NA NA    NA    NA     NA        NA\nNA.52 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.53 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.54 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.55 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.56 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.57 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.58 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.59 NA NA NA NA NA NA NA NA    NA    NA     NA        NA",
        "\nNA.60 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.61 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.62 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.63 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.64 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.65 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.66 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.67 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.68 NA NA NA NA NA NA NA NA    NA    NA",
        "     NA        NA\nNA.69 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.70 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.71 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.72 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.73 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.74 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.75 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.76 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.77 NA NA NA NA NA NA",
        " NA NA    NA    NA     NA        NA\nNA.78 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.79 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.80 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.81 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.82 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\n [ reached 'max' / getOption(\"max.print\") -- omitted 12601 rows ]\n",
        "> ",
        "galaxy_data[galaxy_data$pixel_pos == NA]",
        "Error in `[.data.frame`(galaxy_data, galaxy_data$pixel_pos == NA) : \n  undefined columns selected\n",
        "> ",
        "galaxy_data[galaxy_data$pixel_pos == NA,]",
        "      ID  x  y  z vx vy vz  r z_obs r_obs vy_obs pixel_pos\nNA    NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.1  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.2  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.3  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.4  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.5  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.6  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.7  NA NA NA NA NA NA NA NA    NA    NA",
        "     NA        NA\nNA.8  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.9  NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.10 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.11 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.12 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.13 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.14 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.15 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.16 NA NA NA NA NA NA",
        " NA NA    NA    NA     NA        NA\nNA.17 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.18 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.19 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.20 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.21 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.22 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.23 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.24 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.25",
        " NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.26 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.27 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.28 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.29 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.30 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.31 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.32 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.33 NA NA NA NA NA NA NA NA    NA    NA     NA",
        "        NA\nNA.34 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.35 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.36 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.37 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.38 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.39 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.40 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.41 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.42 NA NA NA NA NA NA NA NA",
        "    NA    NA     NA        NA\nNA.43 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.44 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.45 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.46 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.47 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.48 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.49 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.50 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.51 NA NA",
        " NA NA NA NA NA NA    NA    NA     NA        NA\nNA.52 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.53 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.54 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.55 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.56 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.57 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.58 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.59 NA NA NA NA NA NA NA NA    NA    NA     NA        NA",
        "\nNA.60 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.61 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.62 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.63 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.64 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.65 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.66 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.67 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.68 NA NA NA NA NA NA NA NA    NA    NA",
        "     NA        NA\nNA.69 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.70 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.71 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.72 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.73 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.74 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.75 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.76 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.77 NA NA NA NA NA NA",
        " NA NA    NA    NA     NA        NA\nNA.78 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.79 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.80 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.81 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\nNA.82 NA NA NA NA NA NA NA NA    NA    NA     NA        NA\n [ reached 'max' / getOption(\"max.print\") -- omitted 12898 rows ]\n",
        "> ",
        "View(galaxy_data)",
        "> ",
        "observation$sbin_seq",
        " [1] -14.154645 -13.211002 -12.267359 -11.323716 -10.380073  -9.436430  -8.492787  -7.549144  -6.605501  -5.661858  -4.718215\n[12]  -3.774572  -2.830929  -1.887286  -0.943643   0.000000   0.943643   1.887286   2.830929   3.774572   4.718215   5.661858\n[23]   6.605501   7.549144   8.492787   9.436430  10.380073  11.323716  12.267359  13.211002  14.154645\n",
        "> ",
        "View(galaxy_data)",
        "> ",
        "  galaxy_data = data.table::transpose(fst::read_fst(simspin_file, from = 1, to = 7)[,-1]) #read in position and velocity data",
        "> ",
        "  colnames(galaxy_data) = c(\"ID\", \"x\", \"y\", \"z\", \"vx\", \"vy\", \"vz\")",
        "> ",
        "  galaxy_data = obs_galaxy(part_data = galaxy_data, inc_rad = observation$inc_rad) # projecting the galaxy to given inclination",
        "> ",
        "galaxy_data$pixel_pos = cut(galaxy_data$x, breaks=observation$sbin_seq, labels=F) +",
        "+ ",
        "    (observation$sbin * cut(galaxy_data$z_obs, breaks=observation$sbin_seq, labels=F)) - (observation$sbin) # assigning particles to positions in cube",
        "> ",
        "  galaxy_data = galaxy_data[!is.na(galaxy_data$pixel_pos),] # removing any particles that fall outside the sbin aperture",
        "> ",
        "  galaxy_data = galaxy_data[galaxy_data$pixel_pos %in% observation$aperture_region,] # trimming particles that lie outside the aperture of the telescope",
        "> ",
        " range(galaxy_data$pixel_pos)",
        "[1]  12 889\n",
        "> ",
        "i = 12",
        "> ",
        "    particle_IDs = galaxy_data$ID[galaxy_data$pixel_pos = i]",
        "Error: unexpected '=' in \"    particle_IDs = galaxy_data$ID[galaxy_data$pixel_pos =\"\n",
        "> ",
        "    particle_IDs = galaxy_data$ID[galaxy_data$pixel_pos == i]",
        "> ",
        "    spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "Error in fst::read_fst(simspin_file, columns = particle_IDs, from = 8) : \n  Parameter 'columns' should be a character vector of column names.\n",
        "> ",
        "    particle_IDs = paste0(\"V\", galaxy_data$ID[galaxy_data$pixel_pos == i])",
        "> ",
        "    spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "> ",
        "View(spectra)",
        "> ",
        "    spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 1)",
        "> ",
        "    particle_IDs = paste0(\"V\", (galaxy_data$ID[galaxy_data$pixel_pos == i] + 1)) # IDs are indexed one out from the column numbers",
        "> ",
        "    spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 1)",
        "> ",
        "View(spectra)",
        "> ",
        "  wavelength  = fst::read_fst(simspin_file, columns = \"V1\", from = 8)",
        "> ",
        "  wavelength  = as.numeric(fst::read_fst(simspin_file, columns = \"V1\", from = 8))",
        "Error: 'list' object cannot be coerced to type 'double'\n",
        "> ",
        "  wavelength  = fst::read_fst(simspin_file, columns = \"V1\", from = 8)[1,]",
        "> ",
        "  wavelength  = fst::read_fst(simspin_file, columns = \"V1\", from = 8)[,1]",
        "> ",
        "range(wavelength)",
        "[1]      91 1600000\n",
        "> ",
        "?BC03lr",
        "> ",
        "which(wavelength > telescope$wave_range[1] & wavelength < telescope$wave_range[2])",
        "  [1] 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399\n [33] 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431\n [65] 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463\n [97] 464 465 466 467\n",
        "> ",
        "wavelength(368)",
        "Error in wavelength(368) : could not find function \"wavelength\"\n",
        "> ",
        "wavelength[368]",
        "[1] 3710\n",
        "> ",
        "    velocity_los = galaxy_data$vy_obs[galaxy_data$pixel_pos == i]",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "> ",
        "    spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "> ",
        "    wave_shift = matrix(data = wavelength, nrow = length(particle_IDs))    ",
        "Warning message:\n",
        "In matrix(data = wavelength, nrow = length(particle_IDs)) :",
        "\n ",
        " data length [1221] is not a sub-multiple or multiple of the number of rows [2]\n",
        "> ",
        "    wave_shift = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs))    ",
        "> ",
        "View(wave_shift)",
        "> ",
        "rep(wavelength, length(particle_IDs))",
        "   [1]    91    94    96    98   100   102   104   106   108   110   114   118   121   125   127   128   131   132   134   137   140\n  [22]   143   147   151   155   159   162   166   170   173   177   180   182   186   191   194   198   202   205   210   216   220\n  [43]   223   227   230   234   240   246   252   257   260   264   269   274   279   284   290   296   301   308   318   328   338\n  [64]   348   357   366   375   385   395   405   414   422   430   441   451   460   470   480   490   500   506",
        "   512   520   530\n  [85]   540   550   560   570   580   590   600   610   620   630   640   650   658   665   675   685   695   705   716   726   735\n [106]   745   755   765   775   785   795   805   815   825   835   845   855   865   875   885   895   905   915   925   935   945\n [127]   955   965   975   985   995  1005  1015  1025  1035  1045  1055  1065  1075  1085  1095  1105  1115  1125  1135  1145  1155\n [148]  1165  1175  1185  1195  1205  1215  1225  1235  1245  1255  1265  1275  1285  1295  1305",
        "  1315  1325  1335  1345  1355  1365\n [169]  1375  1385  1395  1405  1415  1425  1435  1442  1447  1455  1465  1475  1485  1495  1505  1512  1517  1525  1535  1545  1555\n [190]  1565  1575  1585  1595  1605  1615  1625  1635  1645  1655  1665  1672  1677  1685  1695  1705  1715  1725  1735  1745  1755\n [211]  1765  1775  1785  1795  1805  1815  1825  1835  1845  1855  1865  1875  1885  1895  1905  1915  1925  1935  1945  1955  1967\n [232]  1976  1984  1995  2005  2015  2025  2035  2045  2055  2065  2074  2078",
        "  2085  2095  2105  2115  2125  2135  2145  2155  2165\n [253]  2175  2185  2195  2205  2215  2225  2235  2245  2255  2265  2275  2285  2295  2305  2315  2325  2335  2345  2355  2365  2375\n [274]  2385  2395  2405  2415  2425  2435  2445  2455  2465  2475  2485  2495  2505  2513  2518  2525  2535  2545  2555  2565  2575\n [295]  2585  2595  2605  2615  2625  2635  2645  2655  2665  2675  2685  2695  2705  2715  2725  2735  2745  2755  2765  2775  2785\n [316]  2795  2805  2815  2825  2835  2845  2855  2865  2875",
        "  2885  2895  2910  2930  2950  2970  2990  3010  3030  3050  3070  3090\n [337]  3110  3130  3150  3170  3190  3210  3230  3250  3270  3290  3310  3330  3350  3370  3390  3410  3430  3450  3470  3490  3510\n [358]  3530  3550  3570  3590  3610  3630  3640  3650  3670  3690  3710  3730  3750  3770  3790  3810  3830  3850  3870  3890  3910\n [379]  3930  3950  3970  3990  4010  4030  4050  4070  4090  4110  4130  4150  4170  4190  4210  4230  4250  4270  4290  4310  4330\n [400]  4350  4370  4390  4410  4430  4450",
        "  4470  4490  4510  4530  4550  4570  4590  4610  4630  4650  4670  4690  4710  4730  4750\n [421]  4770  4790  4810  4830  4850  4870  4890  4910  4930  4950  4970  4990  5010  5030  5050  5070  5090  5110  5130  5150  5170\n [442]  5190  5210  5230  5250  5270  5290  5310  5330  5350  5370  5390  5410  5430  5450  5470  5490  5510  5530  5550  5570  5590\n [463]  5610  5630  5650  5670  5690  5710  5730  5750  5770  5790  5810  5830  5850  5870  5890  5910  5930  5950  5970  5990  6010\n [484]  6030  6050  6070",
        "  6090  6110  6130  6150  6170  6190  6210  6230  6250  6270  6290  6310  6330  6350  6370  6390  6410  6430\n [505]  6450  6470  6490  6510  6530  6550  6570  6590  6610  6630  6650  6670  6690  6710  6730  6750  6770  6790  6810  6830  6850\n [526]  6870  6890  6910  6930  6950  6970  6990  7010  7030  7050  7070  7090  7110  7130  7150  7170  7190  7210  7230  7250  7270\n [547]  7290  7310  7330  7350  7370  7390  7410  7430  7450  7470  7490  7510  7530  7550  7570  7590  7610  7630  7650  7670  7690\n [568]",
        "  7710  7730  7750  7770  7790  7810  7830  7850  7870  7890  7910  7930  7950  7970  7990  8010  8030  8050  8070  8090  8110\n [589]  8130  8150  8170  8190  8210  8230  8250  8270  8290  8310  8330  8350  8370  8390  8410  8430  8450  8470  8490  8510  8530\n [610]  8550  8570  8590  8610  8630  8650  8670  8690  8710  8730  8750  8770  8790  8810  8830  8850  8870  8890  8910  8930  8950\n [631]  8970  8990  9010  9030  9050  9070  9090  9110  9130  9150  9170  9190  9210  9230  9250  9270  9290  9310  9330",
        "  9350  9370\n [652]  9390  9410  9430  9450  9470  9490  9510  9530  9550  9570  9590  9610  9630  9650  9670  9690  9710  9730  9750  9770  9790\n [673]  9810  9830  9850  9870  9890  9910  9930  9950  9970  9990 10025 10075 10125 10175 10225 10275 10325 10375 10425 10475 10525\n [694] 10575 10625 10675 10725 10775 10825 10875 10925 10975 11025 11075 11125 11175 11225 11275 11325 11375 11425 11475 11525 11575\n [715] 11625 11675 11725 11775 11825 11875 11925 11975 12025 12075 12125 12175 12225 12275 12325 12375",
        " 12425 12475 12525 12575 12625\n [736] 12675 12725 12775 12825 12875 12925 12975 13025 13075 13125 13175 13225 13275 13325 13375 13425 13475 13525 13575 13625 13675\n [757] 13725 13775 13825 13875 13925 13975 14025 14075 14125 14175 14225 14275 14325 14375 14425 14475 14525 14570 14620 14675 14725\n [778] 14775 14825 14875 14925 14975 15025 15075 15125 15175 15225 15275 15325 15375 15425 15475 15525 15575 15625 15675 15725 15775\n [799] 15825 15875 15925 15975 16050 16150 16250 16350 16450 16550 16650 16750 16850",
        " 16950 17050 17150 17250 17350 17450 17550 17650\n [820] 17750 17850 17950 18050 18150 18250 18350 18450 18550 18650 18750 18850 18950 19050 19150 19250 19350 19450 19550 19650 19750\n [841] 19850 19950 20050 20150 20250 20350 20450 20550 20650 20750 20850 20950 21050 21150 21250 21350 21450 21550 21650 21750 21850\n [862] 21950 22050 22150 22250 22350 22450 22550 22650 22750 22850 22950 23050 23150 23250 23350 23450 23550 23650 23750 23850 23950\n [883] 24050 24150 24250 24350 24450 24550 24650 24750 24850 24950",
        " 25050 25150 25250 25350 25450 25550 25650 25750 25850 25950 26050\n [904] 26150 26250 26350 26450 26550 26650 26750 26850 26950 27050 27150 27250 27350 27450 27550 27650 27750 27850 27950 28050 28150\n [925] 28250 28350 28450 28550 28650 28750 28850 28950 29050 29150 29250 29350 29450 29550 29650 29750 29850 29950 30050 30150 30250\n [946] 30350 30450 30550 30650 30750 30850 30950 31050 31150 31250 31350 31450 31550 31650 31750 31850 31950 32100 32300 32500 32700\n [967] 32900 33100 33300 33500 33700 33900 34100",
        " 34300 34500 34700 34900 35100 35300 35500 35700 35900 36100 36300 36500 36700 36900\n [988] 37100 37300 37500 37700 37900 38100 38300 38500 38700 38900 39100 39300 39500\n [ reached getOption(\"max.print\") -- omitted 1442 entries ]\n",
        "> ",
        "length(rep(wavelength, length(particle_IDs)))",
        "[1] 2442\n",
        "> ",
        "2442/2",
        "[1] 1221\n",
        "> ",
        "View(wave_shift)",
        "> ",
        "    wave_shift = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs))    ",
        "> ",
        "View(wave_shift)",
        "> ",
        "length(particle_IDs)",
        "[1] 2\n",
        "> ",
        "length(wavelength)",
        "[1] 1221\n",
        "> ",
        "    wave_shift = matrix(data = wavelength, nrow = length(particle_IDs), ncol= length(wavelength))    ",
        "> ",
        "View(wave_shift)",
        "> ",
        "    wave_shift = matrix(data = wavelength,  ncol= length(wavelength))",
        "> ",
        "    wave_shift = matrix(data = wavelength, ncol= length(wavelength), nrow = length(particle_IDs))",
        "> ",
        "View(wave_shift)",
        "> ",
        "  observation = observation(telescope = telescope, observing_strategy = observing_strategy)",
        "> ",
        "    wave_shift = (velocity_los / observation$c) ",
        "> ",
        "    wave_shift = (velocity_los / observation$c) * wavelength",
        "Warning message:\n",
        "In (velocity_los/observation$c) * wavelength :",
        "\n ",
        " longer object length is not a multiple of shorter object length\n",
        "> ",
        "    wave = wavelength",
        "> ",
        "    dim(rep(wave, length(particle_IDs)))<-c(length(particle_IDs), length(wavelength))",
        "Error in dim(rep(wave, length(particle_IDs))) <- c(length(particle_IDs),  : \n  could not find function \"rep<-\"\n",
        "> ",
        "    wave = rep(wavelength, length(particle_IDs))",
        "> ",
        "wave[1222]",
        "[1] 91\n",
        "> ",
        "    dim(wave) = c(length(particle_IDs), length(wavelength))",
        "> ",
        "View(wave)",
        "> ",
        "wave[2,1221]",
        "[1] 1600000\n",
        "> ",
        "wave[1,1221]",
        "[1] 1400000\n",
        "> ",
        "    wave = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs), byrow=T)",
        "> ",
        "View(wave)",
        "> ",
        "    wave_shift = (velocity_los / observation$c) * wave",
        "> ",
        "View(wave_shift)",
        "> ",
        "velocity_los / observation$c",
        "[1] -0.0002811595 -0.0002322301\n",
        "> ",
        "(velocity_los / observation$c ) * 91",
        "[1] -0.02558551 -0.02113294\n",
        "> ",
        "(velocity_los / observation$c ) * 94",
        "[1] -0.02642899 -0.02182963\n",
        "> ",
        "    wave_shift = ((velocity_los / observation$c) * wave) + wave",
        "> ",
        "View(wave_shift)",
        "> ",
        "spectra[1,]",
        "        V639       V683\n1 0.01043546 0.03289082\n",
        "> ",
        "spectra[,1]",
        "   [1]  0.01043546  0.01281133  0.01497364  0.01762739  0.02019277  0.02262780  0.02350208  0.02538772  0.02791411  0.03745783\n  [11]  0.04293656  0.04745589  0.13048036  0.14616109  0.15210447  0.15698877  0.16471706  0.18551338  0.19063907  0.22267931\n  [21]  0.23295287  0.51370342  1.08151329  1.11532682  1.16299523  1.21461483  1.24923837  1.31354248  1.35637589  1.39623880\n  [31]  1.43936809  1.47195822  1.49697351  1.54062566  1.59453779  1.63815355  1.67524323  1.72303938  1.75564777  1.73188251\n  [41]",
        "  1.86284743  1.91046631  1.91794981  1.97219832  2.87373214  4.84578341  5.94535678  5.47655662  5.67507166  4.59732550\n  [51]  5.33047246  5.51093200  5.39687285  5.26881112  5.14154896  5.05484488  4.71604865  4.66431033  4.48196124  4.43539123\n  [61]  4.35783129  4.18773616  3.99194671  3.79892003  3.68120021  3.61876001  3.46912168  3.19198381  3.20567726  3.13356063\n  [71]  3.00886022  2.87204730  2.75876357  2.68043590  2.56274490  2.43739269  2.34148500  2.28298441  2.13661894  2.11484326\n  [81]  2.01926966",
        "  2.12274190  2.04586985  1.93851234  1.79815299  1.71714528  1.73832598  1.72402068  1.64374449  1.60186714\n  [91]  1.48570801  1.29261539  1.45347385  1.38132171  1.37152340  1.31187047  1.24858416  1.26222757  1.23886706  1.14665893\n [101]  1.16005710  1.06014073  1.09801210  1.06899332  1.04381957  1.00183627  0.97009427  0.86560619  0.91583102  0.85972625\n [111]  0.85956813  0.84615903  0.82565681  0.80751237  0.72203853  0.76113001  0.73623798  0.72556512  0.71060629  0.69209226\n [121]  0.67631737  0.65475518",
        "  0.62174926  0.96058436  1.28981930  1.52633821  1.64467719  1.70270778  1.01543171  1.43915742\n [131]  1.36821627  1.52803740  1.52862033  1.08214866  1.38084962  1.64815145  1.58109076  1.39368630  1.45986122  1.23365865\n [141]  1.44171477  1.36992978  1.32980054  1.19570052  1.32151644  1.26285762  1.24402249  1.20870248  0.92370870  1.13565171\n [151]  1.02335986  0.90062858  0.69195638  0.97083898  1.06793180  1.07191132  1.04128176  1.01020589  1.06804347  1.06547649\n [161]  0.94475960  0.94064760  1.01940546",
        "  0.97660828  0.91462127  0.96545695  0.93857957  0.87833414  0.86808224  0.85326264\n [171]  0.68848915  0.66679713  0.79378146  0.76999902  0.78382842  0.78695155  0.78334497  0.75829884  0.72200638  0.71977258\n [181]  0.71963179  0.70711010  0.67654067  0.63162659  0.64550963  0.63636090  0.56597620  0.52822870  0.52099034  0.55646320\n [191]  0.57788489  0.58311203  0.58313504  0.56586553  0.55519103  0.54246952  0.55688318  0.55194245  0.53801008  0.55025500\n [201]  0.50796625  0.56424062  0.56163944  0.53808692",
        "  0.52419457  0.50416401  0.49944041  0.52266163  0.51418945  0.53462139\n [211]  0.50443450  0.50311423  0.51535896  0.54671107  0.53973795  0.50498095  0.51682503  0.50651035  0.45392299  0.48193142\n [221]  0.51378672  0.52735712  0.50396968  0.52011783  0.52814140  0.52619759  0.48967107  0.44203451  0.55929178  0.54358685\n [231]  0.61627620  0.59098807  0.62372292  0.62943364  0.61652680  0.62871648  0.57259835  0.65559899  0.71088025  0.66429383\n [241]  0.65543435  0.74046506  1.21407565  1.48622217  1.37059284",
        "  1.32013914  1.47812052  1.31061583  1.24522287  1.57451402\n [251]  1.56798135  1.36118447  1.38136748  1.74144323  1.71593037  1.66595493  1.28143030  1.50548304  2.00463240  1.90285507\n [261]  1.43712591  1.32877836  1.46985952  2.01339056  1.64505316  2.03701883  1.69689478  1.36465772  1.18516357  0.80434577\n [271]  1.55618047  0.89525207  1.17405461  0.70157938  0.87907764  0.88289038  1.05486556  1.86924535  1.89835966  2.28896983\n [281]  2.45171091  2.06312028  1.80822566  1.04643097  1.32735557  2.15509234",
        "  0.88140130  0.67565385  0.77029363  1.36271769\n [291]  1.46689209  2.85148418  2.02982257  2.66558252  2.31204331  2.03888394  1.72566814  1.53825420  2.19028962  4.08573132\n [301]  5.64081068  8.03521777  4.88662081  5.63389275  6.60371851  4.70652684  5.93225780  4.16581092  3.22563205  4.20197621\n [311]  2.21040023  3.13355093  4.23257023  4.53229032  2.56338338  1.07581417  1.32592354  3.93709620  6.02821790  5.73093524\n [321]  4.03002699  2.16362699  5.81777404  8.05319138  7.13658738  8.85739213 12.10884515",
        " 10.46800500  9.67325332 10.21301306\n [331] 10.36896893 10.48008727 11.18518148 11.70331267 12.72707161 12.44771630 14.43771020 13.35923010 13.29365320 14.69608199\n [341] 12.62417818 14.11160730 11.72837777 16.70691888 19.59871425 19.14731122 17.95330752 18.50982854 17.89017700 13.37343576\n [351] 15.27482727 15.65830339 16.44369386 17.37650772 17.98800421 20.17295639 21.46357397 19.21575175 22.23119129 15.34015240\n [361] 15.58763060 19.49205837 20.55141397 21.30887576 24.26091055 25.51734302 23.04971903 24.67351766",
        " 16.89322797 19.16787446\n [371] 24.10389253 24.84150691 23.73174160 13.97500517 19.02867368 18.90485625 22.94430132 27.58601391 13.57742340 23.58451862\n [381] 16.27610793 34.90521278 38.41989958 38.16931614 36.57829199 34.45459326 41.85921967 39.36074152 38.54687735 37.81568586\n [391] 38.38933613 37.42526570 38.34301767 37.08836507 39.07011523 36.65364329 33.94965199 29.32878344 42.23976295 41.55542080\n [401] 45.52505209 40.35302599 42.95435315 46.40983819 46.46466833 49.72228716 50.66802208 57.88120873 50.39111611",
        " 52.71805718\n [411] 56.87064920 53.68018020 54.90836785 53.60476684 54.25021361 56.76837633 55.64089926 54.10882791 56.24511242 57.90995820\n [421] 57.36473369 57.07729818 56.85416941 58.52875631 55.24340576 50.13194035 56.20759371 56.37001992 55.30620321 57.87979301\n [431] 56.35251284 52.17657474 49.46989569 52.70176063 52.77528125 55.55168321 52.44533559 53.95309760 52.35245287 49.96635614\n [441] 44.93344314 46.65073183 50.66757371 54.00311508 56.61442230 49.85058828 57.63754895 61.35981337 53.80026548 59.03882075",
        "\n [451] 58.94488386 57.52617815 56.47234625 57.23265109 58.54738418 57.05730021 57.27574467 56.80788401 58.77247544 59.91246886\n [461] 58.75868622 56.47901254 58.78884436 58.18446706 58.94191422 57.74551611 59.72077655 57.99036951 63.04867501 60.43458007\n [471] 61.26021528 58.92504278 61.37364993 62.88982941 60.60629599 60.62280837 54.22764625 59.47214583 59.68175003 59.69981764\n [481] 60.60817644 59.76767190 59.07688167 60.71643769 61.92084982 61.87657308 59.74486975 60.22655548 56.64466595 57.59298546\n [491]",
        " 54.58201675 57.67009343 57.16620225 55.25018096 53.47642586 56.25821383 57.40034576 56.03282910 57.07402134 57.41100337\n [501] 57.27475151 58.35797312 57.28558919 57.72529161 57.59881181 57.33289103 56.30912526 58.41399473 58.40926478 56.85507220\n [511] 53.30773328 57.02660638 57.73882449 56.77964928 56.39535196 55.06869164 56.12594178 53.87044808 55.30135215 54.33152548\n [521] 54.72054439 54.17550645 54.38859876 55.01894174 53.62862137 54.55918974 55.32490708 55.27371531 54.88742141 54.84006040\n [531] 55.55873328",
        " 55.48349570 54.59686803 55.53499741 54.51826362 52.69288557 51.42689938 50.49341393 49.36759954 49.28240272\n [541] 49.82896082 48.67909256 50.19999574 51.14453537 51.60243156 51.86759357 51.16309160 53.02066579 53.06976233 53.79734936\n [551] 55.44193367 54.12557353 54.25775515 55.78447870 55.65912350 56.71558904 56.50705998 56.96239959 57.94105424 58.32228947\n [561] 57.81361781 55.82754791 54.65039782 53.55975892 52.13496390 49.66299826 51.00515042 50.04935120 50.19401689 49.72844070\n [571] 50.61881924 50.62611219",
        " 50.65743724 50.59322464 50.10024518 50.65724610 50.30134945 49.06852866 49.20731790 49.11610940\n [581] 50.48736282 50.47509669 51.20603259 51.41617233 51.21787453 52.16386396 51.71440355 52.12100924 53.60738478 54.37623850\n [591] 54.71534358 52.49173513 52.12983984 52.10758105 52.17309024 52.37504570 51.82147998 50.27308544 49.74375731 49.85734127\n [601] 50.07364786 48.47667708 50.16897612 48.36577644 47.70859068 47.42335862 47.86151120 45.97344903 47.70580657 44.86704117\n [611] 48.94672966 48.17760750 48.68210690",
        " 49.58436803 49.63353318 45.62648390 48.42660854 50.12895436 50.35097234 49.82207523\n [621] 50.76212174 51.37864546 50.25284341 50.67994924 50.32007331 48.34516877 48.81915207 49.33652606 48.58870869 48.74843552\n [631] 48.91300286 48.86196786 47.54404803 49.40747076 50.79658903 50.67300573 49.77857337 50.48676845 51.21871705 50.92796016\n [641] 50.77496468 51.14071559 49.46021544 48.31044354 48.18761702 48.75534195 48.13224167 48.24993147 48.40060984 48.19763426\n [651] 47.42805779 48.15189652 47.23925404 48.38286714",
        " 47.59087693 48.62937370 48.63508805 47.74254661 48.09482894 47.20106386\n [661] 47.74383765 48.44551831 47.80349331 48.02184425 47.15445624 47.19213380 47.78145305 47.04339126 46.58260044 46.42527424\n [671] 46.63531075 45.90533330 47.07260853 46.68687419 46.85162709 46.47037946 46.39987373 45.81311990 46.21319601 46.32735770\n [681] 46.31074947 46.14316929 46.08249966 45.48328777 45.82391197 45.24710565 45.30473156 45.34270181 44.80303232 44.41754998\n [691] 44.42606315 43.80765688 43.52712833 42.82807243 42.46358978",
        " 41.90302909 41.98497584 41.66391947 40.91527928 40.58954765\n [701] 40.32416754 39.64345530 39.30838277 38.76608886 38.64744121 38.39382331 38.34318395 37.85989835 37.75801406 37.33005290\n [711] 36.88802971 37.35468665 37.27977086 36.80870105 36.24079055 36.15848441 36.28446012 35.57446747 35.26948226 34.74895925\n [721] 35.14242654 33.97544704 34.55009988 34.15333243 34.17605499 34.19119840 33.96616860 33.67459485 33.41090204 33.29329329\n [731] 32.81469309 32.71074938 32.39910543 32.28734356 32.14930172 31.76133153",
        " 31.81040996 31.70715938 30.66478945 31.09254700\n [741] 30.83993721 30.98845319 30.69062097 30.68348403 30.06073853 29.99038593 29.98054462 29.48974864 29.47962692 29.21443969\n [751] 29.28428315 29.04299760 28.88439894 28.39169468 28.23908801 28.37485219 28.36608601 28.30635261 28.26489468 27.97667999\n [761] 26.78757629 26.55099128 26.30651996 26.35912336 26.00896143 26.15456101 25.88202025 25.61277449 25.98698427 26.11223510\n [771] 25.52860031 25.92127237 25.60319594 25.77607723 25.17711552 25.00802895 24.77985547",
        " 24.90513040 25.02782409 24.84298363\n [781] 25.37025019 25.17190637 24.74237596 24.90730165 25.22226586 25.35166313 25.24864751 25.44779766 25.29957068 25.20519772\n [791] 25.14448755 25.12361235 24.92183587 24.37604125 24.48556022 24.42205378 24.78906481 23.51971477 23.46987048 23.45945154\n [801] 24.12973607 23.72762777 23.65754385 24.01015595 23.28054543 23.88024667 23.07006975 23.39616750 22.92720465 22.80086181\n [811] 22.38112455 22.37122278 21.97439801 21.62134471 21.21262417 20.68086643 20.42703525 20.15793266",
        " 19.71362161 19.25952330\n [821] 19.06441715 18.49465399 18.13915280 17.81896095 17.50156940 17.22129218 16.93850395 16.76408341 16.31188661 15.92194518\n [831] 15.84268900 15.35837085 15.48975739 15.12398024 14.94324430 14.59839688 14.15560644 14.11919147 13.85971063 13.51330801\n [841] 13.27176841 13.16461749 13.05943710 12.93761635 12.60402595 12.40370647 12.31431653 12.12005200 11.90978712 11.77534755\n [851] 11.70330433 11.44509252 11.38937031 11.19075735 11.07071984 10.95953289 10.78076114 10.65005806 10.42417562",
        " 10.27967852\n [861] 10.16487965 10.02578413  9.77034227  9.75176357  9.57620299  9.46158298  9.36068435  9.20464404  9.03458153  8.97814905\n [871]  8.79571875  7.49010783  7.94828188  7.96523655  6.85161004  7.37495443  7.04334716  6.38425899  6.83055521  6.57391526\n [881]  6.03840100  6.41679465  6.25383017  5.76817538  5.93725186  5.77837538  5.54590604  5.46799430  5.45677213  5.27907973\n [891]  4.66862178  4.51272633  4.58070000  4.39866703  4.50690537  4.51982009  4.48715333  4.49992025  4.53578800  4.58072297",
        "\n [901]  4.47844411  4.50551876  4.51956104  4.44893310  4.38985642  4.41040264  4.35273517  4.32626581  4.28734994  4.28535181\n [911]  4.21763620  4.17038075  4.15533227  4.10565731  4.11711597  4.04953064  4.06438060  4.00047740  3.94133058  3.90729774\n [921]  3.90147144  3.88550811  3.82579776  3.77185467  3.74898091  3.68956127  3.59116717  3.60681015  3.58623228  3.52972271\n [931]  3.48655439  3.42853342  3.42253699  3.36527018  3.29140007  3.26955584  3.21910644  3.17891573  3.14621994  3.11139063\n [941]",
        "  3.07057153  3.03769087  3.01013677  2.98732424  2.95647850  2.92228470  2.90834330  2.88285538  2.85855495  2.84022190\n [951]  2.80921337  2.78843620  2.77255390  2.73452355  2.71995954  2.69625055  2.67289817  2.64517801  2.61941673  2.60163676\n [961]  2.58112442  2.56322974  2.52722413  2.48363684  2.44437444  2.40078261  2.35548713  2.31686878  2.27998662  2.25611588\n [971]  2.20685366  2.17412717  2.14310220  2.12287982  2.08298872  2.04238340  1.99193857  1.96538631  1.92216834  1.87119421\n [981]  1.84538515",
        "  1.80243446  1.77587446  1.72842499  1.68953335  1.65469281  1.61158470  1.57244745  1.54425790  1.50247320\n [991]  1.47792522  1.44855940  1.42168371  1.39596985  1.37066062  1.34182665  1.31776180  1.29492245  1.27274127  1.24670211\n [ reached getOption(\"max.print\") -- omitted 221 entries ]\n",
        "> ",
        "wavelength[1,]",
        "Error in wavelength[1, ] : incorrect number of dimensions\n",
        "> ",
        "wavelength",
        "   [1]    91    94    96    98   100   102   104   106   108   110   114   118   121   125   127   128   131   132   134   137   140\n  [22]   143   147   151   155   159   162   166   170   173   177   180   182   186   191   194   198   202   205   210   216   220\n  [43]   223   227   230   234   240   246   252   257   260   264   269   274   279   284   290   296   301   308   318   328   338\n  [64]   348   357   366   375   385   395   405   414   422   430   441   451   460   470   480   490   500   506",
        "   512   520   530\n  [85]   540   550   560   570   580   590   600   610   620   630   640   650   658   665   675   685   695   705   716   726   735\n [106]   745   755   765   775   785   795   805   815   825   835   845   855   865   875   885   895   905   915   925   935   945\n [127]   955   965   975   985   995  1005  1015  1025  1035  1045  1055  1065  1075  1085  1095  1105  1115  1125  1135  1145  1155\n [148]  1165  1175  1185  1195  1205  1215  1225  1235  1245  1255  1265  1275  1285  1295  1305",
        "  1315  1325  1335  1345  1355  1365\n [169]  1375  1385  1395  1405  1415  1425  1435  1442  1447  1455  1465  1475  1485  1495  1505  1512  1517  1525  1535  1545  1555\n [190]  1565  1575  1585  1595  1605  1615  1625  1635  1645  1655  1665  1672  1677  1685  1695  1705  1715  1725  1735  1745  1755\n [211]  1765  1775  1785  1795  1805  1815  1825  1835  1845  1855  1865  1875  1885  1895  1905  1915  1925  1935  1945  1955  1967\n [232]  1976  1984  1995  2005  2015  2025  2035  2045  2055  2065  2074  2078",
        "  2085  2095  2105  2115  2125  2135  2145  2155  2165\n [253]  2175  2185  2195  2205  2215  2225  2235  2245  2255  2265  2275  2285  2295  2305  2315  2325  2335  2345  2355  2365  2375\n [274]  2385  2395  2405  2415  2425  2435  2445  2455  2465  2475  2485  2495  2505  2513  2518  2525  2535  2545  2555  2565  2575\n [295]  2585  2595  2605  2615  2625  2635  2645  2655  2665  2675  2685  2695  2705  2715  2725  2735  2745  2755  2765  2775  2785\n [316]  2795  2805  2815  2825  2835  2845  2855  2865  2875",
        "  2885  2895  2910  2930  2950  2970  2990  3010  3030  3050  3070  3090\n [337]  3110  3130  3150  3170  3190  3210  3230  3250  3270  3290  3310  3330  3350  3370  3390  3410  3430  3450  3470  3490  3510\n [358]  3530  3550  3570  3590  3610  3630  3640  3650  3670  3690  3710  3730  3750  3770  3790  3810  3830  3850  3870  3890  3910\n [379]  3930  3950  3970  3990  4010  4030  4050  4070  4090  4110  4130  4150  4170  4190  4210  4230  4250  4270  4290  4310  4330\n [400]  4350  4370  4390  4410  4430  4450",
        "  4470  4490  4510  4530  4550  4570  4590  4610  4630  4650  4670  4690  4710  4730  4750\n [421]  4770  4790  4810  4830  4850  4870  4890  4910  4930  4950  4970  4990  5010  5030  5050  5070  5090  5110  5130  5150  5170\n [442]  5190  5210  5230  5250  5270  5290  5310  5330  5350  5370  5390  5410  5430  5450  5470  5490  5510  5530  5550  5570  5590\n [463]  5610  5630  5650  5670  5690  5710  5730  5750  5770  5790  5810  5830  5850  5870  5890  5910  5930  5950  5970  5990  6010\n [484]  6030  6050  6070",
        "  6090  6110  6130  6150  6170  6190  6210  6230  6250  6270  6290  6310  6330  6350  6370  6390  6410  6430\n [505]  6450  6470  6490  6510  6530  6550  6570  6590  6610  6630  6650  6670  6690  6710  6730  6750  6770  6790  6810  6830  6850\n [526]  6870  6890  6910  6930  6950  6970  6990  7010  7030  7050  7070  7090  7110  7130  7150  7170  7190  7210  7230  7250  7270\n [547]  7290  7310  7330  7350  7370  7390  7410  7430  7450  7470  7490  7510  7530  7550  7570  7590  7610  7630  7650  7670  7690\n [568]",
        "  7710  7730  7750  7770  7790  7810  7830  7850  7870  7890  7910  7930  7950  7970  7990  8010  8030  8050  8070  8090  8110\n [589]  8130  8150  8170  8190  8210  8230  8250  8270  8290  8310  8330  8350  8370  8390  8410  8430  8450  8470  8490  8510  8530\n [610]  8550  8570  8590  8610  8630  8650  8670  8690  8710  8730  8750  8770  8790  8810  8830  8850  8870  8890  8910  8930  8950\n [631]  8970  8990  9010  9030  9050  9070  9090  9110  9130  9150  9170  9190  9210  9230  9250  9270  9290  9310  9330",
        "  9350  9370\n [652]  9390  9410  9430  9450  9470  9490  9510  9530  9550  9570  9590  9610  9630  9650  9670  9690  9710  9730  9750  9770  9790\n [673]  9810  9830  9850  9870  9890  9910  9930  9950  9970  9990 10025 10075 10125 10175 10225 10275 10325 10375 10425 10475 10525\n [694] 10575 10625 10675 10725 10775 10825 10875 10925 10975 11025 11075 11125 11175 11225 11275 11325 11375 11425 11475 11525 11575\n [715] 11625 11675 11725 11775 11825 11875 11925 11975 12025 12075 12125 12175 12225 12275 12325 12375",
        " 12425 12475 12525 12575 12625\n [736] 12675 12725 12775 12825 12875 12925 12975 13025 13075 13125 13175 13225 13275 13325 13375 13425 13475 13525 13575 13625 13675\n [757] 13725 13775 13825 13875 13925 13975 14025 14075 14125 14175 14225 14275 14325 14375 14425 14475 14525 14570 14620 14675 14725\n [778] 14775 14825 14875 14925 14975 15025 15075 15125 15175 15225 15275 15325 15375 15425 15475 15525 15575 15625 15675 15725 15775\n [799] 15825 15875 15925 15975 16050 16150 16250 16350 16450 16550 16650 16750 16850",
        " 16950 17050 17150 17250 17350 17450 17550 17650\n [820] 17750 17850 17950 18050 18150 18250 18350 18450 18550 18650 18750 18850 18950 19050 19150 19250 19350 19450 19550 19650 19750\n [841] 19850 19950 20050 20150 20250 20350 20450 20550 20650 20750 20850 20950 21050 21150 21250 21350 21450 21550 21650 21750 21850\n [862] 21950 22050 22150 22250 22350 22450 22550 22650 22750 22850 22950 23050 23150 23250 23350 23450 23550 23650 23750 23850 23950\n [883] 24050 24150 24250 24350 24450 24550 24650 24750 24850 24950",
        " 25050 25150 25250 25350 25450 25550 25650 25750 25850 25950 26050\n [904] 26150 26250 26350 26450 26550 26650 26750 26850 26950 27050 27150 27250 27350 27450 27550 27650 27750 27850 27950 28050 28150\n [925] 28250 28350 28450 28550 28650 28750 28850 28950 29050 29150 29250 29350 29450 29550 29650 29750 29850 29950 30050 30150 30250\n [946] 30350 30450 30550 30650 30750 30850 30950 31050 31150 31250 31350 31450 31550 31650 31750 31850 31950 32100 32300 32500 32700\n [967] 32900 33100 33300 33500 33700 33900 34100",
        " 34300 34500 34700 34900 35100 35300 35500 35700 35900 36100 36300 36500 36700 36900\n [988] 37100 37300 37500 37700 37900 38100 38300 38500 38700 38900 39100 39300 39500\n [ reached getOption(\"max.print\") -- omitted 221 entries ]\n",
        "> ",
        "wave_shift[,1]",
        "[1] 90.97441 90.97887\n",
        "> ",
        "wave_shift[1,]",
        "   [1]    90.97441    93.97357    95.97301    97.97245    99.97188   101.97132   103.97076   105.97020   107.96963   109.96907\n  [11]   113.96795   117.96682   120.96598   124.96486   126.96429   127.96401   130.96317   131.96289   133.96232   136.96148\n  [21]   139.96064   142.95979   146.95867   150.95754   154.95642   158.95530   161.95445   165.95333   169.95220   172.95136\n  [31]   176.95023   179.94939   181.94883   185.94770   190.94630   193.94546   197.94433   201.94321   204.94236   209.94096\n  [41]",
        "   215.93927   219.93814   222.93730   226.93618   229.93533   233.93421   239.93252   245.93083   251.92915   256.92774\n  [51]   259.92690   263.92577   268.92437   273.92296   278.92156   283.92015   289.91846   295.91678   300.91537   307.91340\n  [61]   317.91059   327.90778   337.90497   347.90216   356.89963   365.89710   374.89457   384.89175   394.88894   404.88613\n  [71]   413.88360   421.88135   429.87910   440.87601   450.87320   459.87067   469.86786   479.86504   489.86223   499.85942\n  [81]   505.85773",
        "   511.85605   519.85380   529.85099   539.84817   549.84536   559.84255   569.83974   579.83693   589.83412\n  [91]   599.83130   609.82849   619.82568   629.82287   639.82006   649.81725   657.81500   664.81303   674.81022   684.80741\n [101]   694.80459   704.80178   715.79869   725.79588   734.79335   744.79054   754.78772   764.78491   774.78210   784.77929\n [111]   794.77648   804.77367   814.77086   824.76804   834.76523   844.76242   854.75961   864.75680   874.75399   884.75117\n [121]   894.74836   904.74555",
        "   914.74274   924.73993   934.73712   944.73430   954.73149   964.72868   974.72587   984.72306\n [131]   994.72025  1004.71743  1014.71462  1024.71181  1034.70900  1044.70619  1054.70338  1064.70057  1074.69775  1084.69494\n [141]  1094.69213  1104.68932  1114.68651  1124.68370  1134.68088  1144.67807  1154.67526  1164.67245  1174.66964  1184.66683\n [151]  1194.66401  1204.66120  1214.65839  1224.65558  1234.65277  1244.64996  1254.64714  1264.64433  1274.64152  1284.63871\n [161]  1294.63590  1304.63309  1314.63028",
        "  1324.62746  1334.62465  1344.62184  1354.61903  1364.61622  1374.61341  1384.61059\n [171]  1394.60778  1404.60497  1414.60216  1424.59935  1434.59654  1441.59457  1446.59316  1454.59091  1464.58810  1474.58529\n [181]  1484.58248  1494.57967  1504.57686  1511.57489  1516.57348  1524.57123  1534.56842  1544.56561  1554.56280  1564.55999\n [191]  1574.55717  1584.55436  1594.55155  1604.54874  1614.54593  1624.54312  1634.54030  1644.53749  1654.53468  1664.53187\n [201]  1671.52990  1676.52850  1684.52625  1694.52343",
        "  1704.52062  1714.51781  1724.51500  1734.51219  1744.50938  1754.50657\n [211]  1764.50375  1774.50094  1784.49813  1794.49532  1804.49251  1814.48970  1824.48688  1834.48407  1844.48126  1854.47845\n [221]  1864.47564  1874.47283  1884.47001  1894.46720  1904.46439  1914.46158  1924.45877  1934.45596  1944.45314  1954.45033\n [231]  1966.44696  1975.44443  1983.44218  1994.43909  2004.43628  2014.43346  2024.43065  2034.42784  2044.42503  2054.42222\n [241]  2064.41941  2073.41688  2077.41575  2084.41378  2094.41097",
        "  2104.40816  2114.40535  2124.40254  2134.39972  2144.39691\n [251]  2154.39410  2164.39129  2174.38848  2184.38567  2194.38285  2204.38004  2214.37723  2224.37442  2234.37161  2244.36880\n [261]  2254.36599  2264.36317  2274.36036  2284.35755  2294.35474  2304.35193  2314.34912  2324.34630  2334.34349  2344.34068\n [271]  2354.33787  2364.33506  2374.33225  2384.32943  2394.32662  2404.32381  2414.32100  2424.31819  2434.31538  2444.31257\n [281]  2454.30975  2464.30694  2474.30413  2484.30132  2494.29851  2504.29570",
        "  2512.29345  2517.29204  2524.29007  2534.28726\n [291]  2544.28445  2554.28164  2564.27883  2574.27601  2584.27320  2594.27039  2604.26758  2614.26477  2624.26196  2634.25914\n [301]  2644.25633  2654.25352  2664.25071  2674.24790  2684.24509  2694.24228  2704.23946  2714.23665  2724.23384  2734.23103\n [311]  2744.22822  2754.22541  2764.22259  2774.21978  2784.21697  2794.21416  2804.21135  2814.20854  2824.20572  2834.20291\n [321]  2844.20010  2854.19729  2864.19448  2874.19167  2884.18885  2894.18604  2909.18183",
        "  2929.17620  2949.17058  2969.16496\n [331]  2989.15933  3009.15371  3029.14809  3049.14246  3069.13684  3089.13122  3109.12559  3129.11997  3149.11435  3169.10872\n [341]  3189.10310  3209.09748  3229.09185  3249.08623  3269.08061  3289.07499  3309.06936  3329.06374  3349.05812  3369.05249\n [351]  3389.04687  3409.04125  3429.03562  3449.03000  3469.02438  3489.01875  3509.01313  3529.00751  3549.00188  3568.99626\n [361]  3588.99064  3608.98501  3628.97939  3638.97658  3648.97377  3668.96814  3688.96252  3708.95690",
        "  3728.95128  3748.94565\n [371]  3768.94003  3788.93441  3808.92878  3828.92316  3848.91754  3868.91191  3888.90629  3908.90067  3928.89504  3948.88942\n [381]  3968.88380  3988.87817  4008.87255  4028.86693  4048.86130  4068.85568  4088.85006  4108.84443  4128.83881  4148.83319\n [391]  4168.82757  4188.82194  4208.81632  4228.81070  4248.80507  4268.79945  4288.79383  4308.78820  4328.78258  4348.77696\n [401]  4368.77133  4388.76571  4408.76009  4428.75446  4448.74884  4468.74322  4488.73759  4508.73197  4528.72635",
        "  4548.72072\n [411]  4568.71510  4588.70948  4608.70385  4628.69823  4648.69261  4668.68699  4688.68136  4708.67574  4728.67012  4748.66449\n [421]  4768.65887  4788.65325  4808.64762  4828.64200  4848.63638  4868.63075  4888.62513  4908.61951  4928.61388  4948.60826\n [431]  4968.60264  4988.59701  5008.59139  5028.58577  5048.58014  5068.57452  5088.56890  5108.56328  5128.55765  5148.55203\n [441]  5168.54641  5188.54078  5208.53516  5228.52954  5248.52391  5268.51829  5288.51267  5308.50704  5328.50142  5348.49580",
        "\n [451]  5368.49017  5388.48455  5408.47893  5428.47330  5448.46768  5468.46206  5488.45643  5508.45081  5528.44519  5548.43956\n [461]  5568.43394  5588.42832  5608.42270  5628.41707  5648.41145  5668.40583  5688.40020  5708.39458  5728.38896  5748.38333\n [471]  5768.37771  5788.37209  5808.36646  5828.36084  5848.35522  5868.34959  5888.34397  5908.33835  5928.33272  5948.32710\n [481]  5968.32148  5988.31585  6008.31023  6028.30461  6048.29899  6068.29336  6088.28774  6108.28212  6128.27649  6148.27087\n [491]",
        "  6168.26525  6188.25962  6208.25400  6228.24838  6248.24275  6268.23713  6288.23151  6308.22588  6328.22026  6348.21464\n [501]  6368.20901  6388.20339  6408.19777  6428.19214  6448.18652  6468.18090  6488.17528  6508.16965  6528.16403  6548.15841\n [511]  6568.15278  6588.14716  6608.14154  6628.13591  6648.13029  6668.12467  6688.11904  6708.11342  6728.10780  6748.10217\n [521]  6768.09655  6788.09093  6808.08530  6828.07968  6848.07406  6868.06843  6888.06281  6908.05719  6928.05156  6948.04594\n [531]  6968.04032",
        "  6988.03470  7008.02907  7028.02345  7048.01783  7068.01220  7088.00658  7108.00096  7127.99533  7147.98971\n [541]  7167.98409  7187.97846  7207.97284  7227.96722  7247.96159  7267.95597  7287.95035  7307.94472  7327.93910  7347.93348\n [551]  7367.92785  7387.92223  7407.91661  7427.91099  7447.90536  7467.89974  7487.89412  7507.88849  7527.88287  7547.87725\n [561]  7567.87162  7587.86600  7607.86038  7627.85475  7647.84913  7667.84351  7687.83788  7707.83226  7727.82664  7747.82101\n [571]  7767.81539  7787.80977",
        "  7807.80414  7827.79852  7847.79290  7867.78728  7887.78165  7907.77603  7927.77041  7947.76478\n [581]  7967.75916  7987.75354  8007.74791  8027.74229  8047.73667  8067.73104  8087.72542  8107.71980  8127.71417  8147.70855\n [591]  8167.70293  8187.69730  8207.69168  8227.68606  8247.68043  8267.67481  8287.66919  8307.66356  8327.65794  8347.65232\n [601]  8367.64670  8387.64107  8407.63545  8427.62983  8447.62420  8467.61858  8487.61296  8507.60733  8527.60171  8547.59609\n [611]  8567.59046  8587.58484  8607.57922",
        "  8627.57359  8647.56797  8667.56235  8687.55672  8707.55110  8727.54548  8747.53985\n [621]  8767.53423  8787.52861  8807.52299  8827.51736  8847.51174  8867.50612  8887.50049  8907.49487  8927.48925  8947.48362\n [631]  8967.47800  8987.47238  9007.46675  9027.46113  9047.45551  9067.44988  9087.44426  9107.43864  9127.43301  9147.42739\n [641]  9167.42177  9187.41614  9207.41052  9227.40490  9247.39927  9267.39365  9287.38803  9307.38241  9327.37678  9347.37116\n [651]  9367.36554  9387.35991  9407.35429  9427.34867",
        "  9447.34304  9467.33742  9487.33180  9507.32617  9527.32055  9547.31493\n [661]  9567.30930  9587.30368  9607.29806  9627.29243  9647.28681  9667.28119  9687.27556  9707.26994  9727.26432  9747.25870\n [671]  9767.25307  9787.24745  9807.24183  9827.23620  9847.23058  9867.22496  9887.21933  9907.21371  9927.20809  9947.20246\n [681]  9967.19684  9987.19122 10022.18138 10072.16732 10122.15326 10172.13920 10222.12514 10272.11109 10322.09703 10372.08297\n [691] 10422.06891 10472.05485 10522.04080 10572.02674 10622.01268",
        " 10671.99862 10721.98456 10771.97051 10821.95645 10871.94239\n [701] 10921.92833 10971.91427 11021.90022 11071.88616 11121.87210 11171.85804 11221.84399 11271.82993 11321.81587 11371.80181\n [711] 11421.78775 11471.77370 11521.75964 11571.74558 11621.73152 11671.71746 11721.70341 11771.68935 11821.67529 11871.66123\n [721] 11921.64717 11971.63312 12021.61906 12071.60500 12121.59094 12171.57688 12221.56283 12271.54877 12321.53471 12371.52065\n [731] 12421.50659 12471.49254 12521.47848 12571.46442 12621.45036 12671.43630",
        " 12721.42225 12771.40819 12821.39413 12871.38007\n [741] 12921.36601 12971.35196 13021.33790 13071.32384 13121.30978 13171.29572 13221.28167 13271.26761 13321.25355 13371.23949\n [751] 13421.22543 13471.21138 13521.19732 13571.18326 13621.16920 13671.15514 13721.14109 13771.12703 13821.11297 13871.09891\n [761] 13921.08485 13971.07080 14021.05674 14071.04268 14121.02862 14171.01456 14221.00051 14270.98645 14320.97239 14370.95833\n [771] 14420.94427 14470.93022 14520.91616 14565.90351 14615.88945 14670.87398 14720.85993",
        " 14770.84587 14820.83181 14870.81775\n [781] 14920.80370 14970.78964 15020.77558 15070.76152 15120.74746 15170.73341 15220.71935 15270.70529 15320.69123 15370.67717\n [791] 15420.66312 15470.64906 15520.63500 15570.62094 15620.60688 15670.59283 15720.57877 15770.56471 15820.55065 15870.53659\n [801] 15920.52254 15970.50848 16045.48739 16145.45927 16245.43116 16345.40304 16445.37493 16545.34681 16645.31869 16745.29058\n [811] 16845.26246 16945.23435 17045.20623 17145.17812 17245.15000 17345.12188 17445.09377 17545.06565",
        " 17645.03754 17745.00942\n [821] 17844.98130 17944.95319 18044.92507 18144.89696 18244.86884 18344.84072 18444.81261 18544.78449 18644.75638 18744.72826\n [831] 18844.70014 18944.67203 19044.64391 19144.61580 19244.58768 19344.55956 19444.53145 19544.50333 19644.47522 19744.44710\n [841] 19844.41898 19944.39087 20044.36275 20144.33464 20244.30652 20344.27840 20444.25029 20544.22217 20644.19406 20744.16594\n [851] 20844.13783 20944.10971 21044.08159 21144.05348 21244.02536 21343.99725 21443.96913 21543.94101 21643.91290",
        " 21743.88478\n [861] 21843.85667 21943.82855 22043.80043 22143.77232 22243.74420 22343.71609 22443.68797 22543.65985 22643.63174 22743.60362\n [871] 22843.57551 22943.54739 23043.51927 23143.49116 23243.46304 23343.43493 23443.40681 23543.37869 23643.35058 23743.32246\n [881] 23843.29435 23943.26623 24043.23811 24143.21000 24243.18188 24343.15377 24443.12565 24543.09754 24643.06942 24743.04130\n [891] 24843.01319 24942.98507 25042.95696 25142.92884 25242.90072 25342.87261 25442.84449 25542.81638 25642.78826 25742.76014",
        "\n [901] 25842.73203 25942.70391 26042.67580 26142.64768 26242.61956 26342.59145 26442.56333 26542.53522 26642.50710 26742.47898\n [911] 26842.45087 26942.42275 27042.39464 27142.36652 27242.33840 27342.31029 27442.28217 27542.25406 27642.22594 27742.19782\n [921] 27842.16971 27942.14159 28042.11348 28142.08536 28242.05725 28342.02913 28442.00101 28541.97290 28641.94478 28741.91667\n [931] 28841.88855 28941.86043 29041.83232 29141.80420 29241.77609 29341.74797 29441.71985 29541.69174 29641.66362 29741.63551\n [941]",
        " 29841.60739 29941.57927 30041.55116 30141.52304 30241.49493 30341.46681 30441.43869 30541.41058 30641.38246 30741.35435\n [951] 30841.32623 30941.29811 31041.27000 31141.24188 31241.21377 31341.18565 31441.15753 31541.12942 31641.10130 31741.07319\n [961] 31841.04507 31941.01696 32090.97478 32290.91855 32490.86232 32690.80609 32890.74985 33090.69362 33290.63739 33490.58116\n [971] 33690.52493 33890.46869 34090.41246 34290.35623 34490.30000 34690.24377 34890.18753 35090.13130 35290.07507 35490.01884\n [981] 35689.96261",
        " 35889.90638 36089.85014 36289.79391 36489.73768 36689.68145 36889.62522 37089.56898 37289.51275 37489.45652\n [991] 37689.40029 37889.34406 38089.28782 38289.23159 38489.17536 38689.11913 38889.06290 39089.00667 39288.95043 39488.89420\n [ reached getOption(\"max.print\") -- omitted 221 entries ]\n",
        "> ",
        "test = approx(x = shifted_wave[1,], y = spectra[,1], xout = wavelength, rule=1)",
        "Error in xy.coords(x, y, setLab = FALSE) : \n  object 'shifted_wave' not found\n",
        "> ",
        "test = approx(x = wave_shift[1,], y = spectra[,1], xout = wavelength, rule=1)",
        "> ",
        "test = approx(x = wave_shift[1,], y = spectra[,1], xout = observation$wave_seq, rule=1)",
        "> ",
        "magplot(test$x, test$y, log=\"xy\", type=\"l\")",
        "Error in magplot(test$x, test$y, log = \"xy\", type = \"l\") : \n  could not find function \"magplot\"\n",
        "> ",
        "magplot(test$x, test$y, log=\"xy\", type=\"l\")",
        "Error in magplot(test$x, test$y, log = \"xy\", type = \"l\") : \n  could not find function \"magplot\"\n",
        "> ",
        "library(\"magicaxis\")",
        "> ",
        "magplot(test$x, test$y, log=\"xy\", type=\"l\")",
        "> ",
        "magplot(test$x, test$y, log=\"xy\", type=\"l\", grid=T)",
        "> ",
        "magplot(test$x, test$y, log=\"xy\", type=\"l\", grid=T)",
        "> ",
        "lines(wave_shift, spectra)",
        "Error in xy.coords(x, y) : 'x' and 'y' lengths differ\n",
        "> ",
        "lines(wave_shift, spectra[,1])",
        "Error in xy.coords(x, y) : 'x' and 'y' lengths differ\n",
        "> ",
        "lines(wave_shift[1,], spectra[,1], col=\"red\")",
        "> ",
        "lines(test$x, test$y)",
        "> ",
        "lines(wave_shift[2,], spectra[,2], col=\"red\")",
        "> ",
        "dim(wave_shift)",
        "[1]    2 1221\n",
        "> ",
        "cores = 1",
        "> ",
        "  c1 = snow::makeCluster(cores)",
        "> ",
        "  doSNOW::registerDoSNOW(c1)",
        "> ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wavelength, rule=1)",
        "+ ",
        "  }",
        "Error in foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\")) %dopar%  : \n  could not find function \"%dopar%\"\n",
        "> ",
        "library(parallel)",
        "> ",
        "  c1 = snow::makeCluster(cores)",
        "> ",
        "  doSNOW::registerDoSNOW(c1)",
        "> ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wavelength, rule=1)",
        "+ ",
        "  }",
        "Error in foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\")) %dopar%  : \n  could not find function \"%dopar%\"\n",
        "> ",
        "library(doParallel)",
        "Loading required package: foreach\n",
        "Loading required package: iterators\n",
        "> ",
        "  c1 = snow::makeCluster(cores)",
        "> ",
        "  doSNOW::registerDoSNOW(c1)",
        "> ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wavelength, rule=1)",
        "+ ",
        "  }",
        "Error in eval(a, envir = extra, enclos = obj$evalenv) : \n  object 'shifted_wave' not found\n",
        "> ",
        "shifted_wave = wave_shift",
        "> ",
        "wave_seq=observation$wave_seq",
        "> ",
        "  c1 = snow::makeCluster(cores)",
        "> ",
        "  doSNOW::registerDoSNOW(c1)",
        "> ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wave_seq, rule=1)",
        "+ ",
        "  }",
        "> ",
        "  closeAllConnections()",
        "Warning messages:\n",
        "1: ",
        "In .Internal(gc(verbose, reset, full)) :",
        "\n ",
        " closing unused connection 5 (<-localhost:11237)\n",
        "2: ",
        "In .Internal(gc(verbose, reset, full)) :",
        "\n ",
        " closing unused connection 4 (<-localhost:11237)\n",
        "3: ",
        "In .Internal(gc(verbose, reset, full)) :",
        "\n ",
        " closing unused connection 3 (<-localhost:11237)\n",
        "> ",
        "test = unlist(shifted_spectra, use.names=FALSE)",
        "> ",
        "test = approx(x = shifted_wave[i,], y = spectra[,i], xout = wave_seq, rule=1)",
        "Error in `[.data.frame`(spectra, , i) : undefined columns selected\n",
        "> ",
        "test = approx(x = shifted_wave[1,], y = spectra[,1], xout = wave_seq, rule=1)",
        "> ",
        "test = approx(x = shifted_wave[1,], y = spectra[,1], xout = wave_seq, rule=1)[2]",
        "> ",
        "  c1 = snow::makeCluster(cores)",
        "> ",
        "  doSNOW::registerDoSNOW(c1)",
        "> ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wave_seq, rule=1)[2]",
        "+ ",
        "  }",
        "> ",
        "  closeAllConnections()",
        "> ",
        "  output = matrix(unlist(shifted_spectra, use.names=FALSE), nrow = dim(shifted_wave)[1], byrow = FALSE)",
        "> ",
        "View(output)",
        "> ",
        "  output = matrix(unlist(shifted_spectra, use.names=FALSE), nrow = dim(shifted_wave)[1], byrow = TRUE)",
        "> ",
        "View(output)",
        "> ",
        "  output = colSums(output)",
        "> ",
        "magplot(wave_seq, output, tpe=l)",
        "Error in plot.window(...) : object 'l' not found\n",
        "> ",
        "magplot(wave_seq, output, type=l, log=\"xy\")",
        "Error in magaxis(side = side, majorn = majorn, minorn = minorn, tcl = tcl,  : \n  object 'l' not found\n",
        "> ",
        "magplot(wave_seq, output, type=\"l\", log=\"xy\")",
        "> ",
        " range(observation$aperture_region, na.rm = T)",
        "[1]  12 889\n",
        "> ",
        "diff(range(observation$aperture_region, na.rm = T))",
        "[1] 877\n",
        "> ",
        "  spectra = martix(data = NA, ncol = observation$wave_bin, nrow = diff(range(observation$aperture_region, na.rm = T)))",
        "Error in martix(data = NA, ncol = observation$wave_bin, nrow = diff(range(observation$aperture_region,  : \n  could not find function \"martix\"\n",
        "> ",
        "  spectra = matrix(data = NA, ncol = observation$wave_bin, nrow = diff(range(observation$aperture_region, na.rm = T)))",
        "> ",
        "View(spectra)",
        "> ",
        "i = 12",
        "> ",
        "  k = 1",
        "> ",
        ".interpolate_spectra = function(shifted_wave, spectra, wave_seq, cores){",
        "+ ",
        "  c1 = snow::makeCluster(cores)",
        "+ ",
        "  doSNOW::registerDoSNOW(c1)",
        "+ ",
        "",
        "+ ",
        "  shifted_spectra = foreach(i = 1:dim(shifted_wave)[1], .packages = c(\"pracma\"))%dopar%{",
        "+ ",
        "    approx(x = shifted_wave[i,], y = spectra[,i], xout = wave_seq, rule=1)[2]",
        "+ ",
        "  }",
        "+ ",
        "  closeAllConnections()",
        "+ ",
        "",
        "+ ",
        "  output = matrix(unlist(shifted_spectra, use.names=FALSE), nrow = dim(shifted_wave)[1], byrow = TRUE)",
        "+ ",
        "  output = colSums(output)",
        "+ ",
        "  return(output)",
        "+ ",
        "}",
        "> ",
        "    particle_IDs = paste0(\"V\", (galaxy_data$ID[galaxy_data$pixel_pos == i] + 1)) # IDs are indexed one out from the column numbers",
        "> ",
        "    intrinsic_spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "> ",
        "    velocity_los = galaxy_data$vy_obs[galaxy_data$pixel_pos == i]",
        "> ",
        "    wave = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs), byrow=T)",
        "> ",
        "    wave_shift = ((velocity_los / observation$c) * wave) + wave # using doppler formula to compute the shift in wavelengths cause by velocity",
        "> ",
        "    spectra[k,] = .interpolate_spectra(shifted_wave = wave_shift, spectra = intrinsic_spectra, wave_seq = observation$wave_seq, cores = cores)",
        "> ",
        "    k = k + 1",
        "> ",
        "View(spectra)",
        "> ",
        " k = 1",
        "> ",
        "  for (i in range(galaxy_data$pixel_pos)){",
        "+ ",
        "    particle_IDs = paste0(\"V\", (galaxy_data$ID[galaxy_data$pixel_pos == i] + 1)) # IDs are indexed one out from the column numbers",
        "+ ",
        "    intrinsic_spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "+ ",
        "    velocity_los = galaxy_data$vy_obs[galaxy_data$pixel_pos == i]",
        "+ ",
        "    wave = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs), byrow=T)",
        "+ ",
        "    wave_shift = ((velocity_los / observation$c) * wave) + wave # using doppler formula to compute the shift in wavelengths cause by velocity",
        "+ ",
        "    spectra[k,] = .interpolate_spectra(shifted_wave = wave_shift, spectra = intrinsic_spectra, wave_seq = observation$wave_seq, cores = cores)",
        "+ ",
        "    k = k + 1",
        "+ ",
        "  }",
        "> ",
        "View(spectra)",
        "> ",
        "seq(range(galaxy_data$pixel_pos))",
        "[1] 1 2\n",
        "> ",
        "range(galaxy_data$pixel_pos)",
        "[1]  12 889\n",
        "> ",
        "seq(range(galaxy_data$pixel_pos), by = 1)",
        "Error in seq.default(range(galaxy_data$pixel_pos), by = 1) : \n  'from' must be of length 1\n",
        "> ",
        "range(galaxy_data$pixel_pos)",
        "[1]  12 889\n",
        "> ",
        "seq(range(galaxy_data$pixel_pos)[1], range(galaxy_data$pixel_pos)[2])",
        "  [1]  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43\n [33]  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72  73  74  75\n [65]  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107\n [97] 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134",
        " 135 136 137 138 139\n[129] 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171\n[161] 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203\n[193] 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235\n[225] 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256",
        " 257 258 259 260 261 262 263 264 265 266 267\n[257] 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299\n[289] 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331\n[321] 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363\n[353] 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378",
        " 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395\n[385] 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427\n[417] 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459\n[449] 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491\n[481] 492 493 494 495 496 497 498 499 500",
        " 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523\n[513] 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555\n[545] 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587\n[577] 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619\n[609] 620 621 622",
        " 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651\n[641] 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683\n[673] 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715\n[705] 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746",
        " 747\n[737] 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779\n[769] 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811\n[801] 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 838 839 840 841 842 843\n[833] 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868",
        " 869 870 871 872 873 874 875\n[865] 876 877 878 879 880 881 882 883 884 885 886 887 888 889\n",
        "> ",
        "k = 1",
        "> ",
        "  for (i in seq(range(galaxy_data$pixel_pos)[1], range(galaxy_data$pixel_pos)[2])){",
        "+ ",
        "    particle_IDs = paste0(\"V\", (galaxy_data$ID[galaxy_data$pixel_pos == i] + 1)) # IDs are indexed one out from the column numbers",
        "+ ",
        "    intrinsic_spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "+ ",
        "    velocity_los = galaxy_data$vy_obs[galaxy_data$pixel_pos == i]",
        "+ ",
        "    wave = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs), byrow=T)",
        "+ ",
        "    wave_shift = ((velocity_los / observation$c) * wave) + wave # using doppler formula to compute the shift in wavelengths cause by velocity",
        "+ ",
        "    spectra[k,] = .interpolate_spectra(shifted_wave = wave_shift, spectra = intrinsic_spectra, wave_seq = observation$wave_seq, cores = cores)",
        "+ ",
        "    k = k + 1",
        "+ ",
        "  }",
        "Error in fst::read_fst(simspin_file, columns = particle_IDs, from = 8) : \n  Column 'V' not found\n",
        "> ",
        "View(shifted_spectra)",
        "> ",
        "length(particle_IDs) ",
        "[1] 1\n",
        "> ",
        "length(galaxy_data$ID[galaxy_data$pixel_pos == i])",
        "[1] 0\n",
        "> ",
        "View(spectra)",
        "> ",
        "  spectra = matrix(data = NA, ncol = observation$wave_bin, nrow = diff(range(observation$aperture_region, na.rm = T)))",
        "> ",
        "",
        "> ",
        "  k = 1",
        "> ",
        "  for (i in seq(range(galaxy_data$pixel_pos)[1], range(galaxy_data$pixel_pos)[2])){",
        "+ ",
        "    if (length(galaxy_data$ID[galaxy_data$pixel_pos == i]) > 0){",
        "+ ",
        "      particle_IDs = paste0(\"V\", (galaxy_data$ID[galaxy_data$pixel_pos == i] + 1)) # IDs are indexed one out from the column numbers",
        "+ ",
        "      intrinsic_spectra = fst::read_fst(simspin_file, columns = particle_IDs, from = 8)",
        "+ ",
        "      velocity_los = galaxy_data$vy_obs[galaxy_data$pixel_pos == i]",
        "+ ",
        "      wave = matrix(data = rep(wavelength, length(particle_IDs)), nrow = length(particle_IDs), byrow=T)",
        "+ ",
        "      wave_shift = ((velocity_los / observation$c) * wave) + wave # using doppler formula to compute the shift in wavelengths cause by velocity",
        "+ ",
        "      spectra[k,] = .interpolate_spectra(shifted_wave = wave_shift, spectra = intrinsic_spectra, wave_seq = observation$wave_seq, cores = cores)",
        "+ ",
        "      k = k + 1",
        "+ ",
        "    }",
        "+ ",
        "  }",
        "> ",
        "View(spectra)",
        "> ",
        "observation$aperture_region",
        "  [1]  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  12  13  14  15  16  17  18  19  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA\n [33]  NA  NA  NA  NA  NA  NA  39  40  41  42  43  44  45  46  47  48  49  50  51  52  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA\n [65]  NA  NA  NA  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  96\n [97]  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115  NA  NA  NA  NA  NA  NA  NA  NA",
        "  NA 125 126 127 128\n[129] 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146  NA  NA  NA  NA  NA  NA  NA 154 155 156 157 158 159 160\n[161] 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177  NA  NA  NA  NA  NA  NA 184 185 186 187 188 189 190 191 192\n[193] 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207  NA  NA  NA  NA  NA 213 214 215 216 217 218 219 220 221 222 223 224\n[225] 225 226 227 228 229 230 231 232 233 234 235 236 237 238  NA  NA  NA 242 243 244 245",
        " 246 247 248 249 250 251 252 253 254 255 256\n[257] 257 258 259 260 261 262 263 264 265 266 267 268 269  NA  NA 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288\n[289] 289 290 291 292 293 294 295 296 297 298 299  NA  NA 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320\n[321] 321 322 323 324 325 326 327 328 329  NA 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352\n[353] 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367",
        " 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384\n[385] 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416\n[417] 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448\n[449] 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480\n[481] 481 482 483 484 485 486 487 488 489",
        " 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512\n[513] 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544\n[545] 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570  NA 572 573 574 575 576\n[577] 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599  NA  NA 602 603 604 605 606 607 608\n[609] 609 610 611",
        " 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629  NA  NA 632 633 634 635 636 637 638 639 640\n[641] 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659  NA  NA  NA 663 664 665 666 667 668 669 670 671 672\n[673] 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688  NA  NA  NA  NA  NA 694 695 696 697 698 699 700 701 702 703 704\n[705] 705 706 707 708 709 710 711 712 713 714 715 716 717  NA  NA  NA  NA  NA  NA 724 725 726 727 728 729 730 731 732 733 734 735",
        " 736\n[737] 737 738 739 740 741 742 743 744 745 746 747  NA  NA  NA  NA  NA  NA  NA 755 756 757 758 759 760 761 762 763 764 765 766 767 768\n[769] 769 770 771 772 773 774 775 776  NA  NA  NA  NA  NA  NA  NA  NA  NA 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800\n[801] 801 802 803 804 805  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832\n[833] 833  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 849 850 851 852 853 854 855 856 857",
        " 858 859 860 861 862  NA  NA\n[865]  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 882 883 884 885 886 887 888 889  NA  NA  NA  NA  NA  NA  NA\n[897]  NA  NA  NA  NA\n",
        "> ",
        "galaxy_data$pixel_pos",
        "   [1] 849 852 819 700 639 548 421 423 548 521 460 578 608 638 671 642 551 552 521 579 549 578 605 573 632 455 369 393 451 542 451 604\n  [33] 665 548 542 757 186 184 189 217 251 337 367 367 338 430 459 490 519 520 490 490 461 400 430 401 372 341 340 402 337 368 367 335\n  [65] 396 398 368 397 428 486 488 547 458 424 514 514 454 425 363 392 451 512 364 274 274 362 392 273 274 365 365 364 394 363 334 305\n  [97] 275 304 303 242 244 242 214 155 215 248 186 246 277 248 278 276 366 336 337 308 398 397 366 308 249 220",
        " 371 372 372 369 309 309\n [129] 309 339 339 339 339 310 311 311 311 341 342 221 251 280 250 280 220 251 252 191 189 189 251 220 160 160 191 131 190 248 248 157\n [161] 188 155 127 185 158  68  70 100 100 131 129 100 100  99 158 161 161 161 221 222 221 191 190 191 190 219 220 189 219 219 189 190\n [193] 160 159 129 159 188 161 162 161 161 130 131 131 131 130 129 129 100  69  98  69  71  40  68  39  97 128 126 125  96 125 126 126\n [225] 155 157 187 187 158 217 186 186 125 125  96 127  97 125 185 184 184  41  40",
        "  40  68  45  46  16  18 111 142 112 141 142  82  52\n [257]  49  79  18  48  49  51 110 108 108  79 110 140 200 170 200 169 199 169 109 110  78  48 138  47  75 167 198 198 197 196 196 165\n [289] 225 196 195 196 135 165 136 137 137 108 107 105 105 135  16 105  76  77  77  16  17  47  75  14  14  13  72  42  42  71  12  42\n [321]  42  41  72  73 104  74  73 103 102 103 103 132 133 134 164 133 133 163 194 164 194 194 193 163 163 162 162 161 104 101 132 102\n [353]  72  44 102  74 105  46  15  14  12  42 195 164",
        " 105 105  76 165 196 257 257 163 103 194 193 254 224 224 163 192 192 223 252 223\n [385] 225 254 284 254 222 282 282 282 312 313 312 313 343 312 313 344 314 285 375 373 343 343 342 284 286 255 256 317 346 317 315 316\n [417] 316 318 287 287 255 285 226 225 226 226 226 228 227 197 165 196 198 135 138 170 230 201 170 168 200 231 231 291 288 258 259 259\n [449] 259 288 319 260 321 320 379 288 229 200 323 322 264 293 261 173 232 203 112  48  80 169 200 200 170 171 111 291 288 228 320 352\n [481] 505 474 502 502 472",
        " 354 383 324 384 381 348 318 409 379 440 471 471 470 441 380 406 436 468 498 526 496 436 436 376 347 377 343\n [513] 403 373 313 342 402 434 375 375 435 434 554 404 435 402 403 434 464 402 283 345 257 226 281 283 316 165 165 193  71  43 133 131\n [545]  18 143 292 419 356 325 356 447 358 329 299 237 207 234 145 144 206 176 235 206 235 297 296 329 115 323 165 597 563 654 833 467\n [577] 499 471 525 374 402 434 463 252 225 171 173 238 445 447 387 448 657 505 535 652 622 444 502 469 499 590 554 585 708 553 498 555",
        "\n [609] 492 469 410 381 382 410 411 530 533 584 616 735 798 860 742 680 624 822 767 714 771 747 717 658 716 717 688 658 628 658 624 624\n [641] 623 649 590 709 743 680 651 653 682 714 624 594 684 595 715 713 804 656 655 686 654 743 682 712 682 682 742 741 741 742 741 740\n [673] 770 710 680 710 741 801 801 801 861 832 833 832 831 832 771 742 741 742 712 712 742 772 805 745 715 745 746 830 886 885 857 887\n [705] 826 824 825 825 825 795 764 767 736 766 736 766 767 767 797 768 769 768 737 738 707 767 798 767 770",
        " 770 739 740 740 740 739 770\n [737] 799 769 858 859 858 798 769 769 708 679 679 679 709 740 769 768 707 707 677 708 737 675 676 706 796 737 765 704 764 824 856 825\n [769] 794 794 734 734 704 676 646 646 645 647 616 649 649 709 769 737 738 707 739 618 618 556 587 615 613 584 704 859 827 794 795 829\n [801] 887 886 886 889 889 831 830 830 889 858 858 830 800 799 831 859 858 828 829 799 769 829 828 857 796 885 795 765 796 826 856 746\n [833] 805 775 803 803 832 801 802 772 770 801 861 862 832 862 883 852 849 850",
        " 854 854 853 882 822 821 821 822 822 853 823 794 794 763\n [865] 763 794 793 793 824 823 792 760 761 760 788 758 760 759 789 818 787 849 882 852 883 822 853 851 821 792 793 819 818 789 788 760\n [897] 760 759 757 757 788 729 728 699 700 730 670 701 701 701 733 733 702 732 703 672 672 733 701 731 671 641 672 702 643 672 580 611\n [929] 640 639 668 607 638 608 607 669 729 698 787 790 789 697 698 728 761 700 670 642 762 731 760 791 762 850 851 760 787 788 850 883\n [961] 755 755 726 694 667 664 604 573 663 724 726",
        " 756 757 756 756 755 755 694 696 697 666 696 697 726 697 694 664 695 666 607 665 635\n [993] 635 605 575 633 633 634 604 603\n [ reached getOption(\"max.print\") -- omitted 10502 entries ]\n",
        "> ",
        "length(galaxy_data$pixel_pos)",
        "[1] 11502\n",
        "> ",
        "unique(galaxy_data$pixel_pos)",
        "  [1] 849 852 819 700 639 548 421 423 521 460 578 608 638 671 642 551 552 579 549 605 573 632 455 369 393 451 542 604 665 757 186 184\n [33] 189 217 251 337 367 338 430 459 490 519 520 461 400 401 372 341 340 402 368 335 396 398 397 428 486 488 547 458 424 514 454 425\n [65] 363 392 512 364 274 362 273 365 394 334 305 275 304 303 242 244 214 155 215 248 246 277 278 276 366 336 308 249 220 371 309 339\n [97] 310 311 342 221 280 250 252 191 160 131 190 157 188 127 185 158  68  70 100 129  99 161 222 219 159 162 130",
        "  69  98  71  40  39\n[129]  97 128 126 125  96 187  41  45  46  16  18 111 142 112 141  82  52  49  79  48  51 110 108 140 200 170 169 199 109  78 138  47\n[161]  75 167 198 197 196 165 225 195 135 136 137 107 105  76  77  17  14  13  72  42  12  73 104  74 103 102 132 133 134 164 163 194\n[193] 193 101  44  15 257 254 224 192 223 284 282 312 313 343 344 314 285 375 373 286 255 256 317 346 315 316 318 287 226 228 227 230\n[225] 201 168 231 291 288 258 259 319 260 321 320 379 229 323 322 264 293 261 173 232 203",
        "  80 171 352 505 474 502 472 354 383 324 384\n[257] 381 348 409 440 471 470 441 380 406 436 468 498 526 496 376 347 377 403 434 435 554 404 464 283 345 281  43 143 292 419 356 325\n[289] 447 358 329 299 237 207 234 145 144 206 176 235 297 296 115 597 563 654 833 467 499 525 374 463 238 445 387 448 657 535 652 622\n[321] 444 469 590 585 708 553 555 492 410 382 411 530 533 584 616 735 798 860 742 680 624 822 767 714 771 747 717 658 716 688 628 623\n[353] 649 709 743 651 653 682 594 684 595 715 713 804 656 655 686",
        " 712 741 740 770 710 801 861 832 831 772 805 745 746 830 886 885 857\n[385] 887 826 824 825 795 764 736 766 797 768 769 737 738 707 739 799 858 859 679 677 675 676 706 796 765 704 856 794 734 646 645 647\n[417] 618 556 587 615 613 827 829 889 800 828 775 803 802 862 883 850 854 853 882 821 823 763 793 792 760 761 788 758 759 789 818 787\n[449] 851 729 728 699 730 670 701 733 702 732 703 672 731 641 643 580 611 640 668 607 669 698 790 697 762 791 755 726 694 667 664 663\n[481] 724 756 696 666 695 635 575 633 634",
        " 603 572 544 545 546 576 606 577 574 636 637 602 515 516 485 483 513 484 482 543 453 332 452\n[513] 395 426 456 333 245 361 331 422 511 481 517 457 399 429 427 518 550 487 489 522 491 431 462 493 432 433 523 583 581 370 279 307\n[545] 306 582 610 612 673 609 644 614 674 855 725 494 391 218 247 216 302 213 243 156 820 408 536 659 648 773 268 177 328 417 298 540\n[577] 567 598 569 509 477 508 537 538 687 683 681 774 711 621 776 625 685 626 565 564 476 473 475 534 446 506 591 503 501 532 443 500\n[609] 560 593 561",
        " 562 589 588 619 558 559 438 527 524 497 557 586 617 705 678 650 620 349 289 294 355 351 416 378 439 495 405 407 166\n[641] 253  50 139  19 174 353 350 262 290 263 205 172 204 202 233 175 114 106 465 466 437 528 529 531 442 412 413 504 414 415 385 596\n[673] 592 566 295 265 236 267 269 266 326 357 386 418 449 420 359 360 389 390 478 450 479 570 507 539 568 480 510 627 599 388 327 146\n[705] 113\n",
        "> ",
        "length(unique(galaxy_data$pixel_pos))",
        "[1] 705\n",
        "> ",
        "View(spectra)",
        "> ",
        "library(FITSio)",
        "> ",
        "test = readFITS(file = \"/Volumes/Simulations/SAMI/cubes/9388000921_blue_7_Y17SAR3_P014_A3880T035.fits\")",
        "> ",
        "q = test$imDat[1,1,]",
        "> ",
        "q = test$imDat[25,25,]",
        "> ",
        "q = q[!is.na(q)]",
        "> ",
        "test$header",
        " [1] \"SIMPLE  =                    T / conforms to FITS standard                      \"\n [2] \"BITPIX  =                  -64 / array data type                                \"\n [3] \"NAXIS   =                    3 / number of array dimensions                     \"\n [4] \"NAXIS1  =                   50                                                  \"\n [5] \"NAXIS2  =                   50                                                  \"\n [6] \"NAXIS3  =                 2048                                                  \"",
        "\n [7] \"EXTEND  =                    T                                                  \"\n [8] \"WCSAXES =                    3 / Number of coordinate axes                      \"\n [9] \"CRPIX1  =                 25.5 / Pixel coordinate of reference point            \"\n[10] \"CRPIX2  =                 25.5 / Pixel coordinate of reference point            \"\n[11] \"CRPIX3  =               1024.0 / Pixel coordinate of reference point            \"\n[12] \"CDELT1  = -0.00013888888888889 / [deg] Coordinate increment at reference point  \"",
        "\n[13] \"CDELT2  =  0.00013888888888889 / [deg] Coordinate increment at reference point  \"\n[14] \"CDELT3  =        1.05031753786 / [m] Coordinate increment at reference point    \"\n[15] \"CUNIT1  = 'deg     '           / Units of coordinate increment and value        \"\n[16] \"CUNIT2  = 'deg     '           / Units of coordinate increment and value        \"\n[17] \"CUNIT3  = 'Angstrom'           / Units of coordinate increment and value        \"\n[18] \"CTYPE1  = 'RA---TAN'           / Right ascension, gnomonic projection           \"",
        "\n[19] \"CTYPE2  = 'DEC--TAN'           / Declination, gnomonic projection               \"\n[20] \"CTYPE3  = 'AWAV'               / Air wavelength (linear)                        \"\n[21] \"CRVAL1  =           336.917833 / [deg] Coordinate value at reference point      \"\n[22] \"CRVAL2  =             -29.8455 / [deg] Coordinate value at reference point      \"\n[23] \"CRVAL3  =       4724.474841231 / [m] Coordinate value at reference point        \"\n[24] \"CATARA  =    336.9178333333333                                                  \"",
        "\n[25] \"CATADEC =             -29.8455                                                  \"\n[26] \"LONPOLE =                180.0 / [deg] Native longitude of celestial pole       \"\n[27] \"LATPOLE =             -29.8455 / [deg] Native latitude of celestial pole        \"\n[28] \"RADESYS = 'FK5'                / Equatorial coordinate system                   \"\n[29] \"EQUINOX =               2000.0 / [yr] Equinox of equatorial coordinates         \"\n[30] \"WCS_SRC = 'Nominal '           / WCS Source                                     \"",
        "\n[31] \"NAME    = '9388000921'         / Object ID                                      \"\n[32] \"TOTALEXP=              12600.0 / Total exposure (seconds)                       \"\n[33] \"HGCUBING= '0d54069d3e0b'       / Hg changeset ID for cubing code                \"\n[34] \"HIERARCH RSS_FILE 1 = '21sep10019sci.fits' / Input RSS file 1                   \"\n[35] \"HIERARCH RSS_FILE 2 = '21sep10020sci.fits' / Input RSS file 2                   \"\n[36] \"HIERARCH RSS_FILE 3 = '21sep10021sci.fits' / Input RSS file 3                   \"",
        "\n[37] \"HIERARCH RSS_FILE 4 = '21sep10024sci.fits' / Input RSS file 4                   \"\n[38] \"HIERARCH RSS_FILE 5 = '21sep10025sci.fits' / Input RSS file 5                   \"\n[39] \"HIERARCH RSS_FILE 6 = '21sep10026sci.fits' / Input RSS file 6                   \"\n[40] \"HIERARCH RSS_FILE 7 = '21sep10027sci.fits' / Input RSS file 7                   \"\n[41] \"DCT_DATE= 'Dec  5 2016'        / DCT release date                               \"\n[42] \"DCT_VER = 'r3_139  '           / DCT version number                             \"",
        "\n[43] \"DETECXE =                 2048 / Last column of detector                        \"\n[44] \"DETECXS =                    1 / First column of detector                       \"\n[45] \"DETECYE =                 4102 / Last row of detector                           \"\n[46] \"DETECYS =                    1 / First row of detector                          \"\n[47] \"DETECTOR= 'E2V2A   '           / Detector name                                  \"\n[48] \"XPIXSIZE=                  15. / X Pixel size in microns                        \"",
        "\n[49] \"YPIXSIZE=                  15. / Y Pixel size in microns                        \"\n[50] \"METHOD  = 'CCD Charge shuffling technique' / Observing method                   \"\n[51] \"SPEED   = 'NORMAL  '           / Readout speed                                  \"\n[52] \"READAMP = 'RIGHT   '           / Readout amplifier                              \"\n[53] \"RO_GAIN =                 1.88 / Readout amplifier (inverse) gain (e-/ADU)      \"\n[54] \"RO_NOISE=                 3.61 / Readout noise (electrons)                      \"",
        "\n[55] \"ORIGIN  = 'AAO     '           / Originating Institution                        \"\n[56] \"TELESCOP= 'Anglo-Australian Telescope' / Telescope Name                         \"\n[57] \"ALT_OBS =                 1164 / Altitude of observatory in metres              \"\n[58] \"LAT_OBS =            -31.27704 / Observatory latitude in degrees                \"\n[59] \"LONG_OBS=             149.0661 / Observatory longitude in degrees               \"\n[60] \"RCT_VER = 'r3_73   '           / Run Control Task version number                \"",
        "\n[61] \"RCT_DATE= '13-Jan-2015'        / Run Control Task version date                  \"\n[62] \"INSTRUME= 'AAOMEGA-SAMI'       / Instrument in use                              \"\n[63] \"SPECTID = 'BL      '           / Spectrograph ID                                \"\n[64] \"GRATID  = '580V    '           / Disperser ID                                   \"\n[65] \"GRATTILT=                  0.7 / Grating tilt to be symmetric (degree)          \"\n[66] \"GRATLPMM=                582.0 / Disperser ruling (lines/mm)                    \"",
        "\n[67] \"ORDER   =                    1 / Spectrum order                                 \"\n[68] \"TDFCTVER= 'r11_80  '           / 2dF Control Task Version                       \"\n[69] \"TDFCTDAT= '15-Sep-2017'        / 2dF Control Task Version Date                  \"\n[70] \"DICHROIC= 'X5700   '           / Dichroic name                                  \"\n[71] \"OBSTYPE = 'OBJECT  '           / Observation type                               \"\n[72] \"TOPEND  = 'PF      '           / Telescope top-end                              \"",
        "\n[73] \"AXIS    = 'REF     '           / Current optical axis                           \"\n[74] \"AXIS_X  =                   0. / Optical axis x (mm)                            \"\n[75] \"AXIS_Y  =                   0. / Optical axis y (mm)                            \"\n[76] \"TRACKING= 'TRACKING'           / Telescope is tracking.                         \"\n[77] \"PLATEID = 'Y17SAR3_P014_A3880T035_A2399T035' / Plate ID (from config file)      \"\n[78] \"LABEL   = 'Y17SAR3_P014_A3880T035 - Run 35 galaxy plate 14 - field 1' / Configur\"",
        "\n[79] \"SCRUNCH =                    T / Has data been scrunched?                       \"\n[80] \"STDNAME = '999388000261'       / Name of standard star                          \"\n[81] \"BUNIT   = '10**(-16) erg /s /cm**2 /angstrom /pixel' / Units                    \"\n[82] \"DROPFACT=                  0.5 / Drizzle drop scaling                           \"\n[83] \"CBINGMET= 'Tophat  '           / Method adopted for cubing                      \"\n[84] \"IFUPROBE= '2       '           / Id number(s) of the SAMI IFU probe(s)          \"",
        "\n[85] \"PSFFWHM =    1.335518412795224                                                  \"\n[86] \"PSFALPHA=    1.231330989414815                                                  \"\n[87] \"PSFBETA =    2.688566484168633                                                  \"\n[88] \"RESCALE =    1.085026838444325 / Scaling applied to data                        \"\n[89] \"HISTORY Divided by long-slit flat field LFLATcombined.fits                      \"\n[90] \"HISTORY SMCOPTEX extracting using tram map 21sep19012tlm.fits                   \"",
        "\n[91] \"HISTORY Divided by fibre flat field 21sep19012red.fits                          \"\n[92] \"HISTORY Throughput calibrating using OFFSKY                                     \"\n[93] \"HISTORY Sky subtracting using sky fibres                                        \"\n[94] \"HISTORY No telluric correction performed                                        \"\n",
        "> ",
        "4724.474841231 - (1.05031753786 * 1024)",
        "[1] 3648.95\n",
        "> ",
        "4724.474841231 + (1.05031753786 * 1024)",
        "[1] 5800\n",
        "> ",
        "observation$wave_res",
        "[1] 1.04\n",
        "> ",
        "2048 - 1940 ",
        "[1] 108\n",
        "> ",
        "108/2",
        "[1] 54\n",
        "> ",
        "  spectra = matrix(data = NA, ncol = observation$wave_bin, nrow = observation$sbin^2)",
        "> ",
        "  spectra = matrix(data = seq(1,900), ncol = observation$wave_bin, nrow = observation$sbin^2)",
        "> ",
        "View(spectra)",
        "> ",
        "  cube = array(data = spectra, dim = c(observation$sbin, observation$sbin, observation$wave_bin))",
        "> ",
        "cube[,,1]",
        "      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23]\n [1,]    1   31   61   91  121  151  181  211  241   271   301   331   361   391   421   451   481   511   541   571   601   631   661\n [2,]    2   32   62   92  122  152  182  212  242   272   302   332   362   392   422   452   482   512   542   572   602   632   662\n [3,]    3   33   63   93  123  153  183  213  243   273   303   333   363   393   423   453   483   513   543",
        "   573   603   633   663\n [4,]    4   34   64   94  124  154  184  214  244   274   304   334   364   394   424   454   484   514   544   574   604   634   664\n [5,]    5   35   65   95  125  155  185  215  245   275   305   335   365   395   425   455   485   515   545   575   605   635   665\n [6,]    6   36   66   96  126  156  186  216  246   276   306   336   366   396   426   456   486   516   546   576   606   636   666\n [7,]    7   37   67   97  127  157  187  217  247   277   307   337   367   397   427",
        "   457   487   517   547   577   607   637   667\n [8,]    8   38   68   98  128  158  188  218  248   278   308   338   368   398   428   458   488   518   548   578   608   638   668\n [9,]    9   39   69   99  129  159  189  219  249   279   309   339   369   399   429   459   489   519   549   579   609   639   669\n[10,]   10   40   70  100  130  160  190  220  250   280   310   340   370   400   430   460   490   520   550   580   610   640   670\n[11,]   11   41   71  101  131  161  191  221  251   281   311",
        "   341   371   401   431   461   491   521   551   581   611   641   671\n[12,]   12   42   72  102  132  162  192  222  252   282   312   342   372   402   432   462   492   522   552   582   612   642   672\n[13,]   13   43   73  103  133  163  193  223  253   283   313   343   373   403   433   463   493   523   553   583   613   643   673\n[14,]   14   44   74  104  134  164  194  224  254   284   314   344   374   404   434   464   494   524   554   584   614   644   674\n[15,]   15   45   75  105  135  165",
        "  195  225  255   285   315   345   375   405   435   465   495   525   555   585   615   645   675\n[16,]   16   46   76  106  136  166  196  226  256   286   316   346   376   406   436   466   496   526   556   586   616   646   676\n[17,]   17   47   77  107  137  167  197  227  257   287   317   347   377   407   437   467   497   527   557   587   617   647   677\n[18,]   18   48   78  108  138  168  198  228  258   288   318   348   378   408   438   468   498   528   558   588   618   648   678\n[19,]   19",
        "   49   79  109  139  169  199  229  259   289   319   349   379   409   439   469   499   529   559   589   619   649   679\n[20,]   20   50   80  110  140  170  200  230  260   290   320   350   380   410   440   470   500   530   560   590   620   650   680\n[21,]   21   51   81  111  141  171  201  231  261   291   321   351   381   411   441   471   501   531   561   591   621   651   681\n[22,]   22   52   82  112  142  172  202  232  262   292   322   352   382   412   442   472   502   532   562   592   622",
        "   652   682\n[23,]   23   53   83  113  143  173  203  233  263   293   323   353   383   413   443   473   503   533   563   593   623   653   683\n[24,]   24   54   84  114  144  174  204  234  264   294   324   354   384   414   444   474   504   534   564   594   624   654   684\n[25,]   25   55   85  115  145  175  205  235  265   295   325   355   385   415   445   475   505   535   565   595   625   655   685\n[26,]   26   56   86  116  146  176  206  236  266   296   326   356   386   416   446   476   506",
        "   536   566   596   626   656   686\n[27,]   27   57   87  117  147  177  207  237  267   297   327   357   387   417   447   477   507   537   567   597   627   657   687\n[28,]   28   58   88  118  148  178  208  238  268   298   328   358   388   418   448   478   508   538   568   598   628   658   688\n[29,]   29   59   89  119  149  179  209  239  269   299   329   359   389   419   449   479   509   539   569   599   629   659   689\n[30,]   30   60   90  120  150  180  210  240  270   300   330   360   390",
        "   420   450   480   510   540   570   600   630   660   690\n      [,24] [,25] [,26] [,27] [,28] [,29] [,30]\n [1,]   691   721   751   781   811   841   871\n [2,]   692   722   752   782   812   842   872\n [3,]   693   723   753   783   813   843   873\n [4,]   694   724   754   784   814   844   874\n [5,]   695   725   755   785   815   845   875\n [6,]   696   726   756   786   816   846   876\n [7,]   697   727   757   787   817   847   877\n [8,]   698   728   758   788   818   848   878\n [9,]   699   729   759",
        "   789   819   849   879\n[10,]   700   730   760   790   820   850   880\n[11,]   701   731   761   791   821   851   881\n[12,]   702   732   762   792   822   852   882\n[13,]   703   733   763   793   823   853   883\n[14,]   704   734   764   794   824   854   884\n[15,]   705   735   765   795   825   855   885\n[16,]   706   736   766   796   826   856   886\n[17,]   707   737   767   797   827   857   887\n[18,]   708   738   768   798   828   858   888\n[19,]   709   739   769   799   829   859   889\n[20,]   710",
        "   740   770   800   830   860   890\n[21,]   711   741   771   801   831   861   891\n[22,]   712   742   772   802   832   862   892\n[23,]   713   743   773   803   833   863   893\n[24,]   714   744   774   804   834   864   894\n[25,]   715   745   775   805   835   865   895\n[26,]   716   746   776   806   836   866   896\n[27,]   717   747   777   807   837   867   897\n[28,]   718   748   778   808   838   868   898\n[29,]   719   749   779   809   839   869   899\n[30,]   720   750   780   810   840   870   900",
        "\n",
        "> ",
        "View(cube[,,1])",
        "> ",
        "magplot(type=\"n\", xlim =c(min(galaxy_data$x), max(galaxy_data$x)), ylim = c(min(galaxy_data$z_obs), max(galaxy_data$z_obs)))",
        "Error in magplot(type = \"n\", xlim = c(min(galaxy_data$x), max(galaxy_data$x)),  : \n  argument \"x\" is missing, with no default\n",
        "> ",
        "magplot(x = 0, type=\"n\", xlim =c(min(galaxy_data$x), max(galaxy_data$x)), ylim = c(min(galaxy_data$z_obs), max(galaxy_data$z_obs)), xlab=\"x\", ylab=\"z\")",
        "> ",
        "points(galaxy_data$x[galaxy_data$pixel_pos == 12], galaxy_data$z_obs[galaxy_data$pixel_pos == 12], pch=\"+\")",
        "> ",
        "points(galaxy_data$x[galaxy_data$pixel_pos == 13], galaxy_data$z_obs[galaxy_data$pixel_pos == 13], pch=\"+\", col=\"red\")",
        "> ",
        "points(galaxy_data$x[galaxy_data$pixel_pos == 14], galaxy_data$z_obs[galaxy_data$pixel_pos == 14], pch=\"+\", col=\"orange\")",
        "> ",
        "    message(\"FITS file written to: \", output_location)",
        "Error in message(\"FITS file written to: \", output_location) : \n  object 'output_location' not found\n",
        "> ",
        "output_location = \"./\"",
        "> ",
        "    message(\"FITS file written to: \", output_location)",
        "FITS file written to: ./\n",
        "> ",
        "      output_location = paste(\"./output_inc\", observation$inc_deg, \"deg_seeing\", observation$psf_fwhm,\".FITS\", sep=\"\")",
        "> ",
        "    message(\"FITS file written to: \", output_location)",
        "FITS file written to: ./output_inc70deg_seeing0.FITS\n",
        "> ",
        "simspin_file",
        "[1] \"/Users/00094926/Desktop/EAGLE_galaxyID44048_spectra.fst\"\n",
        "> ",
        "      out_file_name = stringr::str_split(simspin_file, \".\")",
        "> ",
        "      out_file_name = stringr::str_split(simspin_file, \".\")[[1]]",
        "> ",
        "      out_file_name = stringr::str_remove(simspin_file, \".fst\")",
        "> ",
        "      output_location = paste(out_file_name, \"_inc\", observation$inc_deg, \"deg_seeing\", observation$psf_fwhm,\"fwhm.FITS\", sep=\"\")",
        "> ",
        "output_location",
        "[1] \"/Users/00094926/Desktop/EAGLE_galaxyID44048_spectra_inc70deg_seeing0fwhm.FITS\"\n",
        "> ",
        "dim(cube)/2",
        "[1]  15  15 962\n",
        "> ",
        "dim(test$imDat)/2",
        "[1]   25   25 1024\n",
        "> ",
        "dim(cube)%/%2",
        "[1]  15  15 962\n",
        "> ",
        "j = array(data=NA, dim = c(19,19,100))",
        "> ",
        "dim(j)%/%2",
        "[1]  9  9 50\n",
        "> ",
        "dim(cube)/2",
        "[1]  15  15 962\n",
        "> ",
        "dim(j)/2",
        "[1]  9.5  9.5 50.0\n",
        "> ",
        "observation$sbin_seq[crpixn[1]]",
        "Error: object 'crpixn' not found\n",
        "> ",
        "    crpixn = dim(cube)%/%2",
        "> ",
        "observation$sbin_seq[crpixn[1]]",
        "[1] -0.943643\n",
        "> ",
        "c(observation$sbin_seq[crpixn[1]], observation$sbin_seq[crpixn[2]], observation$wave_seq[crpixn[3]])",
        "[1]   -0.943643   -0.943643 4699.440000\n",
        "> ",
        "observation$sbin_seq[crpixn[1]]/observation$ang_size",
        "[1] -0.5\n",
        "> ",
        "observation$sbin_seq[crpixn[1]]/observation$ang_size/3600",
        "[1] -0.0001388889\n",
        "> ",
        "observation$sbin_size",
        "[1] 0.943643\n",
        "> ",
        "observation$wave_res",
        "[1] 1.04\n",
        "> ",
        "test$hdr",
        "  [1] \"SIMPLE\"                                                        \"T\"                                                            \n  [3] \"BITPIX\"                                                        \"-64\"                                                          \n  [5] \"NAXIS\"                                                         \"3\"                                                            \n  [7] \"NAXIS1\"                                                        \"50\"                                                           ",
        "\n  [9] \"NAXIS2\"                                                        \"50\"                                                           \n [11] \"NAXIS3\"                                                        \"2048\"                                                         \n [13] \"EXTEND\"                                                        \"T\"                                                            \n [15] \"WCSAXES\"                                                       \"3\"                                                            ",
        "\n [17] \"CRPIX1\"                                                        \"25.5\"                                                         \n [19] \"CRPIX2\"                                                        \"25.5\"                                                         \n [21] \"CRPIX3\"                                                        \"1024.0\"                                                       \n [23] \"CDELT1\"                                                        \"-0.00013888888888889\"                                         ",
        "\n [25] \"CDELT2\"                                                        \"0.00013888888888889\"                                          \n [27] \"CDELT3\"                                                        \"1.05031753786\"                                                \n [29] \"CUNIT1\"                                                        \"deg\"                                                          \n [31] \"CUNIT2\"                                                        \"deg\"                                                          ",
        "\n [33] \"CUNIT3\"                                                        \"Angstrom\"                                                     \n [35] \"CTYPE1\"                                                        \"RA---TAN\"                                                     \n [37] \"CTYPE2\"                                                        \"DEC--TAN\"                                                     \n [39] \"CTYPE3\"                                                        \"AWAV\"                                                         ",
        "\n [41] \"CRVAL1\"                                                        \"336.917833\"                                                   \n [43] \"CRVAL2\"                                                        \"-29.8455\"                                                     \n [45] \"CRVAL3\"                                                        \"4724.474841231\"                                               \n [47] \"CATARA\"                                                        \"336.9178333333333\"                                            ",
        "\n [49] \"CATADEC\"                                                       \"-29.8455\"                                                     \n [51] \"LONPOLE\"                                                       \"180.0\"                                                        \n [53] \"LATPOLE\"                                                       \"-29.8455\"                                                     \n [55] \"RADESYS\"                                                       \"FK5\"                                                          ",
        "\n [57] \"EQUINOX\"                                                       \"2000.0\"                                                       \n [59] \"WCS_SRC\"                                                       \"Nominal\"                                                      \n [61] \"NAME\"                                                          \"9388000921\"                                                   \n [63] \"TOTALEXP\"                                                      \"12600.0\"                                                      ",
        "\n [65] \"HGCUBING\"                                                      \"0d54069d3e0b\"                                                 \n [67] \"HIERARCH RSS_FILE 1\"                                           \"21sep10019sci.fits\"                                           \n [69] \"HIERARCH RSS_FILE 2\"                                           \"21sep10020sci.fits\"                                           \n [71] \"HIERARCH RSS_FILE 3\"                                           \"21sep10021sci.fits\"                                           ",
        "\n [73] \"HIERARCH RSS_FILE 4\"                                           \"21sep10024sci.fits\"                                           \n [75] \"HIERARCH RSS_FILE 5\"                                           \"21sep10025sci.fits\"                                           \n [77] \"HIERARCH RSS_FILE 6\"                                           \"21sep10026sci.fits\"                                           \n [79] \"HIERARCH RSS_FILE 7\"                                           \"21sep10027sci.fits\"                                           ",
        "\n [81] \"DCT_DATE\"                                                      \"Dec  5 2016\"                                                  \n [83] \"DCT_VER\"                                                       \"r3_139\"                                                       \n [85] \"DETECXE\"                                                       \"2048\"                                                         \n [87] \"DETECXS\"                                                       \"1\"                                                            ",
        "\n [89] \"DETECYE\"                                                       \"4102\"                                                         \n [91] \"DETECYS\"                                                       \"1\"                                                            \n [93] \"DETECTOR\"                                                      \"E2V2A\"                                                        \n [95] \"XPIXSIZE\"                                                      \"15.\"                                                          ",
        "\n [97] \"YPIXSIZE\"                                                      \"15.\"                                                          \n [99] \"METHOD\"                                                        \"CCD Charge shuffling technique\"                               \n[101] \"SPEED\"                                                         \"NORMAL\"                                                       \n[103] \"READAMP\"                                                       \"RIGHT\"                                                        ",
        "\n[105] \"RO_GAIN\"                                                       \"1.88\"                                                         \n[107] \"RO_NOISE\"                                                      \"3.61\"                                                         \n[109] \"ORIGIN\"                                                        \"AAO\"                                                          \n[111] \"TELESCOP\"                                                      \"Anglo-Australian Telescope\"                                   ",
        "\n[113] \"ALT_OBS\"                                                       \"1164\"                                                         \n[115] \"LAT_OBS\"                                                       \"-31.27704\"                                                    \n[117] \"LONG_OBS\"                                                      \"149.0661\"                                                     \n[119] \"RCT_VER\"                                                       \"r3_73\"                                                        ",
        "\n[121] \"RCT_DATE\"                                                      \"13-Jan-2015\"                                                  \n[123] \"INSTRUME\"                                                      \"AAOMEGA-SAMI\"                                                 \n[125] \"SPECTID\"                                                       \"BL\"                                                           \n[127] \"GRATID\"                                                        \"580V\"                                                         ",
        "\n[129] \"GRATTILT\"                                                      \"0.7\"                                                          \n[131] \"GRATLPMM\"                                                      \"582.0\"                                                        \n[133] \"ORDER\"                                                         \"1\"                                                            \n[135] \"TDFCTVER\"                                                      \"r11_80\"                                                       ",
        "\n[137] \"TDFCTDAT\"                                                      \"15-Sep-2017\"                                                  \n[139] \"DICHROIC\"                                                      \"X5700\"                                                        \n[141] \"OBSTYPE\"                                                       \"OBJECT\"                                                       \n[143] \"TOPEND\"                                                        \"PF\"                                                           ",
        "\n[145] \"AXIS\"                                                          \"REF\"                                                          \n[147] \"AXIS_X\"                                                        \"0.\"                                                           \n[149] \"AXIS_Y\"                                                        \"0.\"                                                           \n[151] \"TRACKING\"                                                      \"TRACKING\"                                                     ",
        "\n[153] \"PLATEID\"                                                       \"Y17SAR3_P014_A3880T035_A2399T035\"                             \n[155] \"LABEL\"                                                         \"Y17SAR3_P014_A3880T035 - Run 35 galaxy plate 14 - field 1\"    \n[157] \"SCRUNCH\"                                                       \"T\"                                                            \n[159] \"STDNAME\"                                                       \"999388000261\"                                                 ",
        "\n[161] \"BUNIT\"                                                         \"10**(-16) erg\"                                                \n[163] \"DROPFACT\"                                                      \"0.5\"                                                          \n[165] \"CBINGMET\"                                                      \"Tophat\"                                                       \n[167] \"IFUPROBE\"                                                      \"2\"                                                            ",
        "\n[169] \"PSFFWHM\"                                                       \"1.335518412795224\"                                            \n[171] \"PSFALPHA\"                                                      \"1.231330989414815\"                                            \n[173] \"PSFBETA\"                                                       \"2.688566484168633\"                                            \n[175] \"RESCALE\"                                                       \"1.085026838444325\"                                            ",
        "\n[177] \"HISTORY Divided by long-slit flat field LFLATcombined.fits\"    \"HISTORY SMCOPTEX extracting using tram map 21sep19012tlm.fits\"\n[179] \"HISTORY Divided by fibre flat field 21sep19012red.fits\"        \"HISTORY Throughput calibrating using OFFSKY\"                  \n[181] \"HISTORY Sky subtracting using sky fibres\"                      \"HISTORY No telluric correction performed\"                     \n\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "> ",
        "cores = 6",
        "> ",
        "write_fits = T",
        "> ",
        "test = build_datacube(simspin_file = simspin_file, telescope = telescope, observing_strategy = observing_strategy, cores = 6, write_fits = T)",
        "\n",
        "\nRestarting R session...\n\n"
    ]
}