{
    "type": [
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        3,
        2,
        0,
        1,
        0,
        1,
        3,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        0,
        1,
        0,
        1,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        3,
        3,
        3,
        3,
        2,
        3,
        3,
        0,
        1,
        3,
        3,
        3,
        3,
        0,
        1,
        3,
        0,
        1,
        3,
        3,
        2,
        2,
        2,
        2,
        0,
        1,
        2,
        0,
        1,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        2,
        0,
        1,
        3,
        3,
        3,
        0,
        1,
        3,
        2
    ],
    "data": [
        " 2.258345e-19 3.104548e-19 1.082393e-19\n[13,] 8.174125e-20 4.255456e-20 1.122282e-19 2.629074e-19 1.626974e-19 2.679367e-19 2.517460e-19 4.679708e-19 4.675360e-19\n[14,] 3.700705e-20 7.324099e-20 1.592596e-19 3.377834e-19 7.296787e-20 1.532966e-19 3.310866e-20 4.069042e-19 4.143271e-19\n[15,] 1.356142e-19           NA 8.343637e-20 6.767935e-20 2.179432e-19 2.739173e-19 4.274973e-19 3.521263e-19 1.146917e-18\n[16,] 3.643511e-20 7.526855e-20 6.811869e-20 1.382688e-19 1.193505e-19 1.017347e-19 3.534177e-19 3.922767e-19",
        " 4.619727e-19\n[17,] 7.576602e-20 8.260574e-20 6.823054e-20 1.005077e-19 1.067684e-19 6.812967e-20 4.029960e-19 5.645456e-19 8.978691e-19\n[18,] 4.008530e-20 4.963389e-20 9.433910e-20 1.562254e-19 1.841634e-19 2.608992e-19 2.915531e-19 5.732673e-19 8.582057e-19\n[19,]           NA 7.264672e-20 3.299852e-20 1.417890e-19 1.627439e-19 1.887106e-19 5.125115e-19 2.896698e-19 7.934622e-19\n[20,]           NA 1.227796e-19 7.709701e-20 6.964756e-20 3.325329e-20 2.071845e-19 1.069474e-19 2.082519e-19 4.201044e-19\n[21,]           NA",
        "           NA 6.625710e-20 1.231678e-19 1.458891e-19 3.261643e-19 1.892594e-19 1.834274e-19 1.455406e-19\n[22,]           NA 3.653182e-20 1.455697e-19 1.012867e-19 7.472067e-20 6.840964e-20 7.352069e-20           NA 3.907844e-19\n[23,]           NA           NA           NA 3.376583e-20 1.087569e-19 1.781922e-19 1.446724e-19 1.979934e-19 1.857959e-19\n[24,]           NA           NA           NA           NA 1.783914e-19 9.290619e-20 1.911484e-19 3.154184e-20 1.010565e-19\n[25,]           NA           NA           NA",
        " 2.927769e-20 7.832961e-20 1.311626e-19           NA 1.966513e-19 1.013242e-19\n[26,]           NA           NA           NA           NA           NA 3.918426e-20 3.827907e-20           NA 7.322042e-20\n[27,]           NA           NA           NA           NA           NA 8.331856e-20 3.519830e-20 1.557857e-19 1.489905e-19\n[28,]           NA           NA           NA           NA           NA           NA           NA 3.830709e-20 1.782716e-19\n[29,]           NA           NA           NA           NA           NA",
        "           NA           NA           NA 3.518412e-20\n[30,]           NA           NA           NA           NA           NA           NA           NA           NA           NA\n             [,10]        [,11]        [,12]        [,13]        [,14]        [,15]        [,16]        [,17]        [,18]\n [1,]           NA           NA           NA           NA           NA           NA           NA           NA 3.671142e-20\n [2,]           NA           NA 1.043051e-19 3.858925e-20           NA 6.203534e-20           NA",
        "           NA           NA\n [3,]           NA 4.322267e-20 3.658994e-20           NA 3.812308e-20 1.343577e-19 1.276549e-19 4.107375e-20 3.729355e-20\n [4,] 3.334699e-20           NA 3.857304e-20 3.938570e-20 1.178098e-19 1.179459e-19 1.230015e-19           NA 1.085998e-19\n [5,] 1.129148e-19 3.310426e-20 1.212817e-19 6.817358e-20 1.115407e-19 6.171921e-20 7.016064e-20 3.841080e-20 1.148297e-19\n [6,] 7.383539e-20 3.251905e-20 3.120234e-20 7.176038e-20 3.039690e-20 3.379054e-20 1.432662e-19 1.634024e-19 7.583214e-20",
        "\n [7,] 7.882602e-20 6.898776e-20 2.726282e-19 2.202672e-19 1.156989e-19 2.691781e-19 1.571553e-19 4.383382e-19 3.282974e-19\n [8,] 1.407702e-19 1.495104e-19 1.694952e-19 1.543340e-19 1.051031e-19 3.093993e-20 1.139675e-19 1.910040e-19 2.207935e-19\n [9,] 1.255060e-19 5.388077e-19 2.662697e-19 2.674931e-19 1.693490e-19 5.636545e-19 1.890200e-19 3.353449e-19 4.109540e-19\n[10,] 1.443913e-19 3.505788e-19 6.261020e-19 6.931073e-19 6.955389e-19 5.585424e-19 6.179517e-19 6.531715e-19 8.963397e-19\n[11,] 4.399796e-19 4.610762e-19",
        " 5.493462e-19 1.067445e-18 9.677763e-19 1.424049e-18 1.246635e-18 5.385835e-19 9.254003e-19\n[12,] 3.395846e-19 4.413418e-19 3.237888e-19 1.009972e-18 1.330692e-18 1.415710e-18 1.603942e-18 1.401847e-18 7.765948e-19\n[13,] 5.138482e-19 6.897918e-19 7.575456e-19 1.166701e-18 2.618029e-18 2.632631e-18 2.277230e-18 3.541589e-18 2.380466e-18\n[14,] 5.070717e-19 1.227508e-18 1.210187e-18 2.299664e-18 5.001369e-18 9.072629e-18 7.026195e-18 5.775874e-18 3.043400e-18\n[15,] 6.009698e-19 1.082262e-18 2.536168e-18 3.567647e-18",
        " 6.439225e-18 1.264127e-17 1.588346e-17 1.034405e-17 7.603373e-18\n[16,] 1.432977e-18 1.884892e-18 3.153159e-18 4.418426e-18 8.059262e-18 1.469928e-17 1.835844e-17 9.362608e-18 6.166915e-18\n[17,] 9.758907e-19 2.500508e-18 3.072990e-18 2.927646e-18 4.656656e-18 6.851425e-18 9.700031e-18 8.316624e-18 1.897559e-18\n[18,] 1.095874e-18 1.082539e-18 1.762883e-18 2.321651e-18 3.337674e-18 3.173822e-18 4.446564e-18 2.234040e-18 1.854140e-18\n[19,] 4.305372e-19 6.829207e-19 1.130947e-18 1.284943e-18 1.479587e-18 1.314128e-18",
        " 1.645849e-18 1.750489e-18 1.785912e-18\n[20,] 3.392706e-19 7.578023e-19 1.151065e-18 1.300243e-18 1.314901e-18 1.199792e-18 7.177013e-19 1.252483e-18 6.489903e-19\n[21,] 4.520587e-19 6.372920e-19 8.012903e-19 6.285764e-19 6.078434e-19 5.764876e-19 5.194727e-19 3.915463e-19 7.679697e-19\n[22,] 7.185846e-19 7.039416e-19 5.836853e-19 6.049813e-19 1.680534e-19 3.732016e-19 5.325918e-19 4.882356e-19 1.842984e-19\n[23,] 4.484551e-19 1.544048e-19 3.654391e-19 3.510102e-19 9.103468e-20 4.559240e-19 4.519587e-19 2.913075e-19",
        " 6.047357e-19\n[24,] 1.090163e-19 6.749172e-20 1.218508e-19 2.178004e-19 2.555135e-19 1.444139e-19 1.882963e-19 3.723093e-20 1.833603e-19\n[25,] 1.300767e-19 1.517763e-19 1.088955e-19 2.829497e-19 7.717159e-20           NA 7.200562e-20 1.021055e-19 2.298798e-19\n[26,] 1.097005e-19 1.530241e-19 1.159826e-19 1.182156e-19 7.647839e-20 1.686882e-19 7.243470e-20 4.787231e-20 4.331017e-20\n[27,] 5.473821e-20 3.818829e-20 1.135481e-19 1.080594e-19 1.019072e-19 3.750808e-20           NA 1.067156e-19 3.786154e-20\n[28,] 8.849484e-20",
        " 1.506891e-19 3.967395e-20 7.467013e-20 7.431337e-20 6.590333e-20           NA 2.890640e-20           NA\n[29,] 3.506962e-20 1.650557e-19           NA 1.138142e-19 4.032697e-20 3.500224e-20 4.638633e-20 7.557251e-20 3.631428e-20\n[30,]           NA           NA 3.740246e-20           NA 2.337256e-19 8.088527e-20 8.773681e-20 3.542371e-20           NA\n             [,19]        [,20]        [,21]        [,22]        [,23]        [,24]        [,25]        [,26]        [,27]\n [1,] 5.133080e-20           NA           NA",
        "           NA           NA           NA           NA           NA           NA\n [2,] 1.106959e-19 7.657572e-20 3.751874e-20 6.207220e-20           NA           NA           NA           NA           NA\n [3,] 7.181284e-20 8.059489e-20 3.521821e-20 5.158416e-20 4.372913e-20           NA           NA           NA           NA\n [4,] 8.240276e-20 1.429900e-19 3.906073e-20           NA           NA           NA 7.376540e-20           NA           NA\n [5,] 1.916116e-19 1.102230e-19           NA 4.237123e-19 8.375924e-20",
        " 6.863220e-20           NA           NA           NA\n [6,] 2.490200e-19 8.283102e-20 3.764056e-20 1.094533e-19           NA 8.215555e-20 3.950690e-19 1.962718e-19           NA\n [7,] 1.424709e-19 1.643739e-19 2.164894e-19 3.091568e-19 2.200303e-19           NA 6.734204e-20 9.958787e-20 1.502058e-19\n [8,] 4.867463e-19 1.536959e-19 3.557261e-19 6.909346e-20 3.739269e-19 8.143067e-20 3.666972e-20 3.584051e-20 2.933298e-19\n [9,] 1.898794e-19 2.750174e-19 2.201442e-19 1.498190e-19 1.232085e-19 2.999399e-19 2.155178e-19",
        " 1.161429e-19 1.459905e-19\n[10,] 8.174820e-19 2.981407e-19 1.971544e-19 1.720191e-19 1.875984e-19 1.739816e-19 1.666827e-19 1.070434e-19           NA\n[11,] 8.777565e-19 3.161446e-19 2.638283e-19 3.929778e-19 1.138030e-19 1.154584e-19 1.135990e-19 1.464778e-19 1.973895e-19\n[12,] 1.190476e-18 7.295520e-19 7.086740e-19 2.595972e-19 2.012440e-19 1.371451e-19 1.667278e-19 2.317109e-19           NA\n[13,] 1.751989e-18 1.276210e-18 5.159088e-19 6.709208e-19 4.401504e-19 1.610600e-19 1.030837e-19 1.287684e-19 8.139909e-20",
        "\n[14,] 2.808861e-18 1.085068e-18 1.209265e-18 6.554288e-19 1.585345e-19 1.987862e-19 1.083863e-19 2.602104e-19 1.179612e-19\n[15,] 3.032168e-18 1.908519e-18 1.124850e-18 5.341619e-19 2.497198e-19 5.172961e-19 1.247307e-19 2.165870e-19 1.595302e-19\n[16,] 2.482000e-18 1.482184e-18 5.388236e-19 4.071330e-19 2.242651e-19 6.495347e-19 6.931582e-20 3.139960e-19 1.610940e-19\n[17,] 1.747118e-18 6.948761e-19 6.197653e-19 4.471892e-19 2.747376e-19 3.299792e-19 2.321734e-19 3.648901e-20 3.952334e-19\n[18,] 1.043917e-18 5.262009e-19",
        " 8.545860e-19 4.788958e-19 1.787092e-19 3.229111e-19 3.108207e-19 7.718139e-20 2.897070e-19\n[19,] 8.643818e-19 8.941893e-19 5.525364e-19 7.239704e-19 3.950309e-19 1.112569e-19 2.549931e-19 8.563748e-20           NA\n[20,] 9.386376e-19 9.782332e-19 5.324526e-19 1.617465e-19 2.856619e-19 1.220038e-19 2.053517e-19 2.774547e-19 7.120549e-20\n[21,] 6.724753e-19 2.585940e-19 3.179568e-19 3.164869e-20 2.528948e-19 1.029358e-19 1.081505e-19 3.367915e-20           NA\n[22,] 2.977322e-19 7.479179e-20 1.091991e-19 1.279975e-19",
        " 4.095735e-20 4.224916e-20 1.176843e-19 4.125860e-20 7.540220e-20\n[23,] 1.193808e-19 1.704498e-19 7.241223e-20           NA 3.724409e-20 8.687266e-20 1.921751e-19 1.093042e-19 7.476576e-20\n[24,] 1.960208e-19 4.148422e-20 2.355768e-19 1.655160e-19 3.832947e-20           NA           NA           NA 3.534029e-20\n[25,] 8.389669e-20 6.410751e-20 1.131041e-19 6.942446e-20 1.220763e-19 1.419951e-19 7.490313e-20           NA 4.393620e-20\n[26,]           NA           NA 6.588847e-20           NA 4.246208e-20 8.144020e-20",
        " 7.296473e-20 2.899703e-19           NA\n[27,] 6.468926e-20           NA 7.037965e-20           NA 7.238128e-20 6.454110e-20           NA           NA           NA\n[28,] 1.406072e-19 3.333121e-20           NA           NA 3.784301e-20           NA           NA           NA           NA\n[29,]           NA 3.263337e-20 7.895699e-20 1.118507e-19           NA           NA           NA           NA           NA\n[30,] 6.257702e-20           NA           NA           NA           NA           NA           NA           NA",
        "           NA\n             [,28]        [,29]        [,30]\n [1,]           NA           NA           NA\n [2,]           NA           NA           NA\n [3,]           NA           NA           NA\n [4,]           NA           NA           NA\n [5,]           NA           NA           NA\n [6,]           NA           NA           NA\n [7,]           NA           NA           NA\n [8,] 3.957324e-20           NA           NA\n [9,] 5.066291e-20 8.493380e-20           NA\n[10,] 4.116626e-20 8.325977e-20           NA\n[11,]",
        " 8.490723e-20           NA           NA\n[12,] 1.449824e-19 6.766994e-20 7.568593e-20\n[13,] 1.525929e-19 4.723534e-20 3.574629e-20\n[14,]           NA 4.925841e-20 4.020996e-20\n[15,] 7.155284e-20 6.275042e-20 3.383389e-20\n[16,] 2.960799e-20 1.599485e-19 7.801789e-20\n[17,] 3.705262e-20 1.156747e-19 3.155907e-20\n[18,] 4.020114e-20 7.937667e-20 3.391891e-20\n[19,] 2.045673e-19           NA           NA\n[20,] 4.283290e-20 8.076591e-20           NA\n[21,] 3.646876e-20 3.548428e-20           NA\n[22,]           NA           NA",
        "           NA\n[23,] 7.704721e-20           NA           NA\n[24,]           NA           NA           NA\n[25,]           NA           NA           NA\n[26,]           NA           NA           NA\n[27,]           NA           NA           NA\n[28,]           NA           NA           NA\n[29,]           NA           NA           NA\n[30,]           NA           NA           NA\n",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "library(ProFit)",
        "Loading required package: FITSio\n",
        "Loading required package: magicaxis\n",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "x = ProFit::profitBruteConv(spectral_cube[,,800], observation$psf_kernel)",
        "> ",
        "View(x)",
        "> ",
        "ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "    blur_cube[,,spatial_plane] = ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = matrix(1,dim(spectral_cube)[1], dim(spectral_cube)[2]))",
        "> ",
        "ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = matrix(1,dim(spectral_cube)[1], dim(spectral_cube)[2]))",
        "> ",
        "  }",
        "Error: unexpected '}' in \"  }\"\n",
        "> ",
        "ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = matrix(1,dim(spectral_cube)[1], dim(spectral_cube)[2]))",
        "> ",
        "ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel, docalcregion = T)",
        "Error in profitConvolve(convolver, image, psf, mask = if (docalcregion) calcregion else NULL) : \n  LOGICAL() can only be applied to a 'logical', not a 'double'\n",
        "In addition: ",
        "Warning message:\n",
        "In if (dim(calcregion) != dim(image)) { :",
        "\n ",
        " the condition has length > 1 and only the first element will be used\n",
        "> ",
        "ProFit::profitConvolvePSF(spectral_cube[,,spatial_plane], observation$psf_kernel, docalcregion = TRUE)",
        "Error in profitConvolve(convolver, image, psf, mask = if (docalcregion) calcregion else NULL) : \n  LOGICAL() can only be applied to a 'logical', not a 'double'\n",
        "In addition: ",
        "Warning message:\n",
        "In if (dim(calcregion) != dim(image)) { :",
        "\n ",
        " the condition has length > 1 and only the first element will be used\n",
        "> ",
        "devtools::install_github(\"asgr/ProFit\")",
        "Downloading GitHub repo asgr/ProFit@HEAD\n",
        "Skipping 1 packages not available: R2Cuba\n",
        "Installing 2 packages: fftw, R2Cuba\n",
        "Error: Failed to install 'ProFit' from GitHub:\n  (converted from warning) package ‘R2Cuba’ is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, docalcregion = TRUE)",
        "Error in ProFit::profitBruteConv(spectral_cube[, , spatial_plane], observation$psf_kernel,  : \n  Calc region has different dimensions than the image\n",
        "In addition: ",
        "Warning message:\n",
        "In if (dim(calcregion) != dim(image)) { :",
        "\n ",
        " the condition has length > 1 and only the first element will be used\n",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = matrix(1,30,30))",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = matrix(1,nrow = 30, ncol=30))",
        "> ",
        "observation$aperture_region",
        "  [1]  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  12  13  14  15  16  17  18  19  NA  NA  NA  NA\n [24]  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  39  40  41  42  43  44  45  46\n [47]  47  48  49  50  51  52  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  68  69\n [70]  70  71  72  73  74  75  76  77  78  79  80  81  82  83  NA  NA  NA  NA  NA  NA  NA  NA  NA\n [93]  NA  NA  NA  96  97  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115\n[116]  NA  NA  NA  NA  NA",
        "  NA  NA  NA  NA 125 126 127 128 129 130 131 132 133 134 135 136 137 138\n[139] 139 140 141 142 143 144 145 146  NA  NA  NA  NA  NA  NA  NA 154 155 156 157 158 159 160 161\n[162] 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177  NA  NA  NA  NA  NA  NA 184\n[185] 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207\n[208]  NA  NA  NA  NA  NA 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230\n[231] 231 232 233 234 235 236 237 238  NA  NA  NA",
        " 242 243 244 245 246 247 248 249 250 251 252 253\n[254] 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269  NA  NA 272 273 274 275 276\n[277] 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299\n[300]  NA  NA 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322\n[323] 323 324 325 326 327 328 329  NA 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345\n[346] 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362",
        " 363 364 365 366 367 368\n[369] 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391\n[392] 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414\n[415] 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437\n[438] 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460\n[461] 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483",
        "\n[484] 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506\n[507] 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529\n[530] 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552\n[553] 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570  NA 572 573 574 575\n[576] 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598\n[599] 599  NA  NA 602",
        " 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621\n[622] 622 623 624 625 626 627 628 629  NA  NA 632 633 634 635 636 637 638 639 640 641 642 643 644\n[645] 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659  NA  NA  NA 663 664 665 666 667\n[668] 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688  NA  NA\n[691]  NA  NA  NA 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713\n[714] 714 715 716 717  NA  NA  NA  NA  NA  NA",
        " 724 725 726 727 728 729 730 731 732 733 734 735 736\n[737] 737 738 739 740 741 742 743 744 745 746 747  NA  NA  NA  NA  NA  NA  NA 755 756 757 758 759\n[760] 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776  NA  NA  NA  NA  NA  NA\n[783]  NA  NA  NA 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805\n[806]  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA 818 819 820 821 822 823 824 825 826 827 828\n[829] 829 830 831 832 833  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA",
        "  NA  NA  NA  NA 849 850 851\n[852] 852 853 854 855 856 857 858 859 860 861 862  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA\n[875]  NA  NA  NA  NA  NA  NA  NA 882 883 884 885 886 887 888 889  NA  NA  NA  NA  NA  NA  NA  NA\n[898]  NA  NA  NA\n",
        "> ",
        "  calc_region = observation$aperture_region ",
        "> ",
        "  cube_dims = dim(spectral_cube)",
        "> ",
        "  calc_region = matrix(data = calc_region, nrow = cube_dims[1], ncol=cube_dims[2])",
        "> ",
        "View(calc_region)",
        "> ",
        "  calc_region = observation$aperture_region ",
        "> ",
        "  calc_region[calc_region > 0] = 1; calc_region[is.na(calc_region)] = 0",
        "> ",
        "  calc_region = matrix(data = calc_region, nrow = cube_dims[1], ncol=cube_dims[2])",
        "> ",
        "View(calc_region)",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = calc_region)",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = calc_region, plot = T)",
        "Error in if (quantile(z, locut, na.rm = T) != quantile(z, hicut, na.rm = T)) { : \n  missing value where TRUE/FALSE needed\n",
        "> ",
        "spatial_plane",
        "[1] 1924\n",
        "> ",
        "spatial_plane = 800",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = calc_region)",
        "> ",
        "magimage(observation$psf_kernel)",
        "> ",
        "model = list(",
        "+ ",
        "    sersic = list(",
        "+ ",
        "        xcen   = c(180, 60),",
        "+ ",
        "        ycen   = c(90, 10),",
        "+ ",
        "        mag = c(15, 13),",
        "+ ",
        "        re  = c(14, 5),",
        "+ ",
        "        nser  = c(3, 10),",
        "+ ",
        "        ang  = c(46, 80),",
        "+ ",
        "        axrat  = c(0.4, 0.6),",
        "+ ",
        "        box = c(0.5,-0.5)",
        "+ ",
        "    )",
        "+ ",
        ")",
        "> ",
        "",
        "> ",
        "model.image=profitMakeModel(model=model, dim=c(200,200))$z",
        "> ",
        "magimage(model.image)",
        "> ",
        "magimage(profitBruteConv(image=model.image, psf=profitMakePointSource()))",
        "> ",
        "install.packages(\"magick\")",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/magick_2.5.0.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 37173331 bytes (35.5 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 35.5 MB\n\n",
        "\nThe downloaded binary packages are in\n\t/var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmpg1SOIm/downloaded_packages\n",
        "> ",
        "library(magick)",
        "Linking to ImageMagick 6.9.11.32\nEnabled features: cairo, fontconfig, freetype, lcms, pango, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n",
        "> ",
        "image_convolve(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "Error: The 'image' argument is not a magick image object.\n",
        "> ",
        "install.packages(\"OpenImageR\")",
        "also installing the dependencies ‘httpuv’, ‘xtable’, ‘sourcetools’, ‘fastmap’, ‘shiny’, ‘jpeg’, ‘png’, ‘tiff’, ‘RcppArmadillo’\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/httpuv_1.5.4.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 3018312 bytes (2.9 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 2.9 MB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/xtable_1.8-4.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 701147 bytes (684 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 684 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/sourcetools_0.1.7.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 138523 bytes (135 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 135 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/fastmap_1.0.1.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 168252 bytes (164 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 164 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/shiny_1.5.0.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 5307401 bytes (5.1 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 5.1 MB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/jpeg_0.1-8.1.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 416504 bytes (406 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 406 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/png_0.1-7.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 369557 bytes (360 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 360 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/tiff_0.1-5.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 935236 bytes (913 KB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 913 KB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/RcppArmadillo_0.10.1.0.0.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 1867485 bytes (1.8 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 1.8 MB\n\n",
        "trying URL 'https://cran.rstudio.com/bin/macosx/contrib/4.0/OpenImageR_1.1.7.tgz'\n",
        "Content type 'application/x-gzip'",
        " length 3613394 bytes (3.4 MB)\n",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "=",
        "\n",
        "downloaded 3.4 MB\n\n",
        "\nThe downloaded binary packages are in\n\t/var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmpg1SOIm/downloaded_packages\n",
        "> ",
        "library(OpenImageR)",
        "> ",
        "magimage(convolution(spectral_cube[,,spatial_plane], observation$psf_kernel))",
        "Error in if (quantile(z, locut, na.rm = T) != quantile(z, hicut, na.rm = T)) { : \n  missing value where TRUE/FALSE needed\n",
        "> ",
        "convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16]\n [1,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [2,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [3,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [4,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [5,]   NA   NA   NA   NA   NA   NA   NA   NA   NA",
        "    NA    NA    NA    NA    NA    NA    NA\n [6,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [7,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [8,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n [9,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[10,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[11,]",
        "   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[12,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[13,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[14,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[15,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[16,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA",
        "    NA    NA    NA    NA    NA    NA\n[17,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[18,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[19,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[20,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[21,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[22,]   NA",
        "   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[23,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[24,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[25,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[26,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[27,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA",
        "    NA    NA    NA    NA    NA\n[28,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[29,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n[30,]   NA   NA   NA   NA   NA   NA   NA   NA   NA    NA    NA    NA    NA    NA    NA    NA\n      [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30]\n [1,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [2,]    NA    NA    NA",
        "    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [3,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [4,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [5,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [6,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [7,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA",
        "\n [8,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n [9,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[10,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[11,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[12,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[13,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA",
        "    NA    NA    NA    NA\n[14,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[15,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[16,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[17,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[18,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[19,]    NA    NA    NA    NA    NA    NA",
        "    NA    NA    NA    NA    NA    NA    NA    NA\n[20,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[21,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[22,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[23,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[24,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[25,]    NA    NA",
        "    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[26,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[27,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[28,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[29,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA\n[30,]    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA    NA",
        "    NA\n",
        "> ",
        "spectral_cube[,,spatial_plane]",
        "              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]\n [1,]           NA           NA           NA           NA           NA           NA           NA\n [2,]           NA           NA           NA           NA           NA           NA           NA\n [3,]           NA           NA           NA           NA           NA           NA           NA\n [4,]           NA           NA           NA           NA           NA 2.352904e-20           NA\n [5,]           NA           NA",
        "           NA           NA 6.561699e-20 2.798129e-20           NA\n [6,]           NA           NA           NA 2.882961e-20 4.539945e-20 4.061649e-20           NA\n [7,]           NA           NA           NA           NA 5.363110e-20 2.241002e-19 2.454276e-20\n [8,]           NA           NA 2.897559e-20 2.793241e-20 5.937049e-20 1.751271e-19 8.452306e-20\n [9,]           NA           NA 6.840054e-20 3.694830e-20 2.913182e-20 5.785546e-20 2.329809e-19\n[10,]           NA           NA 8.767542e-20 2.180100e-19 7.218851e-20",
        " 1.536988e-19 7.945770e-20\n[11,]           NA 6.373037e-20 2.876263e-20 3.702291e-20 1.518077e-19 1.642176e-19 7.385188e-20\n[12,] 1.041381e-19           NA 5.656332e-20           NA 7.815172e-20 1.235055e-19 1.880473e-19\n[13,] 6.378037e-20 2.869053e-20 9.593552e-20 2.825858e-19 1.940426e-19 2.693461e-19 2.031245e-19\n[14,] 2.720017e-20 6.176743e-20 1.719401e-19 3.784610e-19 6.741338e-20 1.268706e-19 2.236568e-20\n[15,] 1.085563e-19           NA 5.965405e-20 6.169037e-20 1.835699e-19 2.640248e-19 3.584450e-19\n[16,]",
        " 3.366232e-20 6.760014e-20 6.191848e-20 1.313931e-19 1.108929e-19 7.884074e-20 2.792697e-19\n[17,] 6.848866e-20 7.157174e-20 6.611633e-20 8.875658e-20 8.792995e-20 6.060065e-20 3.874527e-19\n[18,] 3.362606e-20 4.854969e-20 8.284638e-20 1.345595e-19 1.636309e-19 2.212657e-19 2.413572e-19\n[19,]           NA 6.900202e-20 2.862186e-20 1.190218e-19 1.513429e-19 1.643421e-19 5.205860e-19\n[20,]           NA 1.046996e-19 6.487473e-20 5.591297e-20 2.774159e-20 1.623380e-19 9.500731e-20\n[21,]           NA           NA 6.474350e-20",
        " 1.115103e-19 1.168869e-19 3.226676e-19 1.579495e-19\n[22,]           NA 2.346680e-20 1.300605e-19 8.573928e-20 6.176617e-20 5.453654e-20 6.443047e-20\n[23,]           NA           NA           NA 3.155210e-20 9.634089e-20 1.689302e-19 1.248821e-19\n[24,]           NA           NA           NA           NA 1.947442e-19 8.824666e-20 1.681814e-19\n[25,]           NA           NA           NA 2.505956e-20 7.138704e-20 1.009762e-19           NA\n[26,]           NA           NA           NA           NA           NA 3.152192e-20",
        " 3.056418e-20\n[27,]           NA           NA           NA           NA           NA 8.201310e-20 3.338898e-20\n[28,]           NA           NA           NA           NA           NA           NA           NA\n[29,]           NA           NA           NA           NA           NA           NA           NA\n[30,]           NA           NA           NA           NA           NA           NA           NA\n              [,8]         [,9]        [,10]        [,11]        [,12]        [,13]        [,14]\n [1,]           NA",
        "           NA           NA           NA           NA           NA           NA\n [2,]           NA           NA           NA           NA 7.892224e-20 2.781134e-20           NA\n [3,] 2.163101e-20           NA           NA 4.188655e-20 2.599713e-20           NA 3.695378e-20\n [4,] 3.133911e-20 6.848494e-20 3.147430e-20           NA 3.763405e-20 3.572861e-20 8.686197e-20\n [5,] 3.051573e-20           NA 9.153388e-20 2.850770e-20 9.815731e-20 5.694031e-20 8.017815e-20\n [6,] 5.372925e-20 7.746731e-20 5.764085e-20 2.369517e-20",
        " 3.000016e-20 6.377012e-20 2.658800e-20\n [7,]           NA           NA 6.726275e-20 5.125025e-20 2.507040e-19 1.732107e-19 1.038071e-19\n [8,] 8.443274e-20 1.555275e-19 1.281136e-19 1.195285e-19 1.378378e-19 1.171474e-19 8.522889e-20\n [9,] 2.976019e-20 1.240219e-19 8.892803e-20 4.530255e-19 2.155999e-19 2.106762e-19 1.192367e-19\n[10,] 1.821471e-19 3.114911e-19 1.123666e-19 3.115214e-19 6.264566e-19 7.195059e-19 7.005032e-19\n[11,] 1.830971e-19 1.850482e-19 4.189234e-19 4.552013e-19 4.393520e-19 1.049520e-18 8.863550e-19",
        "\n[12,] 2.532576e-19 8.573969e-20 2.686004e-19 4.179972e-19 2.534453e-19 8.708831e-19 1.091646e-18\n[13,] 3.863930e-19 3.835449e-19 4.353220e-19 6.663911e-19 5.702465e-19 9.020508e-19 2.583550e-18\n[14,] 3.499445e-19 3.428245e-19 4.435496e-19 1.200957e-18 1.176461e-18 1.960956e-18 5.038329e-18\n[15,] 3.459945e-19 1.216727e-18 5.664608e-19 8.907762e-19 2.435043e-18 3.503763e-18 6.347747e-18\n[16,] 3.710665e-19 3.907365e-19 1.495317e-18 1.851958e-18 3.267064e-18 4.275531e-18 7.995280e-18\n[17,] 4.816802e-19 8.491955e-19",
        " 9.671654e-19 2.643762e-18 3.217322e-18 2.807939e-18 4.633429e-18\n[18,] 5.525493e-19 8.162132e-19 1.042705e-18 9.553187e-19 1.650652e-18 2.348591e-18 3.509176e-18\n[19,] 2.587011e-19 8.312071e-19 3.898489e-19 6.064622e-19 1.083576e-18 1.208331e-18 1.403568e-18\n[20,] 2.028442e-19 3.496535e-19 2.916144e-19 7.047477e-19 1.164376e-18 1.336068e-18 1.270324e-18\n[21,] 1.497150e-19 1.196737e-19 4.208438e-19 5.829759e-19 7.325056e-19 5.449447e-19 6.652924e-19\n[22,]           NA 3.885105e-19 7.405383e-19 7.569119e-19 5.214147e-19",
        " 5.885053e-19 1.597358e-19\n[23,] 2.271497e-19 1.635864e-19 4.875373e-19 1.297595e-19 3.567193e-19 3.016390e-19 7.631927e-20\n[24,] 2.432207e-20 8.964814e-20 9.726150e-20 5.181107e-20 9.388735e-20 1.812031e-19 2.195473e-19\n[25,] 1.731277e-19 8.616235e-20 1.167768e-19 1.754465e-19 8.914912e-20 2.929509e-19 6.233084e-20\n[26,]           NA 5.892351e-20 8.832761e-20 1.222493e-19 9.615915e-20 1.055934e-19 5.044978e-20\n[27,] 1.318560e-19 1.643452e-19 4.759098e-20 3.379281e-20 9.895512e-20 8.423548e-20 7.725157e-20\n[28,]",
        " 3.455456e-20 1.558566e-19 8.216821e-20 1.184710e-19 2.579251e-20 6.040329e-20 6.039274e-20\n[29,]           NA 3.522671e-20 3.395429e-20 1.829979e-19           NA 8.961223e-20 2.790299e-20\n[30,]           NA           NA           NA           NA 3.322871e-20           NA 2.678994e-19\n             [,15]        [,16]        [,17]        [,18]        [,19]        [,20]        [,21]\n [1,]           NA           NA           NA 2.833143e-20 3.117997e-20           NA           NA\n [2,] 5.941077e-20           NA           NA",
        "           NA 9.341243e-20 6.506527e-20 2.840254e-20\n [3,] 1.222241e-19 9.560303e-20 3.573198e-20 2.585088e-20 6.344024e-20 5.476965e-20 2.684620e-20\n [4,] 9.122752e-20 9.682221e-20           NA 7.986726e-20 6.577847e-20 1.136816e-19 2.483974e-20\n [5,] 5.236828e-20 5.668567e-20 2.482454e-20 7.966787e-20 1.960318e-19 9.187762e-20           NA\n [6,] 3.241633e-20 1.005420e-19 1.125400e-19 5.512902e-20 2.746197e-19 7.050317e-20 2.667405e-20\n [7,] 2.158483e-19 1.264196e-19 4.323420e-19 2.641410e-19 9.993523e-20 1.131910e-19",
        " 1.571435e-19\n [8,] 2.960319e-20 1.071322e-19 1.522362e-19 1.767511e-19 4.080071e-19 1.194326e-19 3.393456e-19\n [9,] 4.617098e-19 1.535820e-19 3.065144e-19 2.847280e-19 1.641705e-19 2.293968e-19 1.848089e-19\n[10,] 4.899629e-19 4.950196e-19 5.130005e-19 8.457859e-19 7.770527e-19 2.335365e-19 1.492388e-19\n[11,] 1.356791e-18 1.187475e-18 4.164080e-19 8.885541e-19 7.506677e-19 2.381495e-19 2.090310e-19\n[12,] 1.193747e-18 1.417262e-18 1.187067e-18 6.964432e-19 1.084956e-18 6.681582e-19 5.973044e-19\n[13,] 2.391843e-18",
        " 1.926489e-18 3.661893e-18 2.188393e-18 1.688885e-18 1.191632e-18 4.663459e-19\n[14,] 8.985934e-18 6.383455e-18 5.431714e-18 2.744413e-18 2.647189e-18 1.038525e-18 1.020463e-18\n[15,] 1.292817e-17 1.686880e-17 1.019226e-17 7.821439e-18 2.933843e-18 1.791717e-18 1.062595e-18\n[16,] 1.560292e-17 1.992138e-17 9.176315e-18 6.099740e-18 2.284885e-18 1.401858e-18 4.307063e-19\n[17,] 6.870795e-18 1.064668e-17 8.778065e-18 1.623519e-18 1.599029e-18 5.503516e-19 4.913806e-19\n[18,] 2.903896e-18 4.455411e-18 2.008119e-18 1.731465e-18",
        " 8.712704e-19 4.099154e-19 7.073959e-19\n[19,] 1.217078e-18 1.460536e-18 1.525706e-18 1.709386e-18 7.812925e-19 8.051315e-19 4.167692e-19\n[20,] 1.102504e-18 7.058085e-19 1.306148e-18 6.162587e-19 8.620837e-19 8.946175e-19 4.715870e-19\n[21,] 4.754748e-19 4.877982e-19 3.118099e-19 7.190704e-19 6.430225e-19 1.907723e-19 2.574987e-19\n[22,] 3.104585e-19 5.773915e-19 4.466268e-19 1.433642e-19 2.194618e-19 5.214456e-20 8.281175e-20\n[23,] 4.481249e-19 4.452169e-19 2.430712e-19 6.036043e-19 8.898291e-20 1.306372e-19 5.006661e-20",
        "\n[24,] 1.180281e-19 1.594691e-19 3.617206e-20 1.535436e-19 1.505140e-19 2.857141e-20 2.715835e-19\n[25,]           NA 5.914639e-20 9.250887e-20 1.750704e-19 5.923118e-20 4.784524e-20 9.036997e-20\n[26,] 1.459970e-19 6.601862e-20 3.327015e-20 3.339670e-20           NA           NA 5.672924e-20\n[27,] 3.340391e-20           NA 9.206320e-20 2.648268e-20 5.362559e-20           NA 5.622202e-20\n[28,] 5.894157e-20           NA 2.710939e-20           NA 1.166360e-19 3.028448e-20           NA\n[29,] 2.545481e-20 3.844306e-20",
        " 6.436970e-20 2.866991e-20           NA 2.670152e-20 6.989739e-20\n[30,] 5.989154e-20 6.010236e-20 2.971290e-20           NA 4.819604e-20           NA           NA\n             [,22]        [,23]        [,24]        [,25]        [,26]        [,27]        [,28]\n [1,]           NA           NA           NA           NA           NA           NA           NA\n [2,] 6.063254e-20           NA           NA           NA           NA           NA           NA\n [3,] 5.507980e-20 3.474581e-20           NA           NA           NA",
        "           NA           NA\n [4,]           NA           NA           NA 5.568485e-20           NA           NA           NA\n [5,] 3.939187e-19 5.627046e-20 4.465998e-20           NA           NA           NA           NA\n [6,] 1.026686e-19           NA 6.173061e-20 3.711925e-19 1.468707e-19           NA           NA\n [7,] 2.363997e-19 1.655585e-19           NA 5.981056e-20 6.174083e-20 9.692687e-20           NA\n [8,] 5.697145e-20 4.073924e-19 5.524826e-20 2.642139e-20 3.121115e-20 3.021633e-19 3.646072e-20\n [9,]",
        " 1.145034e-19 1.006391e-19 2.176180e-19 2.222313e-19 8.103433e-20 1.153760e-19 3.204941e-20\n[10,] 1.339902e-19 1.521479e-19 1.274373e-19 1.105536e-19 9.356219e-20           NA 3.133320e-20\n[11,] 3.333863e-19 9.404721e-20 8.020628e-20 8.877801e-20 1.214392e-19 2.069838e-19 6.375237e-20\n[12,] 1.847476e-19 1.406638e-19 1.117647e-19 1.179141e-19 2.205361e-19           NA 1.241522e-19\n[13,] 5.899040e-19 3.881448e-19 1.119691e-19 7.896086e-20 9.194499e-20 5.684261e-20 1.085494e-19\n[14,] 6.148300e-19 1.135683e-19 1.593184e-19",
        " 1.003057e-19 2.002259e-19 9.607193e-20           NA\n[15,] 4.629568e-19 2.045550e-19 3.877096e-19 9.361953e-20 2.089098e-19 1.160881e-19 5.659719e-20\n[16,] 3.087153e-19 2.257313e-19 6.569461e-19 5.402878e-20 3.284738e-19 1.211045e-19 2.860718e-20\n[17,] 4.526198e-19 2.183020e-19 2.559607e-19 2.342793e-19 2.631023e-20 3.745432e-19 2.472746e-20\n[18,] 4.880571e-19 1.476906e-19 2.914710e-19 2.955180e-19 6.422451e-20 2.657331e-19 2.679476e-20\n[19,] 7.207002e-19 4.399562e-19 9.420285e-20 2.052339e-19 5.593581e-20           NA",
        " 1.493941e-19\n[20,] 1.123324e-19 2.215244e-19 9.447134e-20 1.570281e-19 2.592292e-19 5.453252e-20 3.730918e-20\n[21,] 2.508289e-20 1.956048e-19 8.726071e-20 8.047911e-20 2.880631e-20           NA 2.605161e-20\n[22,] 8.796416e-20 2.916647e-20 2.766950e-20 9.859838e-20 3.043436e-20 5.808105e-20           NA\n[23,]           NA 2.893283e-20 6.587773e-20 1.929799e-19 9.262706e-20 6.352893e-20 6.030672e-20\n[24,] 1.141348e-19 3.338503e-20           NA           NA           NA 3.519221e-20           NA\n[25,] 5.056259e-20",
        " 9.624775e-20 1.149270e-19 6.551256e-20           NA 3.265847e-20           NA\n[26,]           NA 2.817026e-20 5.554938e-20 6.294454e-20 3.080451e-19           NA           NA\n[27,]           NA 6.123395e-20 5.791813e-20           NA           NA           NA           NA\n[28,]           NA 2.715166e-20           NA           NA           NA           NA           NA\n[29,] 8.530363e-20           NA           NA           NA           NA           NA           NA\n[30,]           NA           NA           NA           NA",
        "           NA           NA           NA\n             [,29]        [,30]\n [1,]           NA           NA\n [2,]           NA           NA\n [3,]           NA           NA\n [4,]           NA           NA\n [5,]           NA           NA\n [6,]           NA           NA\n [7,]           NA           NA\n [8,]           NA           NA\n [9,] 5.686211e-20           NA\n[10,] 6.381770e-20           NA\n[11,]           NA           NA\n[12,] 6.020154e-20 5.530201e-20\n[13,] 3.041044e-20 3.210070e-20\n[14,] 3.499483e-20 2.588580e-20",
        "\n[15,] 4.825935e-20 3.163612e-20\n[16,] 1.799769e-19 5.332854e-20\n[17,] 8.152789e-20 1.997555e-20\n[18,] 5.748011e-20 2.452358e-20\n[19,]           NA           NA\n[20,] 5.803249e-20           NA\n[21,] 2.368264e-20           NA\n[22,]           NA           NA\n[23,]           NA           NA\n[24,]           NA           NA\n[25,]           NA           NA\n[26,]           NA           NA\n[27,]           NA           NA\n[28,]           NA           NA\n[29,]           NA           NA\n[30,]           NA           NA",
        "\n",
        "> ",
        "  spectral_cube[is.na(spectral_cube)] = 0",
        "> ",
        "ProFit::profitBruteConv(spectral_cube[,,spatial_plane], observation$psf_kernel, calcregion = calc_region)",
        "> ",
        "spectral_cube[,,spatial_plane]",
        "              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]\n [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [3,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [4,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 2.352904e-20 0.000000e+00\n [5,] 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00 6.561699e-20 2.798129e-20 0.000000e+00\n [6,] 0.000000e+00 0.000000e+00 0.000000e+00 2.882961e-20 4.539945e-20 4.061649e-20 0.000000e+00\n [7,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 5.363110e-20 2.241002e-19 2.454276e-20\n [8,] 0.000000e+00 0.000000e+00 2.897559e-20 2.793241e-20 5.937049e-20 1.751271e-19 8.452306e-20\n [9,] 0.000000e+00 0.000000e+00 6.840054e-20 3.694830e-20 2.913182e-20 5.785546e-20 2.329809e-19\n[10,] 0.000000e+00 0.000000e+00 8.767542e-20 2.180100e-19 7.218851e-20",
        " 1.536988e-19 7.945770e-20\n[11,] 0.000000e+00 6.373037e-20 2.876263e-20 3.702291e-20 1.518077e-19 1.642176e-19 7.385188e-20\n[12,] 1.041381e-19 0.000000e+00 5.656332e-20 0.000000e+00 7.815172e-20 1.235055e-19 1.880473e-19\n[13,] 6.378037e-20 2.869053e-20 9.593552e-20 2.825858e-19 1.940426e-19 2.693461e-19 2.031245e-19\n[14,] 2.720017e-20 6.176743e-20 1.719401e-19 3.784610e-19 6.741338e-20 1.268706e-19 2.236568e-20\n[15,] 1.085563e-19 0.000000e+00 5.965405e-20 6.169037e-20 1.835699e-19 2.640248e-19 3.584450e-19\n[16,]",
        " 3.366232e-20 6.760014e-20 6.191848e-20 1.313931e-19 1.108929e-19 7.884074e-20 2.792697e-19\n[17,] 6.848866e-20 7.157174e-20 6.611633e-20 8.875658e-20 8.792995e-20 6.060065e-20 3.874527e-19\n[18,] 3.362606e-20 4.854969e-20 8.284638e-20 1.345595e-19 1.636309e-19 2.212657e-19 2.413572e-19\n[19,] 0.000000e+00 6.900202e-20 2.862186e-20 1.190218e-19 1.513429e-19 1.643421e-19 5.205860e-19\n[20,] 0.000000e+00 1.046996e-19 6.487473e-20 5.591297e-20 2.774159e-20 1.623380e-19 9.500731e-20\n[21,] 0.000000e+00 0.000000e+00 6.474350e-20",
        " 1.115103e-19 1.168869e-19 3.226676e-19 1.579495e-19\n[22,] 0.000000e+00 2.346680e-20 1.300605e-19 8.573928e-20 6.176617e-20 5.453654e-20 6.443047e-20\n[23,] 0.000000e+00 0.000000e+00 0.000000e+00 3.155210e-20 9.634089e-20 1.689302e-19 1.248821e-19\n[24,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 1.947442e-19 8.824666e-20 1.681814e-19\n[25,] 0.000000e+00 0.000000e+00 0.000000e+00 2.505956e-20 7.138704e-20 1.009762e-19 0.000000e+00\n[26,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 3.152192e-20",
        " 3.056418e-20\n[27,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 8.201310e-20 3.338898e-20\n[28,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[29,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n              [,8]         [,9]        [,10]        [,11]        [,12]        [,13]        [,14]\n [1,] 0.000000e+00",
        " 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 7.892224e-20 2.781134e-20 0.000000e+00\n [3,] 2.163101e-20 0.000000e+00 0.000000e+00 4.188655e-20 2.599713e-20 0.000000e+00 3.695378e-20\n [4,] 3.133911e-20 6.848494e-20 3.147430e-20 0.000000e+00 3.763405e-20 3.572861e-20 8.686197e-20\n [5,] 3.051573e-20 0.000000e+00 9.153388e-20 2.850770e-20 9.815731e-20 5.694031e-20 8.017815e-20\n [6,] 5.372925e-20 7.746731e-20 5.764085e-20 2.369517e-20",
        " 3.000016e-20 6.377012e-20 2.658800e-20\n [7,] 0.000000e+00 0.000000e+00 6.726275e-20 5.125025e-20 2.507040e-19 1.732107e-19 1.038071e-19\n [8,] 8.443274e-20 1.555275e-19 1.281136e-19 1.195285e-19 1.378378e-19 1.171474e-19 8.522889e-20\n [9,] 2.976019e-20 1.240219e-19 8.892803e-20 4.530255e-19 2.155999e-19 2.106762e-19 1.192367e-19\n[10,] 1.821471e-19 3.114911e-19 1.123666e-19 3.115214e-19 6.264566e-19 7.195059e-19 7.005032e-19\n[11,] 1.830971e-19 1.850482e-19 4.189234e-19 4.552013e-19 4.393520e-19 1.049520e-18 8.863550e-19",
        "\n[12,] 2.532576e-19 8.573969e-20 2.686004e-19 4.179972e-19 2.534453e-19 8.708831e-19 1.091646e-18\n[13,] 3.863930e-19 3.835449e-19 4.353220e-19 6.663911e-19 5.702465e-19 9.020508e-19 2.583550e-18\n[14,] 3.499445e-19 3.428245e-19 4.435496e-19 1.200957e-18 1.176461e-18 1.960956e-18 5.038329e-18\n[15,] 3.459945e-19 1.216727e-18 5.664608e-19 8.907762e-19 2.435043e-18 3.503763e-18 6.347747e-18\n[16,] 3.710665e-19 3.907365e-19 1.495317e-18 1.851958e-18 3.267064e-18 4.275531e-18 7.995280e-18\n[17,] 4.816802e-19 8.491955e-19",
        " 9.671654e-19 2.643762e-18 3.217322e-18 2.807939e-18 4.633429e-18\n[18,] 5.525493e-19 8.162132e-19 1.042705e-18 9.553187e-19 1.650652e-18 2.348591e-18 3.509176e-18\n[19,] 2.587011e-19 8.312071e-19 3.898489e-19 6.064622e-19 1.083576e-18 1.208331e-18 1.403568e-18\n[20,] 2.028442e-19 3.496535e-19 2.916144e-19 7.047477e-19 1.164376e-18 1.336068e-18 1.270324e-18\n[21,] 1.497150e-19 1.196737e-19 4.208438e-19 5.829759e-19 7.325056e-19 5.449447e-19 6.652924e-19\n[22,] 0.000000e+00 3.885105e-19 7.405383e-19 7.569119e-19 5.214147e-19",
        " 5.885053e-19 1.597358e-19\n[23,] 2.271497e-19 1.635864e-19 4.875373e-19 1.297595e-19 3.567193e-19 3.016390e-19 7.631927e-20\n[24,] 2.432207e-20 8.964814e-20 9.726150e-20 5.181107e-20 9.388735e-20 1.812031e-19 2.195473e-19\n[25,] 1.731277e-19 8.616235e-20 1.167768e-19 1.754465e-19 8.914912e-20 2.929509e-19 6.233084e-20\n[26,] 0.000000e+00 5.892351e-20 8.832761e-20 1.222493e-19 9.615915e-20 1.055934e-19 5.044978e-20\n[27,] 1.318560e-19 1.643452e-19 4.759098e-20 3.379281e-20 9.895512e-20 8.423548e-20 7.725157e-20\n[28,]",
        " 3.455456e-20 1.558566e-19 8.216821e-20 1.184710e-19 2.579251e-20 6.040329e-20 6.039274e-20\n[29,] 0.000000e+00 3.522671e-20 3.395429e-20 1.829979e-19 0.000000e+00 8.961223e-20 2.790299e-20\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 3.322871e-20 0.000000e+00 2.678994e-19\n             [,15]        [,16]        [,17]        [,18]        [,19]        [,20]        [,21]\n [1,] 0.000000e+00 0.000000e+00 0.000000e+00 2.833143e-20 3.117997e-20 0.000000e+00 0.000000e+00\n [2,] 5.941077e-20 0.000000e+00 0.000000e+00",
        " 0.000000e+00 9.341243e-20 6.506527e-20 2.840254e-20\n [3,] 1.222241e-19 9.560303e-20 3.573198e-20 2.585088e-20 6.344024e-20 5.476965e-20 2.684620e-20\n [4,] 9.122752e-20 9.682221e-20 0.000000e+00 7.986726e-20 6.577847e-20 1.136816e-19 2.483974e-20\n [5,] 5.236828e-20 5.668567e-20 2.482454e-20 7.966787e-20 1.960318e-19 9.187762e-20 0.000000e+00\n [6,] 3.241633e-20 1.005420e-19 1.125400e-19 5.512902e-20 2.746197e-19 7.050317e-20 2.667405e-20\n [7,] 2.158483e-19 1.264196e-19 4.323420e-19 2.641410e-19 9.993523e-20 1.131910e-19",
        " 1.571435e-19\n [8,] 2.960319e-20 1.071322e-19 1.522362e-19 1.767511e-19 4.080071e-19 1.194326e-19 3.393456e-19\n [9,] 4.617098e-19 1.535820e-19 3.065144e-19 2.847280e-19 1.641705e-19 2.293968e-19 1.848089e-19\n[10,] 4.899629e-19 4.950196e-19 5.130005e-19 8.457859e-19 7.770527e-19 2.335365e-19 1.492388e-19\n[11,] 1.356791e-18 1.187475e-18 4.164080e-19 8.885541e-19 7.506677e-19 2.381495e-19 2.090310e-19\n[12,] 1.193747e-18 1.417262e-18 1.187067e-18 6.964432e-19 1.084956e-18 6.681582e-19 5.973044e-19\n[13,] 2.391843e-18",
        " 1.926489e-18 3.661893e-18 2.188393e-18 1.688885e-18 1.191632e-18 4.663459e-19\n[14,] 8.985934e-18 6.383455e-18 5.431714e-18 2.744413e-18 2.647189e-18 1.038525e-18 1.020463e-18\n[15,] 1.292817e-17 1.686880e-17 1.019226e-17 7.821439e-18 2.933843e-18 1.791717e-18 1.062595e-18\n[16,] 1.560292e-17 1.992138e-17 9.176315e-18 6.099740e-18 2.284885e-18 1.401858e-18 4.307063e-19\n[17,] 6.870795e-18 1.064668e-17 8.778065e-18 1.623519e-18 1.599029e-18 5.503516e-19 4.913806e-19\n[18,] 2.903896e-18 4.455411e-18 2.008119e-18 1.731465e-18",
        " 8.712704e-19 4.099154e-19 7.073959e-19\n[19,] 1.217078e-18 1.460536e-18 1.525706e-18 1.709386e-18 7.812925e-19 8.051315e-19 4.167692e-19\n[20,] 1.102504e-18 7.058085e-19 1.306148e-18 6.162587e-19 8.620837e-19 8.946175e-19 4.715870e-19\n[21,] 4.754748e-19 4.877982e-19 3.118099e-19 7.190704e-19 6.430225e-19 1.907723e-19 2.574987e-19\n[22,] 3.104585e-19 5.773915e-19 4.466268e-19 1.433642e-19 2.194618e-19 5.214456e-20 8.281175e-20\n[23,] 4.481249e-19 4.452169e-19 2.430712e-19 6.036043e-19 8.898291e-20 1.306372e-19 5.006661e-20",
        "\n[24,] 1.180281e-19 1.594691e-19 3.617206e-20 1.535436e-19 1.505140e-19 2.857141e-20 2.715835e-19\n[25,] 0.000000e+00 5.914639e-20 9.250887e-20 1.750704e-19 5.923118e-20 4.784524e-20 9.036997e-20\n[26,] 1.459970e-19 6.601862e-20 3.327015e-20 3.339670e-20 0.000000e+00 0.000000e+00 5.672924e-20\n[27,] 3.340391e-20 0.000000e+00 9.206320e-20 2.648268e-20 5.362559e-20 0.000000e+00 5.622202e-20\n[28,] 5.894157e-20 0.000000e+00 2.710939e-20 0.000000e+00 1.166360e-19 3.028448e-20 0.000000e+00\n[29,] 2.545481e-20 3.844306e-20",
        " 6.436970e-20 2.866991e-20 0.000000e+00 2.670152e-20 6.989739e-20\n[30,] 5.989154e-20 6.010236e-20 2.971290e-20 0.000000e+00 4.819604e-20 0.000000e+00 0.000000e+00\n             [,22]        [,23]        [,24]        [,25]        [,26]        [,27]        [,28]\n [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [2,] 6.063254e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [3,] 5.507980e-20 3.474581e-20 0.000000e+00 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00\n [4,] 0.000000e+00 0.000000e+00 0.000000e+00 5.568485e-20 0.000000e+00 0.000000e+00 0.000000e+00\n [5,] 3.939187e-19 5.627046e-20 4.465998e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [6,] 1.026686e-19 0.000000e+00 6.173061e-20 3.711925e-19 1.468707e-19 0.000000e+00 0.000000e+00\n [7,] 2.363997e-19 1.655585e-19 0.000000e+00 5.981056e-20 6.174083e-20 9.692687e-20 0.000000e+00\n [8,] 5.697145e-20 4.073924e-19 5.524826e-20 2.642139e-20 3.121115e-20 3.021633e-19 3.646072e-20\n [9,]",
        " 1.145034e-19 1.006391e-19 2.176180e-19 2.222313e-19 8.103433e-20 1.153760e-19 3.204941e-20\n[10,] 1.339902e-19 1.521479e-19 1.274373e-19 1.105536e-19 9.356219e-20 0.000000e+00 3.133320e-20\n[11,] 3.333863e-19 9.404721e-20 8.020628e-20 8.877801e-20 1.214392e-19 2.069838e-19 6.375237e-20\n[12,] 1.847476e-19 1.406638e-19 1.117647e-19 1.179141e-19 2.205361e-19 0.000000e+00 1.241522e-19\n[13,] 5.899040e-19 3.881448e-19 1.119691e-19 7.896086e-20 9.194499e-20 5.684261e-20 1.085494e-19\n[14,] 6.148300e-19 1.135683e-19 1.593184e-19",
        " 1.003057e-19 2.002259e-19 9.607193e-20 0.000000e+00\n[15,] 4.629568e-19 2.045550e-19 3.877096e-19 9.361953e-20 2.089098e-19 1.160881e-19 5.659719e-20\n[16,] 3.087153e-19 2.257313e-19 6.569461e-19 5.402878e-20 3.284738e-19 1.211045e-19 2.860718e-20\n[17,] 4.526198e-19 2.183020e-19 2.559607e-19 2.342793e-19 2.631023e-20 3.745432e-19 2.472746e-20\n[18,] 4.880571e-19 1.476906e-19 2.914710e-19 2.955180e-19 6.422451e-20 2.657331e-19 2.679476e-20\n[19,] 7.207002e-19 4.399562e-19 9.420285e-20 2.052339e-19 5.593581e-20 0.000000e+00",
        " 1.493941e-19\n[20,] 1.123324e-19 2.215244e-19 9.447134e-20 1.570281e-19 2.592292e-19 5.453252e-20 3.730918e-20\n[21,] 2.508289e-20 1.956048e-19 8.726071e-20 8.047911e-20 2.880631e-20 0.000000e+00 2.605161e-20\n[22,] 8.796416e-20 2.916647e-20 2.766950e-20 9.859838e-20 3.043436e-20 5.808105e-20 0.000000e+00\n[23,] 0.000000e+00 2.893283e-20 6.587773e-20 1.929799e-19 9.262706e-20 6.352893e-20 6.030672e-20\n[24,] 1.141348e-19 3.338503e-20 0.000000e+00 0.000000e+00 0.000000e+00 3.519221e-20 0.000000e+00\n[25,] 5.056259e-20",
        " 9.624775e-20 1.149270e-19 6.551256e-20 0.000000e+00 3.265847e-20 0.000000e+00\n[26,] 0.000000e+00 2.817026e-20 5.554938e-20 6.294454e-20 3.080451e-19 0.000000e+00 0.000000e+00\n[27,] 0.000000e+00 6.123395e-20 5.791813e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[28,] 0.000000e+00 2.715166e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[29,] 8.530363e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00 0.000000e+00\n             [,29]        [,30]\n [1,] 0.000000e+00 0.000000e+00\n [2,] 0.000000e+00 0.000000e+00\n [3,] 0.000000e+00 0.000000e+00\n [4,] 0.000000e+00 0.000000e+00\n [5,] 0.000000e+00 0.000000e+00\n [6,] 0.000000e+00 0.000000e+00\n [7,] 0.000000e+00 0.000000e+00\n [8,] 0.000000e+00 0.000000e+00\n [9,] 5.686211e-20 0.000000e+00\n[10,] 6.381770e-20 0.000000e+00\n[11,] 0.000000e+00 0.000000e+00\n[12,] 6.020154e-20 5.530201e-20\n[13,] 3.041044e-20 3.210070e-20\n[14,] 3.499483e-20 2.588580e-20",
        "\n[15,] 4.825935e-20 3.163612e-20\n[16,] 1.799769e-19 5.332854e-20\n[17,] 8.152789e-20 1.997555e-20\n[18,] 5.748011e-20 2.452358e-20\n[19,] 0.000000e+00 0.000000e+00\n[20,] 5.803249e-20 0.000000e+00\n[21,] 2.368264e-20 0.000000e+00\n[22,] 0.000000e+00 0.000000e+00\n[23,] 0.000000e+00 0.000000e+00\n[24,] 0.000000e+00 0.000000e+00\n[25,] 0.000000e+00 0.000000e+00\n[26,] 0.000000e+00 0.000000e+00\n[27,] 0.000000e+00 0.000000e+00\n[28,] 0.000000e+00 0.000000e+00\n[29,] 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00",
        "\n",
        "> ",
        "convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)",
        "              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]\n [1,] 3.100100e-23 1.064263e-22 2.791841e-22 5.771001e-22 9.946465e-22 1.535812e-21 2.244822e-21\n [2,] 1.129616e-22 3.716108e-22 9.328476e-22 1.827507e-21 2.928506e-21 4.145062e-21 5.588269e-21\n [3,] 3.214318e-22 1.015458e-21 2.459777e-21 4.631834e-21 7.029892e-21 9.226026e-21 1.145690e-20\n [4,] 7.462918e-22 2.244477e-21 5.258770e-21 9.641405e-21 1.415377e-20 1.759349e-20 2.028912e-20\n [5,] 1.508410e-21 4.233905e-21",
        " 9.506300e-21 1.703830e-20 2.461245e-20 2.976324e-20 3.263245e-20\n [6,] 2.840998e-21 7.264665e-21 1.530051e-20 2.653510e-20 3.791292e-20 4.560221e-20 4.918487e-20\n [7,] 5.133027e-21 1.184744e-20 2.293912e-20 3.772843e-20 5.285711e-20 6.386672e-20 6.983515e-20\n [8,] 8.738856e-21 1.835499e-20 3.262498e-20 5.027683e-20 6.821562e-20 8.270951e-20 9.310133e-20\n [9,] 1.371279e-20 2.644333e-20 4.373576e-20 6.359963e-20 8.342697e-20 1.011355e-19 1.173035e-19\n[10,] 1.987869e-20 3.540005e-20 5.528765e-20 7.716890e-20 9.884517e-20",
        " 1.198558e-19 1.424228e-19\n[11,] 2.704020e-20 4.522829e-20 6.764371e-20 9.180808e-20 1.158571e-19 1.408037e-19 1.707054e-19\n[12,] 3.456588e-20 5.597542e-20 8.155263e-20 1.084226e-19 1.352020e-19 1.651184e-19 2.049658e-19\n[13,] 4.079511e-20 6.542733e-20 9.420642e-20 1.237488e-19 1.537329e-19 1.907625e-19 2.456597e-19\n[14,] 4.388976e-20 6.990208e-20 1.000041e-19 1.313691e-19 1.657335e-19 2.133587e-19 2.892909e-19\n[15,] 4.362153e-20 6.850321e-20 9.734726e-20 1.293734e-19 1.691720e-19 2.297597e-19 3.289627e-19\n[16,]",
        " 4.138710e-20 6.415348e-20 9.079458e-20 1.229348e-19 1.677553e-19 2.394820e-19 3.562705e-19\n[17,] 3.841366e-20 5.974688e-20 8.511615e-20 1.175545e-19 1.653651e-19 2.420398e-19 3.633533e-19\n[18,] 3.492036e-20 5.564810e-20 8.075583e-20 1.133292e-19 1.608993e-19 2.342856e-19 3.450921e-19\n[19,] 3.087209e-20 5.106198e-20 7.584666e-20 1.073252e-19 1.508788e-19 2.137354e-19 3.036930e-19\n[20,] 2.640160e-20 4.560045e-20 6.940795e-20 9.841560e-20 1.353552e-19 1.843407e-19 2.514686e-19\n[21,] 2.153388e-20 3.906204e-20 6.132779e-20",
        " 8.752829e-20 1.179473e-19 1.545838e-19 2.034885e-19\n[22,] 1.625752e-20 3.127165e-20 5.147686e-20 7.541043e-20 1.014413e-19 1.298474e-19 1.663444e-19\n[23,] 1.099158e-20 2.280248e-20 4.031912e-20 6.227025e-20 8.576806e-20 1.092660e-19 1.368016e-19\n[24,] 6.556552e-21 1.502466e-20 2.918332e-20 4.839891e-20 6.940292e-20 8.930040e-20 1.098803e-19\n[25,] 3.493285e-21 9.008215e-21 1.935360e-20 3.456130e-20 5.201126e-20 6.874068e-20 8.494573e-20\n[26,] 1.698109e-21 4.917149e-21 1.158380e-20 2.222988e-20 3.553350e-20 4.959628e-20",
        " 6.402475e-20\n[27,] 7.522515e-22 2.408458e-21 6.174030e-21 1.281247e-20 2.220114e-20 3.377417e-20 4.727196e-20\n[28,] 2.963422e-22 1.040047e-21 2.908883e-21 6.601077e-21 1.260480e-20 2.126504e-20 3.275801e-20\n[29,] 1.010896e-22 3.898857e-22 1.193362e-21 2.969875e-21 6.262874e-21 1.171599e-20 1.983452e-20\n[30,] 2.910168e-23 1.234661e-22 4.114076e-22 1.116028e-21 2.586299e-21 5.340165e-21 9.896004e-21\n              [,8]         [,9]        [,10]        [,11]        [,12]        [,13]        [,14]\n [1,] 3.191649e-21",
        " 4.535623e-21 6.503786e-21 9.033978e-21 1.164816e-20 1.398523e-20 1.591953e-20\n [2,] 7.419328e-21 9.750558e-21 1.276354e-20 1.649012e-20 2.059819e-20 2.475788e-20 2.854039e-20\n [3,] 1.421829e-20 1.762116e-20 2.162027e-20 2.629815e-20 3.163331e-20 3.741982e-20 4.294995e-20\n [4,] 2.353176e-20 2.786593e-20 3.300863e-20 3.876178e-20 4.505498e-20 5.165935e-20 5.804676e-20\n [5,] 3.574305e-20 4.089258e-20 4.788843e-20 5.572059e-20 6.335660e-20 7.019660e-20 7.664659e-20\n [6,] 5.243533e-20 5.906793e-20 6.948449e-20 8.142564e-20",
        " 9.193167e-20 9.962106e-20 1.062483e-19\n [7,] 7.529042e-20 8.574772e-20 1.025266e-19 1.221389e-19 1.392422e-19 1.510455e-19 1.598240e-19\n [8,] 1.041152e-19 1.222447e-19 1.499040e-19 1.832651e-19 2.150213e-19 2.398118e-19 2.574822e-19\n [9,] 1.367636e-19 1.663093e-19 2.098469e-19 2.653402e-19 3.255260e-19 3.813125e-19 4.247977e-19\n[10,] 1.718250e-19 2.152151e-19 2.790567e-19 3.666094e-19 4.754265e-19 5.936636e-19 6.985107e-19\n[11,] 2.117395e-19 2.721471e-19 3.630183e-19 4.982206e-19 6.885561e-19 9.242668e-19 1.158372e-18",
        "\n[12,] 2.626397e-19 3.487424e-19 4.822597e-19 6.948934e-19 1.022043e-18 1.464270e-18 1.938604e-18\n[13,] 3.293582e-19 4.567273e-19 6.582194e-19 9.897718e-19 1.521198e-18 2.272265e-18 3.114181e-18\n[14,] 4.086450e-19 5.923760e-19 8.832098e-19 1.360062e-18 2.126451e-18 3.225747e-18 4.486763e-18\n[15,] 4.857615e-19 7.267439e-19 1.101725e-18 1.698964e-18 2.637655e-18 3.978294e-18 5.530756e-18\n[16,] 5.382426e-19 8.134135e-19 1.228904e-18 1.862427e-18 2.820078e-18 4.161188e-18 5.710212e-18\n[17,] 5.465342e-19 8.151736e-19",
        " 1.205645e-18 1.772229e-18 2.586008e-18 3.684906e-18 4.931848e-18\n[18,] 5.054461e-19 7.316387e-19 1.047274e-18 1.482312e-18 2.068719e-18 2.814544e-18 3.626384e-18\n[19,] 4.293547e-19 6.013055e-19 8.320523e-19 1.131873e-18 1.502954e-18 1.931237e-18 2.360925e-18\n[20,] 3.451123e-19 4.728886e-19 6.376067e-19 8.341699e-19 1.048450e-18 1.260410e-18 1.443923e-18\n[21,] 2.742484e-19 3.723570e-19 4.921832e-19 6.183382e-19 7.325329e-19 8.214688e-19 8.804272e-19\n[22,] 2.205147e-19 2.955912e-19 3.810721e-19 4.585383e-19 5.134432e-19",
        " 5.421800e-19 5.515104e-19\n[23,] 1.760995e-19 2.287775e-19 2.846443e-19 3.288861e-19 3.529321e-19 3.583051e-19 3.537743e-19\n[24,] 1.361843e-19 1.690980e-19 2.019204e-19 2.259279e-19 2.368978e-19 2.363433e-19 2.299260e-19\n[25,] 1.030725e-19 1.232242e-19 1.418151e-19 1.549317e-19 1.606862e-19 1.590360e-19 1.522693e-19\n[26,] 7.917934e-20 9.379500e-20 1.054319e-19 1.127109e-19 1.152622e-19 1.126056e-19 1.053577e-19\n[27,] 6.181917e-20 7.483818e-20 8.370102e-20 8.791318e-20 8.829315e-20 8.504939e-20 7.825207e-20\n[28,]",
        " 4.601323e-20 5.808662e-20 6.609241e-20 6.952104e-20 6.972569e-20 6.756689e-20 6.268231e-20\n[29,] 3.001904e-20 4.003079e-20 4.739711e-20 5.143401e-20 5.330843e-20 5.378905e-20 5.179365e-20\n[30,] 1.615017e-20 2.295210e-20 2.878806e-20 3.311948e-20 3.665375e-20 3.957360e-20 4.013305e-20\n             [,15]        [,16]        [,17]        [,18]        [,19]        [,20]        [,21]\n [1,] 1.712179e-20 1.761451e-20 1.847993e-20 2.042982e-20 2.217670e-20 2.178452e-20 1.890134e-20\n [2,] 3.094941e-20 3.168412e-20 3.245048e-20",
        " 3.473621e-20 3.702241e-20 3.651726e-20 3.249445e-20\n [3,] 4.678356e-20 4.844812e-20 4.991964e-20 5.288676e-20 5.552778e-20 5.473162e-20 4.985459e-20\n [4,] 6.332525e-20 6.729850e-20 7.128811e-20 7.580319e-20 7.847195e-20 7.684202e-20 7.124855e-20\n [5,] 8.356854e-20 9.133428e-20 9.942618e-20 1.057719e-19 1.074091e-19 1.036506e-19 9.666984e-20\n [6,] 1.149557e-19 1.266863e-19 1.386143e-19 1.456261e-19 1.442669e-19 1.361339e-19 1.257158e-19\n [7,] 1.701505e-19 1.836232e-19 1.962558e-19 2.008165e-19 1.930846e-19 1.764891e-19",
        " 1.582691e-19\n [8,] 2.711541e-19 2.828122e-19 2.898491e-19 2.851662e-19 2.637890e-19 2.304298e-19 1.962047e-19\n [9,] 4.512743e-19 4.602417e-19 4.524816e-19 4.251136e-19 3.753243e-19 3.106227e-19 2.475612e-19\n[10,] 7.644612e-19 7.780952e-19 7.423915e-19 6.664650e-19 5.599164e-19 4.395868e-19 3.289502e-19\n[11,] 1.319850e-18 1.357097e-18 1.268371e-18 1.090352e-18 8.695833e-19 6.484279e-19 4.598173e-19\n[12,] 2.288186e-18 2.376875e-18 2.183874e-18 1.802560e-18 1.362478e-18 9.617207e-19 6.475421e-19\n[13,] 3.758740e-18",
        " 3.925323e-18 3.553197e-18 2.831906e-18 2.036474e-18 1.359932e-18 8.686256e-19\n[14,] 5.473248e-18 5.723851e-18 5.119395e-18 3.970272e-18 2.740386e-18 1.742511e-18 1.060689e-18\n[15,] 6.759015e-18 7.059497e-18 6.256906e-18 4.757802e-18 3.185991e-18 1.952447e-18 1.147601e-18\n[16,] 6.937951e-18 7.219672e-18 6.357712e-18 4.775557e-18 3.140374e-18 1.886769e-18 1.095295e-18\n[17,] 5.909827e-18 6.110869e-18 5.363592e-18 4.017078e-18 2.636970e-18 1.592169e-18 9.430653e-19\n[18,] 4.244121e-18 4.347231e-18 3.822270e-18 2.895095e-18",
        " 1.943712e-18 1.219536e-18 7.637083e-19\n[19,] 2.666949e-18 2.696752e-18 2.393783e-18 1.870205e-18 1.322761e-18 8.895972e-19 5.995285e-19\n[20,] 1.557724e-18 1.550992e-18 1.401882e-18 1.149797e-18 8.724952e-19 6.326273e-19 4.524591e-19\n[21,] 9.064510e-19 8.900548e-19 8.218619e-19 7.075789e-19 5.696995e-19 4.344879e-19 3.200930e-19\n[22,] 5.496643e-19 5.361892e-19 5.032103e-19 4.458494e-19 3.693187e-19 2.871663e-19 2.137661e-19\n[23,] 3.474679e-19 3.390155e-19 3.209545e-19 2.872870e-19 2.399363e-19 1.883493e-19 1.428193e-19",
        "\n[24,] 2.233800e-19 2.171362e-19 2.062056e-19 1.859096e-19 1.572216e-19 1.267105e-19 1.007809e-19\n[25,] 1.444691e-19 1.377779e-19 1.302472e-19 1.186127e-19 1.028218e-19 8.666874e-20 7.366394e-20\n[26,] 9.644031e-20 8.883460e-20 8.263647e-20 7.578640e-20 6.747791e-20 5.942634e-20 5.342831e-20\n[27,] 6.958444e-20 6.177961e-20 5.603510e-20 5.135049e-20 4.664323e-20 4.225136e-20 3.896633e-20\n[28,] 5.541879e-20 4.791263e-20 4.213572e-20 3.813223e-20 3.493124e-20 3.202571e-20 2.942464e-20\n[29,] 4.646200e-20 3.944431e-20",
        " 3.335576e-20 2.922470e-20 2.647505e-20 2.424137e-20 2.194022e-20\n[30,] 3.676795e-20 3.073710e-20 2.486082e-20 2.072645e-20 1.817965e-20 1.638495e-20 1.455462e-20\n             [,22]        [,23]        [,24]        [,25]        [,26]        [,27]        [,28]\n [1,] 1.458503e-20 1.001763e-20 6.120919e-21 3.397735e-21 1.758132e-21 8.294086e-22 3.339976e-22\n [2,] 2.620282e-20 1.920983e-20 1.293021e-20 8.196380e-21 4.895061e-21 2.608320e-21 1.157233e-21\n [3,] 4.219562e-20 3.328881e-20 2.480986e-20 1.777188e-20 1.192319e-20",
        " 6.997295e-21 3.383661e-21\n [4,] 6.300286e-20 5.309097e-20 4.307289e-20 3.384735e-20 2.474268e-20 1.571533e-20 8.249916e-21\n [5,] 8.786968e-20 7.735720e-20 6.626695e-20 5.522387e-20 4.293594e-20 2.924604e-20 1.667465e-20\n [6,] 1.148443e-19 1.028046e-19 9.011260e-20 7.730456e-20 6.274975e-20 4.553769e-20 2.815686e-20\n [7,] 1.417990e-19 1.260556e-19 1.105409e-19 9.560238e-20 7.971733e-20 6.091247e-20 4.041917e-20\n [8,] 1.679886e-19 1.452973e-19 1.258394e-19 1.085715e-19 9.167436e-20 7.239319e-20 5.057818e-20\n [9,]",
        " 1.980088e-19 1.626736e-19 1.369875e-19 1.169495e-19 9.894992e-20 7.939921e-20 5.735069e-20\n[10,] 2.440275e-19 1.861043e-19 1.484001e-19 1.232491e-19 1.035685e-19 8.373908e-20 6.190818e-20\n[11,] 3.194363e-19 2.251856e-19 1.665591e-19 1.315328e-19 1.082740e-19 8.757397e-20 6.582038e-20\n[12,] 4.261955e-19 2.821168e-19 1.948472e-19 1.451659e-19 1.153599e-19 9.205729e-20 6.945081e-20\n[13,] 5.456083e-19 3.463500e-19 2.299159e-19 1.648608e-19 1.266696e-19 9.866016e-20 7.358804e-20\n[14,] 6.415118e-19 3.989176e-19 2.634686e-19",
        " 1.882832e-19 1.427948e-19 1.091532e-19 8.018929e-20\n[15,] 6.795608e-19 4.237754e-19 2.865309e-19 2.096626e-19 1.603462e-19 1.221768e-19 8.921780e-20\n[16,] 6.522130e-19 4.180142e-19 2.935923e-19 2.213986e-19 1.719318e-19 1.318231e-19 9.637491e-20\n[17,] 5.834411e-19 3.912155e-19 2.845814e-19 2.187056e-19 1.712473e-19 1.317907e-19 9.623277e-20\n[18,] 5.023490e-19 3.526748e-19 2.618659e-19 2.018582e-19 1.575258e-19 1.205454e-19 8.719745e-20\n[19,] 4.177701e-19 3.024924e-19 2.265465e-19 1.741627e-19 1.348029e-19 1.017956e-19",
        " 7.236738e-20\n[20,] 3.261145e-19 2.398371e-19 1.814287e-19 1.405986e-19 1.088186e-19 8.113238e-20 5.643954e-20\n[21,] 2.337043e-19 1.741522e-19 1.351490e-19 1.079925e-19 8.508926e-20 6.319292e-20 4.300264e-20\n[22,] 1.577813e-19 1.207101e-19 9.819732e-20 8.259057e-20 6.727414e-20 5.027078e-20 3.352957e-20\n[23,] 1.089021e-19 8.736643e-20 7.521227e-20 6.651756e-20 5.585649e-20 4.195912e-20 2.736743e-20\n[24,] 8.187723e-20 6.994828e-20 6.327883e-20 5.777120e-20 4.915790e-20 3.662308e-20 2.307588e-20\n[25,] 6.454416e-20",
        " 5.893612e-20 5.576026e-20 5.204749e-20 4.441378e-20 3.247317e-20 1.954550e-20\n[26,] 4.971403e-20 4.784889e-20 4.685884e-20 4.439961e-20 3.784166e-20 2.714585e-20 1.566551e-20\n[27,] 3.694051e-20 3.584628e-20 3.494867e-20 3.272776e-20 2.749833e-20 1.934278e-20 1.081756e-20\n[28,] 2.707284e-20 2.482351e-20 2.254697e-20 1.982257e-20 1.594161e-20 1.088615e-20 5.928575e-21\n[29,] 1.918836e-20 1.596138e-20 1.270626e-20 9.823147e-21 7.206524e-21 4.664867e-21 2.460774e-21\n[30,] 1.216395e-20 9.222569e-21 6.331332e-21 4.092622e-21",
        " 2.573732e-21 1.513280e-21 7.589242e-22\n             [,29]        [,30]\n [1,] 1.077847e-22 2.715391e-23\n [2,] 4.094171e-22 1.138202e-22\n [3,] 1.309851e-21 4.026234e-22\n [4,] 3.501224e-21 1.192824e-21\n [5,] 7.776687e-21 2.937355e-21\n [6,] 1.439832e-20 5.998844e-21\n [7,] 2.243045e-20 1.021659e-20\n [8,] 2.999595e-20 1.477672e-20\n [9,] 3.582804e-20 1.889860e-20\n[10,] 4.033061e-20 2.256413e-20\n[11,] 4.432035e-20 2.602375e-20\n[12,] 4.771493e-20 2.900411e-20\n[13,] 5.076579e-20 3.143892e-20\n[14,] 5.502510e-20 3.424529e-20",
        "\n[15,] 6.090334e-20 3.775115e-20\n[16,] 6.543401e-20 4.005534e-20\n[17,] 6.462302e-20 3.870169e-20\n[18,] 5.752981e-20 3.348585e-20\n[19,] 4.670911e-20 2.639124e-20\n[20,] 3.552132e-20 1.949194e-20\n[21,] 2.622255e-20 1.387692e-20\n[22,] 1.962448e-20 9.838039e-21\n[23,] 1.523526e-20 7.106664e-21\n[24,] 1.207139e-20 5.171289e-21\n[25,] 9.494440e-21 3.690546e-21\n[26,] 7.102647e-21 2.510767e-21\n[27,] 4.667629e-21 1.535086e-21\n[28,] 2.475841e-21 7.778201e-22\n[29,] 1.001578e-21 3.055788e-22\n[30,] 3.000654e-22 8.940410e-23",
        "\n",
        "> ",
        "magimage(convolution(spectral_cube[,,spatial_plane], observation$psf_kernel))",
        "> ",
        "magimage(OpenImageR::convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)*calc_region)",
        "> ",
        "OpenImageR::convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)*calc_region",
        "              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]\n [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [3,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [4,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 1.759349e-20 2.028912e-20\n [5,] 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00 2.461245e-20 2.976324e-20 3.263245e-20\n [6,] 0.000000e+00 0.000000e+00 0.000000e+00 2.653510e-20 3.791292e-20 4.560221e-20 4.918487e-20\n [7,] 0.000000e+00 0.000000e+00 0.000000e+00 3.772843e-20 5.285711e-20 6.386672e-20 6.983515e-20\n [8,] 0.000000e+00 0.000000e+00 3.262498e-20 5.027683e-20 6.821562e-20 8.270951e-20 9.310133e-20\n [9,] 0.000000e+00 2.644333e-20 4.373576e-20 6.359963e-20 8.342697e-20 1.011355e-19 1.173035e-19\n[10,] 0.000000e+00 3.540005e-20 5.528765e-20 7.716890e-20 9.884517e-20",
        " 1.198558e-19 1.424228e-19\n[11,] 0.000000e+00 4.522829e-20 6.764371e-20 9.180808e-20 1.158571e-19 1.408037e-19 1.707054e-19\n[12,] 3.456588e-20 5.597542e-20 8.155263e-20 1.084226e-19 1.352020e-19 1.651184e-19 2.049658e-19\n[13,] 4.079511e-20 6.542733e-20 9.420642e-20 1.237488e-19 1.537329e-19 1.907625e-19 2.456597e-19\n[14,] 4.388976e-20 6.990208e-20 1.000041e-19 1.313691e-19 1.657335e-19 2.133587e-19 2.892909e-19\n[15,] 4.362153e-20 6.850321e-20 9.734726e-20 1.293734e-19 1.691720e-19 2.297597e-19 3.289627e-19\n[16,]",
        " 4.138710e-20 6.415348e-20 9.079458e-20 1.229348e-19 1.677553e-19 2.394820e-19 3.562705e-19\n[17,] 3.841366e-20 5.974688e-20 8.511615e-20 1.175545e-19 1.653651e-19 2.420398e-19 3.633533e-19\n[18,] 3.492036e-20 5.564810e-20 8.075583e-20 1.133292e-19 1.608993e-19 2.342856e-19 3.450921e-19\n[19,] 3.087209e-20 5.106198e-20 7.584666e-20 1.073252e-19 1.508788e-19 2.137354e-19 3.036930e-19\n[20,] 0.000000e+00 4.560045e-20 6.940795e-20 9.841560e-20 1.353552e-19 1.843407e-19 2.514686e-19\n[21,] 0.000000e+00 3.906204e-20 6.132779e-20",
        " 8.752829e-20 1.179473e-19 1.545838e-19 2.034885e-19\n[22,] 0.000000e+00 3.127165e-20 5.147686e-20 7.541043e-20 1.014413e-19 1.298474e-19 1.663444e-19\n[23,] 0.000000e+00 0.000000e+00 4.031912e-20 6.227025e-20 8.576806e-20 1.092660e-19 1.368016e-19\n[24,] 0.000000e+00 0.000000e+00 0.000000e+00 4.839891e-20 6.940292e-20 8.930040e-20 1.098803e-19\n[25,] 0.000000e+00 0.000000e+00 0.000000e+00 3.456130e-20 5.201126e-20 6.874068e-20 8.494573e-20\n[26,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 3.553350e-20 4.959628e-20",
        " 6.402475e-20\n[27,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 3.377417e-20 4.727196e-20\n[28,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[29,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n              [,8]         [,9]        [,10]        [,11]        [,12]        [,13]        [,14]\n [1,] 0.000000e+00",
        " 0.000000e+00 0.000000e+00 0.000000e+00 1.164816e-20 1.398523e-20 1.591953e-20\n [2,] 0.000000e+00 9.750558e-21 1.276354e-20 1.649012e-20 2.059819e-20 2.475788e-20 2.854039e-20\n [3,] 1.421829e-20 1.762116e-20 2.162027e-20 2.629815e-20 3.163331e-20 3.741982e-20 4.294995e-20\n [4,] 2.353176e-20 2.786593e-20 3.300863e-20 3.876178e-20 4.505498e-20 5.165935e-20 5.804676e-20\n [5,] 3.574305e-20 4.089258e-20 4.788843e-20 5.572059e-20 6.335660e-20 7.019660e-20 7.664659e-20\n [6,] 5.243533e-20 5.906793e-20 6.948449e-20 8.142564e-20",
        " 9.193167e-20 9.962106e-20 1.062483e-19\n [7,] 7.529042e-20 8.574772e-20 1.025266e-19 1.221389e-19 1.392422e-19 1.510455e-19 1.598240e-19\n [8,] 1.041152e-19 1.222447e-19 1.499040e-19 1.832651e-19 2.150213e-19 2.398118e-19 2.574822e-19\n [9,] 1.367636e-19 1.663093e-19 2.098469e-19 2.653402e-19 3.255260e-19 3.813125e-19 4.247977e-19\n[10,] 1.718250e-19 2.152151e-19 2.790567e-19 3.666094e-19 4.754265e-19 5.936636e-19 6.985107e-19\n[11,] 2.117395e-19 2.721471e-19 3.630183e-19 4.982206e-19 6.885561e-19 9.242668e-19 1.158372e-18",
        "\n[12,] 2.626397e-19 3.487424e-19 4.822597e-19 6.948934e-19 1.022043e-18 1.464270e-18 1.938604e-18\n[13,] 3.293582e-19 4.567273e-19 6.582194e-19 9.897718e-19 1.521198e-18 2.272265e-18 3.114181e-18\n[14,] 4.086450e-19 5.923760e-19 8.832098e-19 1.360062e-18 2.126451e-18 3.225747e-18 4.486763e-18\n[15,] 4.857615e-19 7.267439e-19 1.101725e-18 1.698964e-18 2.637655e-18 3.978294e-18 5.530756e-18\n[16,] 5.382426e-19 8.134135e-19 1.228904e-18 1.862427e-18 2.820078e-18 4.161188e-18 5.710212e-18\n[17,] 5.465342e-19 8.151736e-19",
        " 1.205645e-18 1.772229e-18 2.586008e-18 3.684906e-18 4.931848e-18\n[18,] 5.054461e-19 7.316387e-19 1.047274e-18 1.482312e-18 2.068719e-18 2.814544e-18 3.626384e-18\n[19,] 4.293547e-19 6.013055e-19 8.320523e-19 1.131873e-18 1.502954e-18 1.931237e-18 2.360925e-18\n[20,] 3.451123e-19 4.728886e-19 6.376067e-19 8.341699e-19 1.048450e-18 1.260410e-18 1.443923e-18\n[21,] 2.742484e-19 3.723570e-19 4.921832e-19 6.183382e-19 7.325329e-19 8.214688e-19 8.804272e-19\n[22,] 2.205147e-19 2.955912e-19 3.810721e-19 4.585383e-19 5.134432e-19",
        " 5.421800e-19 5.515104e-19\n[23,] 1.760995e-19 2.287775e-19 2.846443e-19 3.288861e-19 3.529321e-19 3.583051e-19 3.537743e-19\n[24,] 1.361843e-19 1.690980e-19 2.019204e-19 2.259279e-19 2.368978e-19 2.363433e-19 2.299260e-19\n[25,] 1.030725e-19 1.232242e-19 1.418151e-19 1.549317e-19 1.606862e-19 1.590360e-19 1.522693e-19\n[26,] 7.917934e-20 9.379500e-20 1.054319e-19 1.127109e-19 1.152622e-19 1.126056e-19 1.053577e-19\n[27,] 6.181917e-20 7.483818e-20 8.370102e-20 8.791318e-20 8.829315e-20 8.504939e-20 7.825207e-20\n[28,]",
        " 4.601323e-20 5.808662e-20 6.609241e-20 6.952104e-20 6.972569e-20 6.756689e-20 6.268231e-20\n[29,] 0.000000e+00 4.003079e-20 4.739711e-20 5.143401e-20 5.330843e-20 5.378905e-20 5.179365e-20\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 3.665375e-20 3.957360e-20 4.013305e-20\n             [,15]        [,16]        [,17]        [,18]        [,19]        [,20]        [,21]\n [1,] 1.712179e-20 1.761451e-20 1.847993e-20 2.042982e-20 2.217670e-20 0.000000e+00 0.000000e+00\n [2,] 3.094941e-20 3.168412e-20 3.245048e-20",
        " 3.473621e-20 3.702241e-20 3.651726e-20 3.249445e-20\n [3,] 4.678356e-20 4.844812e-20 4.991964e-20 5.288676e-20 5.552778e-20 5.473162e-20 4.985459e-20\n [4,] 6.332525e-20 6.729850e-20 7.128811e-20 7.580319e-20 7.847195e-20 7.684202e-20 7.124855e-20\n [5,] 8.356854e-20 9.133428e-20 9.942618e-20 1.057719e-19 1.074091e-19 1.036506e-19 9.666984e-20\n [6,] 1.149557e-19 1.266863e-19 1.386143e-19 1.456261e-19 1.442669e-19 1.361339e-19 1.257158e-19\n [7,] 1.701505e-19 1.836232e-19 1.962558e-19 2.008165e-19 1.930846e-19 1.764891e-19",
        " 1.582691e-19\n [8,] 2.711541e-19 2.828122e-19 2.898491e-19 2.851662e-19 2.637890e-19 2.304298e-19 1.962047e-19\n [9,] 4.512743e-19 4.602417e-19 4.524816e-19 4.251136e-19 3.753243e-19 3.106227e-19 2.475612e-19\n[10,] 7.644612e-19 7.780952e-19 7.423915e-19 6.664650e-19 5.599164e-19 4.395868e-19 3.289502e-19\n[11,] 1.319850e-18 1.357097e-18 1.268371e-18 1.090352e-18 8.695833e-19 6.484279e-19 4.598173e-19\n[12,] 2.288186e-18 2.376875e-18 2.183874e-18 1.802560e-18 1.362478e-18 9.617207e-19 6.475421e-19\n[13,] 3.758740e-18",
        " 3.925323e-18 3.553197e-18 2.831906e-18 2.036474e-18 1.359932e-18 8.686256e-19\n[14,] 5.473248e-18 5.723851e-18 5.119395e-18 3.970272e-18 2.740386e-18 1.742511e-18 1.060689e-18\n[15,] 6.759015e-18 7.059497e-18 6.256906e-18 4.757802e-18 3.185991e-18 1.952447e-18 1.147601e-18\n[16,] 6.937951e-18 7.219672e-18 6.357712e-18 4.775557e-18 3.140374e-18 1.886769e-18 1.095295e-18\n[17,] 5.909827e-18 6.110869e-18 5.363592e-18 4.017078e-18 2.636970e-18 1.592169e-18 9.430653e-19\n[18,] 4.244121e-18 4.347231e-18 3.822270e-18 2.895095e-18",
        " 1.943712e-18 1.219536e-18 7.637083e-19\n[19,] 2.666949e-18 2.696752e-18 2.393783e-18 1.870205e-18 1.322761e-18 8.895972e-19 5.995285e-19\n[20,] 1.557724e-18 1.550992e-18 1.401882e-18 1.149797e-18 8.724952e-19 6.326273e-19 4.524591e-19\n[21,] 9.064510e-19 8.900548e-19 8.218619e-19 7.075789e-19 5.696995e-19 4.344879e-19 3.200930e-19\n[22,] 5.496643e-19 5.361892e-19 5.032103e-19 4.458494e-19 3.693187e-19 2.871663e-19 2.137661e-19\n[23,] 3.474679e-19 3.390155e-19 3.209545e-19 2.872870e-19 2.399363e-19 1.883493e-19 1.428193e-19",
        "\n[24,] 2.233800e-19 2.171362e-19 2.062056e-19 1.859096e-19 1.572216e-19 1.267105e-19 1.007809e-19\n[25,] 1.444691e-19 1.377779e-19 1.302472e-19 1.186127e-19 1.028218e-19 8.666874e-20 7.366394e-20\n[26,] 9.644031e-20 8.883460e-20 8.263647e-20 7.578640e-20 6.747791e-20 5.942634e-20 5.342831e-20\n[27,] 6.958444e-20 6.177961e-20 5.603510e-20 5.135049e-20 4.664323e-20 4.225136e-20 3.896633e-20\n[28,] 5.541879e-20 4.791263e-20 4.213572e-20 3.813223e-20 3.493124e-20 3.202571e-20 2.942464e-20\n[29,] 4.646200e-20 3.944431e-20",
        " 3.335576e-20 2.922470e-20 2.647505e-20 2.424137e-20 2.194022e-20\n[30,] 3.676795e-20 3.073710e-20 2.486082e-20 2.072645e-20 1.817965e-20 0.000000e+00 0.000000e+00\n             [,22]        [,23]        [,24]        [,25]        [,26]        [,27]        [,28]\n [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [2,] 2.620282e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n [3,] 4.219562e-20 3.328881e-20 0.000000e+00 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00\n [4,] 6.300286e-20 5.309097e-20 4.307289e-20 3.384735e-20 0.000000e+00 0.000000e+00 0.000000e+00\n [5,] 8.786968e-20 7.735720e-20 6.626695e-20 5.522387e-20 4.293594e-20 0.000000e+00 0.000000e+00\n [6,] 1.148443e-19 1.028046e-19 9.011260e-20 7.730456e-20 6.274975e-20 4.553769e-20 0.000000e+00\n [7,] 1.417990e-19 1.260556e-19 1.105409e-19 9.560238e-20 7.971733e-20 6.091247e-20 0.000000e+00\n [8,] 1.679886e-19 1.452973e-19 1.258394e-19 1.085715e-19 9.167436e-20 7.239319e-20 5.057818e-20\n [9,]",
        " 1.980088e-19 1.626736e-19 1.369875e-19 1.169495e-19 9.894992e-20 7.939921e-20 5.735069e-20\n[10,] 2.440275e-19 1.861043e-19 1.484001e-19 1.232491e-19 1.035685e-19 8.373908e-20 6.190818e-20\n[11,] 3.194363e-19 2.251856e-19 1.665591e-19 1.315328e-19 1.082740e-19 8.757397e-20 6.582038e-20\n[12,] 4.261955e-19 2.821168e-19 1.948472e-19 1.451659e-19 1.153599e-19 9.205729e-20 6.945081e-20\n[13,] 5.456083e-19 3.463500e-19 2.299159e-19 1.648608e-19 1.266696e-19 9.866016e-20 7.358804e-20\n[14,] 6.415118e-19 3.989176e-19 2.634686e-19",
        " 1.882832e-19 1.427948e-19 1.091532e-19 8.018929e-20\n[15,] 6.795608e-19 4.237754e-19 2.865309e-19 2.096626e-19 1.603462e-19 1.221768e-19 8.921780e-20\n[16,] 6.522130e-19 4.180142e-19 2.935923e-19 2.213986e-19 1.719318e-19 1.318231e-19 9.637491e-20\n[17,] 5.834411e-19 3.912155e-19 2.845814e-19 2.187056e-19 1.712473e-19 1.317907e-19 9.623277e-20\n[18,] 5.023490e-19 3.526748e-19 2.618659e-19 2.018582e-19 1.575258e-19 1.205454e-19 8.719745e-20\n[19,] 4.177701e-19 3.024924e-19 2.265465e-19 1.741627e-19 1.348029e-19 1.017956e-19",
        " 7.236738e-20\n[20,] 3.261145e-19 2.398371e-19 1.814287e-19 1.405986e-19 1.088186e-19 8.113238e-20 5.643954e-20\n[21,] 2.337043e-19 1.741522e-19 1.351490e-19 1.079925e-19 8.508926e-20 6.319292e-20 4.300264e-20\n[22,] 1.577813e-19 1.207101e-19 9.819732e-20 8.259057e-20 6.727414e-20 5.027078e-20 3.352957e-20\n[23,] 1.089021e-19 8.736643e-20 7.521227e-20 6.651756e-20 5.585649e-20 4.195912e-20 2.736743e-20\n[24,] 8.187723e-20 6.994828e-20 6.327883e-20 5.777120e-20 4.915790e-20 3.662308e-20 0.000000e+00\n[25,] 6.454416e-20",
        " 5.893612e-20 5.576026e-20 5.204749e-20 4.441378e-20 3.247317e-20 0.000000e+00\n[26,] 4.971403e-20 4.784889e-20 4.685884e-20 4.439961e-20 3.784166e-20 0.000000e+00 0.000000e+00\n[27,] 3.694051e-20 3.584628e-20 3.494867e-20 3.272776e-20 0.000000e+00 0.000000e+00 0.000000e+00\n[28,] 2.707284e-20 2.482351e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[29,] 1.918836e-20 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00",
        " 0.000000e+00 0.000000e+00 0.000000e+00\n             [,29]        [,30]\n [1,] 0.000000e+00 0.000000e+00\n [2,] 0.000000e+00 0.000000e+00\n [3,] 0.000000e+00 0.000000e+00\n [4,] 0.000000e+00 0.000000e+00\n [5,] 0.000000e+00 0.000000e+00\n [6,] 0.000000e+00 0.000000e+00\n [7,] 0.000000e+00 0.000000e+00\n [8,] 0.000000e+00 0.000000e+00\n [9,] 3.582804e-20 0.000000e+00\n[10,] 4.033061e-20 0.000000e+00\n[11,] 4.432035e-20 0.000000e+00\n[12,] 4.771493e-20 2.900411e-20\n[13,] 5.076579e-20 3.143892e-20\n[14,] 5.502510e-20 3.424529e-20",
        "\n[15,] 6.090334e-20 3.775115e-20\n[16,] 6.543401e-20 4.005534e-20\n[17,] 6.462302e-20 3.870169e-20\n[18,] 5.752981e-20 3.348585e-20\n[19,] 4.670911e-20 2.639124e-20\n[20,] 3.552132e-20 0.000000e+00\n[21,] 2.622255e-20 0.000000e+00\n[22,] 1.962448e-20 0.000000e+00\n[23,] 0.000000e+00 0.000000e+00\n[24,] 0.000000e+00 0.000000e+00\n[25,] 0.000000e+00 0.000000e+00\n[26,] 0.000000e+00 0.000000e+00\n[27,] 0.000000e+00 0.000000e+00\n[28,] 0.000000e+00 0.000000e+00\n[29,] 0.000000e+00 0.000000e+00\n[30,] 0.000000e+00 0.000000e+00",
        "\n",
        "> ",
        "  calc_region = observation$aperture_region",
        "> ",
        "  calc_region = matrix(data = calc_region, nrow = cube_dims[1], ncol=cube_dims[2])",
        "> ",
        "OpenImageR::convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)*calc_region",
        "              [,1]         [,2]         [,3]         [,4]         [,5]         [,6]         [,7]\n [1,]           NA           NA           NA           NA           NA           NA           NA\n [2,]           NA           NA           NA           NA           NA           NA           NA\n [3,]           NA           NA           NA           NA           NA           NA           NA\n [4,]           NA           NA           NA           NA           NA 2.709397e-18 3.733198e-18\n [5,]           NA           NA",
        "           NA           NA 3.076557e-18 4.613303e-18 6.037003e-18\n [6,]           NA           NA           NA 2.547370e-18 4.777028e-18 7.113945e-18 9.148385e-18\n [7,]           NA           NA           NA 3.659658e-18 6.712853e-18 1.002707e-17 1.305917e-17\n [8,]           NA           NA 2.218499e-18 4.927129e-18 8.731599e-18 1.306810e-17 1.750305e-17\n [9,]           NA 1.031290e-18 3.017767e-18 6.296363e-18 1.076208e-17 1.608054e-17 2.217037e-17\n[10,]           NA 1.416002e-18 3.870135e-18 7.716890e-18 1.284987e-17",
        " 1.917693e-17 2.706032e-17\n[11,]           NA 1.854360e-18 4.802703e-18 9.272616e-18 1.517729e-17 2.266940e-17 3.260473e-17\n[12,] 4.147906e-19 2.350968e-18 5.871789e-18 1.105910e-17 1.784667e-17 2.674918e-17 3.935344e-17\n[13,] 5.303365e-19 2.813375e-18 6.877068e-18 1.274613e-17 2.044647e-17 3.109428e-17 4.741232e-17\n[14,] 6.144567e-19 3.075691e-18 7.400306e-18 1.366239e-17 2.220830e-17 3.499082e-17 5.612244e-17\n[15,] 6.543229e-19 3.082644e-18 7.301044e-18 1.358421e-17 2.283822e-17 3.791034e-17 6.414774e-17\n[16,]",
        " 6.621936e-19 2.951060e-18 6.900388e-18 1.303109e-17 2.281472e-17 3.975402e-17 6.982901e-17\n[17,] 6.530322e-19 2.808104e-18 6.553944e-18 1.257833e-17 2.265502e-17 4.042065e-17 7.158059e-17\n[18,] 6.285665e-19 2.671109e-18 6.298955e-18 1.223955e-17 2.220410e-17 3.935997e-17 6.832823e-17\n[19,] 5.865696e-19 2.502037e-18 5.991886e-18 1.169845e-17 2.097216e-17 3.612129e-17 6.043490e-17\n[20,]           NA 2.280023e-18 5.552636e-18 1.082572e-17 1.894973e-17 3.133792e-17 5.029372e-17\n[21,]           NA 1.992164e-18 4.967551e-18",
        " 9.715641e-18 1.663057e-17 2.643382e-17 4.090119e-17\n[22,]           NA 1.626126e-18 4.221102e-18 8.445968e-18 1.440466e-17 2.233375e-17 3.360156e-17\n[23,]           NA           NA 3.346487e-18 7.036538e-18 1.226483e-17 1.890302e-17 2.777072e-17\n[24,]           NA           NA           NA 5.517475e-18 9.994021e-18 1.553827e-17 2.241558e-17\n[25,]           NA           NA           NA 3.974550e-18 7.541633e-18 1.202962e-17 1.741387e-17\n[26,]           NA           NA           NA           NA 5.187891e-18 8.728945e-18",
        " 1.318910e-17\n[27,]           NA           NA           NA           NA           NA 5.978028e-18 9.785295e-18\n[28,]           NA           NA           NA           NA           NA           NA           NA\n[29,]           NA           NA           NA           NA           NA           NA           NA\n[30,]           NA           NA           NA           NA           NA           NA           NA\n              [,8]         [,9]        [,10]        [,11]        [,12]        [,13]        [,14]\n [1,]           NA",
        "           NA           NA           NA 3.855543e-18 5.048666e-18 6.224537e-18\n [2,]           NA 2.359635e-18 3.471683e-18 4.980016e-18 6.838600e-18 8.962353e-18 1.118783e-17\n [3,] 3.028496e-18 4.281943e-18 5.902334e-18 7.968341e-18 1.053389e-17 1.358339e-17 1.687933e-17\n [4,] 5.035796e-18 6.799287e-18 9.044364e-18 1.178358e-17 1.504836e-17 1.880400e-17 2.287042e-17\n [5,] 7.684756e-18 1.001868e-17 1.316932e-17 1.699478e-17 2.122446e-17 2.562176e-17 3.027540e-17\n [6,] 1.132603e-17 1.453071e-17 1.917772e-17 2.491625e-17",
        " 3.088904e-17 3.646131e-17 4.207433e-17\n [7,] 1.633802e-17 2.117969e-17 2.839987e-17 3.749665e-17 4.692463e-17 5.543369e-17 6.345012e-17\n [8,] 2.269712e-17 3.031670e-17 4.167331e-17 5.644565e-17 7.267719e-17 8.825075e-17 1.024779e-16\n [9,] 2.995124e-17 4.141101e-17 5.854729e-17 8.199012e-17 1.103533e-16 1.407043e-16 1.694943e-16\n[10,] 3.780149e-17 5.380377e-17 7.813586e-17 1.136489e-16 1.616450e-16 2.196555e-16 2.794043e-16\n[11,] 4.679443e-17 6.830891e-17 1.020082e-16 1.549466e-16 2.347976e-16 3.429030e-16 4.645073e-16",
        "\n[12,] 5.830601e-17 8.788308e-17 1.359972e-16 2.168067e-16 3.495388e-16 5.447086e-16 7.793187e-16\n[13,] 7.344688e-17 1.155520e-16 1.862761e-16 3.097986e-16 5.217709e-16 8.475549e-16 1.255015e-15\n[14,] 9.153648e-17 1.504635e-16 2.508316e-16 4.270596e-16 7.314991e-16 1.206429e-15 1.812652e-15\n[15,] 1.092963e-16 1.853197e-16 3.139917e-16 5.351735e-16 9.099911e-16 1.491860e-15 2.239956e-15\n[16,] 1.216428e-16 2.082339e-16 3.514666e-16 5.885270e-16 9.757471e-16 1.564607e-15 2.318346e-15\n[17,] 1.240633e-16 2.094996e-16",
        " 3.460201e-16 5.617966e-16 8.973447e-16 1.389210e-15 2.007262e-15\n[18,] 1.152417e-16 1.887628e-16 3.016148e-16 4.713751e-16 7.199142e-16 1.063898e-15 1.479565e-15\n[19,] 9.832223e-17 1.557381e-16 2.404631e-16 3.610674e-16 5.245308e-16 7.319388e-16 9.656184e-16\n[20,] 7.937583e-17 1.229510e-16 1.849059e-16 2.669344e-16 3.669576e-16 4.789558e-16 5.920084e-16\n[21,] 6.335137e-17 9.718518e-17 1.432253e-16 1.984866e-16 2.571190e-16 3.129796e-16 3.618556e-16\n[22,] 5.115942e-17 7.744489e-17 1.112731e-16 1.476493e-16 1.807320e-16",
        " 2.071128e-16 2.272223e-16\n[23,] 4.103118e-17 6.016849e-17 8.340077e-17 1.062302e-16 1.245850e-16 1.372308e-16 1.461088e-16\n[24,] 3.186712e-17 4.464188e-17 5.936461e-17 7.320065e-17 8.386181e-17 9.075584e-17 9.518938e-17\n[25,] 2.422205e-17 3.265441e-17 4.183545e-17 5.035280e-17 5.704358e-17 6.122886e-17 6.319176e-17\n[26,] 1.868632e-17 2.494947e-17 3.120785e-17 3.674375e-17 4.103335e-17 4.346577e-17 4.382882e-17\n[27,] 1.465114e-17 1.998179e-17 2.485920e-17 2.874761e-17 3.152066e-17 3.291411e-17 3.263111e-17\n[28,]",
        " 1.095115e-17 1.556721e-17 1.969554e-17 2.280290e-17 2.496180e-17 2.621596e-17 2.620121e-17\n[29,]           NA 1.076828e-17 1.417174e-17 1.692179e-17 1.913773e-17 2.092394e-17 2.170154e-17\n[30,]           NA           NA           NA           NA 1.319535e-17 1.543371e-17 1.685588e-17\n             [,15]        [,16]        [,17]        [,18]        [,19]        [,20]        [,21]\n [1,] 7.208274e-18 7.944142e-18 8.888845e-18 1.043964e-17 1.199760e-17           NA           NA\n [2,] 1.306065e-17 1.432122e-17 1.564113e-17",
        " 1.778494e-17 2.006615e-17 2.088787e-17 1.956166e-17\n [3,] 1.978944e-17 2.194700e-17 2.411118e-17 2.713091e-17 3.015158e-17 3.136122e-17 3.006232e-17\n [4,] 2.684991e-17 3.055352e-17 3.450344e-17 3.896284e-17 4.268874e-17 4.410732e-17 4.303412e-17\n [5,] 3.551663e-17 4.155710e-17 4.822170e-17 5.447253e-17 5.853797e-17 5.959909e-17 5.848525e-17\n [6,] 4.897112e-17 5.776896e-17 6.736657e-17 7.514309e-17 7.876973e-17 7.841314e-17 7.618376e-17\n [7,] 7.265426e-17 8.391582e-17 9.557659e-17 1.038221e-16 1.056173e-16 1.018342e-16",
        " 9.606937e-17\n [8,] 1.160540e-16 1.295280e-16 1.414464e-16 1.477161e-16 1.445564e-16 1.331885e-16 1.192925e-16\n [9,] 1.935967e-16 2.112510e-16 2.212635e-16 2.206339e-16 2.060530e-16 1.798506e-16 1.507647e-16\n[10,] 3.287183e-16 3.579238e-16 3.637718e-16 3.465618e-16 3.079540e-16 2.549603e-16 2.006596e-16\n[11,] 5.688552e-16 6.256215e-16 6.227701e-16 5.680734e-16 4.791404e-16 3.767366e-16 2.809484e-16\n[12,] 9.884965e-16 1.098116e-15 1.074466e-15 9.409362e-16 7.520881e-16 5.597214e-16 3.962957e-16\n[13,] 1.627534e-15",
        " 1.817424e-15 1.751726e-15 1.481087e-15 1.126170e-15 7.928404e-16 5.324675e-16\n[14,] 2.375390e-15 2.655867e-15 2.528981e-15 2.080423e-15 1.518174e-15 1.017627e-15 6.512627e-16\n[15,] 2.940172e-15 3.282666e-15 3.097169e-15 2.497846e-15 1.768225e-15 1.142182e-15 7.057745e-16\n[16,] 3.024946e-15 3.364367e-15 3.153425e-15 2.511943e-15 1.746048e-15 1.105647e-15 6.747016e-16\n[17,] 2.582594e-15 2.853776e-15 2.665705e-15 2.117000e-15 1.468792e-15 9.346031e-16 5.818713e-16\n[18,] 1.858925e-15 2.034504e-15 1.903490e-15 1.528610e-15",
        " 1.084591e-15 7.170874e-16 4.719717e-16\n[19,] 1.170791e-15 1.264776e-15 1.194498e-15 9.893384e-16 7.394232e-16 5.239727e-16 3.711082e-16\n[20,] 6.853985e-16 7.289662e-16 7.009409e-16 6.093923e-16 4.885973e-16 3.732501e-16 2.805247e-16\n[21,] 3.997449e-16 4.192158e-16 4.117528e-16 3.757244e-16 3.196014e-16 2.567824e-16 1.987778e-16\n[22,] 2.429516e-16 2.530813e-16 2.526116e-16 2.371919e-16 2.075571e-16 1.700024e-16 1.329625e-16\n[23,] 1.539283e-16 1.603543e-16 1.614401e-16 1.531240e-16 1.350841e-16 1.116911e-16 8.897644e-17",
        "\n[24,] 9.918071e-17 1.029226e-16 1.039276e-16 9.927571e-17 8.867300e-17 7.526601e-17 6.288731e-17\n[25,] 6.428874e-17 6.544448e-17 6.577483e-17 6.345779e-17 5.809432e-17 5.156790e-17 4.603996e-17\n[26,] 4.301238e-17 4.228527e-17 4.181405e-17 4.062151e-17 3.819250e-17 3.541810e-17 3.344612e-17\n[27,] 3.110425e-17 2.946888e-17 2.840980e-17 2.757521e-17 2.644671e-17 2.522406e-17 2.443189e-17\n[28,] 2.482762e-17 2.290223e-17 2.140495e-17 2.051514e-17 1.984095e-17 1.915137e-17 1.847868e-17\n[29,] 2.086144e-17 1.889382e-17",
        " 1.697808e-17 1.575212e-17 1.506430e-17 1.452058e-17 1.380040e-17\n[30,] 1.654558e-17 1.475381e-17 1.267902e-17 1.119228e-17 1.036240e-17           NA           NA\n             [,22]        [,23]        [,24]        [,25]        [,26]        [,27]        [,28]\n [1,]           NA           NA           NA           NA           NA           NA           NA\n [2,] 1.656018e-17           NA           NA           NA           NA           NA           NA\n [3,] 2.670982e-17 2.207048e-17           NA           NA           NA",
        "           NA           NA\n [4,] 3.994381e-17 3.525240e-17 2.989259e-17 2.450548e-17           NA           NA           NA\n [5,] 5.579725e-17 5.144254e-17 4.605553e-17 4.003730e-17 3.241664e-17           NA           NA\n [6,] 7.304099e-17 6.846785e-17 6.271837e-17 5.612311e-17 4.743881e-17 3.579263e-17           NA\n [7,] 9.032598e-17 8.407908e-17 7.704702e-17 6.950293e-17 6.034602e-17 4.793812e-17           NA\n [8,] 1.071767e-16 9.705856e-17 8.783592e-17 7.904005e-17 6.948916e-17 5.704583e-17 4.137295e-17\n [9,]",
        " 1.265276e-16 1.088286e-16 9.575425e-17 8.525619e-17 7.510299e-17 6.264598e-17 4.697021e-17\n[10,] 1.561776e-16 1.246899e-16 1.038801e-16 8.997187e-17 7.871203e-17 6.615387e-17 5.076471e-17\n[11,] 2.047587e-16 1.510995e-16 1.167579e-16 9.615046e-17 8.239654e-17 6.927101e-17 5.403853e-17\n[12,] 2.736175e-16 1.895825e-16 1.367827e-16 1.062614e-16 8.790425e-17 7.290938e-17 5.708857e-17\n[13,] 3.508261e-16 2.330936e-16 1.616309e-16 1.208430e-16 9.664891e-17 7.823751e-17 6.056295e-17\n[14,] 4.131336e-16 2.688705e-16 1.854819e-16",
        " 1.381999e-16 1.090952e-16 8.666760e-17 6.607598e-17\n[15,] 4.383167e-16 2.860484e-16 2.020043e-16 1.541020e-16 1.226648e-16 9.713057e-17 7.360468e-17\n[16,] 4.213296e-16 2.825776e-16 2.072762e-16 1.629493e-16 1.316998e-16 1.049312e-16 7.960567e-17\n[17,] 3.774864e-16 2.648529e-16 2.011990e-16 1.611860e-16 1.313466e-16 1.050372e-16 7.958450e-17\n[18,] 3.255222e-16 2.391135e-16 1.854010e-16 1.489714e-16 1.209798e-16 9.619522e-17 7.219949e-17\n[19,] 2.711328e-16 2.053923e-16 1.606214e-16 1.287063e-16 1.036634e-16 8.133468e-17",
        " 5.999255e-17\n[20,] 2.119744e-16 1.630892e-16 1.288144e-16 1.040430e-16 8.379033e-17 6.490591e-17 4.684481e-17\n[21,] 1.521415e-16 1.185977e-16 9.609097e-17 8.002246e-17 6.560382e-17 5.061753e-17 3.573519e-17\n[22,] 1.028734e-16 8.232432e-17 6.991649e-17 6.128220e-17 5.193564e-17 4.031716e-17 2.789660e-17\n[23,] 7.111307e-17 5.967127e-17 5.362635e-17 4.942255e-17 4.317707e-17 3.369317e-17 2.279707e-17\n[24,] 5.354771e-17 4.784462e-17 4.518109e-17 4.298177e-17 3.804821e-17 2.944496e-17           NA\n[25,] 4.227642e-17",
        " 4.037124e-17 3.986859e-17 3.877538e-17 3.442068e-17 2.614090e-17           NA\n[26,] 3.261240e-17 3.282434e-17 3.355093e-17 3.312211e-17 2.936513e-17           NA           NA\n[27,] 2.426992e-17 2.462640e-17 2.505820e-17 2.444764e-17           NA           NA           NA\n[28,] 1.781393e-17 1.707857e-17           NA           NA           NA           NA           NA\n[29,] 1.264513e-17           NA           NA           NA           NA           NA           NA\n[30,]           NA           NA           NA           NA",
        "           NA           NA           NA\n             [,29]        [,30]\n [1,]           NA           NA\n [2,]           NA           NA\n [3,]           NA           NA\n [4,]           NA           NA\n [5,]           NA           NA\n [6,]           NA           NA\n [7,]           NA           NA\n [8,]           NA           NA\n [9,] 3.041801e-17           NA\n[10,] 3.428102e-17           NA\n[11,] 3.771662e-17           NA\n[12,] 4.065312e-17 2.558162e-17\n[13,] 4.330322e-17 2.776057e-17\n[14,] 4.699144e-17 3.027283e-17",
        "\n[15,] 5.207235e-17 3.340977e-17\n[16,] 5.601151e-17 3.548903e-17\n[17,] 5.538193e-17 3.432840e-17\n[18,] 4.936057e-17 2.973543e-17\n[19,] 4.012312e-17 2.346181e-17\n[20,] 3.054834e-17           NA\n[21,] 2.257761e-17           NA\n[22,] 1.691630e-17           NA\n[23,]           NA           NA\n[24,]           NA           NA\n[25,]           NA           NA\n[26,]           NA           NA\n[27,]           NA           NA\n[28,]           NA           NA\n[29,]           NA           NA\n[30,]           NA           NA",
        "\n",
        "> ",
        "magimage(OpenImageR::convolution(spectral_cube[,,spatial_plane], observation$psf_kernel)*calc_region)",
        "\nRestarting R session...\n\n",
        "> ",
        "library(SimSpin)",
        "> ",
        "devtools::document()",
        "Updating SimSpin documentation\n",
        "Loading SimSpin\n",
        "Warning:",
        " The existing 'NAMESPACE' file was not generated by roxygen2, and will not be overwritten.\n",
        "Writing blur_datacube.Rd\nWriting build_datacube.Rd\n",
        "Warning message:\n",
        "\n── \u001B[1mConflicts\u001B[22m ─────────────────────────────────────────────────────────────── SimSpin conflicts ──\n\u001B[31mx\u001B[39m \u001B[32mobservation()\u001B[39m masks \u001B[34mSimSpin\u001B[39m::observation()\n\n\u001B[90mDid you accidentally source a file rather than using `load_all()`?\nRun `rm(list = c(\"observation\"))` to remove the conflicts.\u001B[39m \n",
        "> ",
        "devtools::document()",
        "Updating SimSpin documentation\n",
        "Loading SimSpin\n",
        "Warning:",
        " The existing 'NAMESPACE' file was not generated by roxygen2, and will not be overwritten.\n",
        "> ",
        "devtools:test()",
        "Error: object 'devtools' not found\n",
        "> ",
        "devtools::test()",
        "Loading SimSpin\n",
        "Testing SimSpin\n",
        "✓ |  OK \u001B[31mF\u001B[39m \u001B[35mW\u001B[39m \u001B[34mS\u001B[39m | Context\n\r⠏ |   0       | Testing build_datacube function.\n\r⠋ |   1       | Testing build_datacube function.\n\r⠙ |   2       | Testing build_datacube function.\n\r\u001B[32m✓\u001B[39m |   2       | Testing build_datacube function.\n\u001B[36m [26.4 s]\u001B[39m\n\r⠏ |   0       | Testing make_simspin_file function.\n\r⠋ |   1       | Testing make_simspin_file function.\n\r⠙ |   2       | Testing make_simspin_file function.\n\r⠹ |   3       | Testing make_simspin_file function.\n",
        "FileExists Error:: SimSpin file already exists at:  /var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmppu1z0Fgadget_test_spectra.fst \n If you wish to overwrite this file, please specify 'overwrite=T'. \nFileExists Error:: SimSpin file already exists at:  /var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmppu1z0Fhdf5_test_spectra.fst \n If you wish to overwrite this file, please specify 'overwrite=T'. \nFileExists Error:: SimSpin file already exists at:  /var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmppu1z0Feagle_test_spectra.fst",
        " \n If you wish to overwrite this file, please specify 'overwrite=T'. \nFileExists Error:: SimSpin file already exists at:  /var/folders/45/wfwdmf2d3fdc9_ffnwcjsgrhhqjvjp/T//Rtmppu1z0Feagle_test_spectra.fst \n If you wish to overwrite this file, please specify 'overwrite=T'. \n\r⠧ |   8       | Testing make_simspin_file function.\n\r\u001B[32m✓\u001B[39m |   8       | Testing make_simspin_file function.\n\u001B[36m [116.4 s]\u001B[39m\n\r⠏ |   0       | Testing observation description functions.\n\r⠧ |  18       | Testing observation description functions.\n",
        "\r\u001B[32m✓\u001B[39m |  21       | Testing observation description functions.\n\u001B[36m [0.3 s]\u001B[39m\n\n══ \u001B[1mResults\u001B[22m ══════════════════════════════════════════════════════════════════════════════════════\n\u001B[36mDuration: 143.2 s\u001B[39m\n\nOK:       \u001B[32m31\u001B[39m\nFailed:   \u001B[32m0\u001B[39m\nWarnings: \u001B[32m0\u001B[39m\nSkipped:  \u001B[32m0\u001B[39m\n",
        "> ",
        "is.null",
        "function (x)  .Primitive(\"is.null\")\n",
        "> ",
        "psf  = NULL",
        "> ",
        "is.null(psf)",
        "[1] TRUE\n",
        "> ",
        "install.packages(c('fftw', 'R2Cuba', 'RColorBrewer', 'LaplacesDemon', 'imager', 'magicaxis', 'FITSio', 'data.table'))",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "install.packages('devtools')",
        "Error in install.packages : Updating loaded packages\n",
        "> ",
        "library(devtools)",
        "Loading required package: usethis\n",
        "\nAttaching package: ‘devtools’\n\n",
        "The following object is masked from ‘package:testthat’:\n\n    test_file\n\n",
        "> ",
        "install_github(\"ICRAR/ProFit\")",
        "Downloading GitHub repo ICRAR/ProFit@HEAD\n",
        "\nRestarting R session...\n\n"
    ]
}